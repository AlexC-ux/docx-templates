var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},utf8$5={},utils$r={},support$5={},nodestream,blob;if(support$5.base64=!0,support$5.array=!0,support$5.string=!0,support$5.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",support$5.nodebuffer=typeof Buffer!="undefined",support$5.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")blob=support$5.blob=!1;else{var buffer$1=new ArrayBuffer(0);try{blob=support$5.blob=new Blob([buffer$1],{type:"application/zip"}).size===0}catch(e){try{var Builder=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,builder=new Builder;builder.append(buffer$1),blob=support$5.blob=builder.getBlob("application/zip").size===0}catch(r){blob=support$5.blob=!1}}}try{nodestream=support$5.nodestream=!!require("readable-stream").Readable}catch(e){nodestream=support$5.nodestream=!1}var base64$1={},utils$q=utils$r,support$4=support$5,_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";base64$1.encode=function(e){for(var r=[],t,E,y,x,I,w,M,D=0,O=e.length,Te=O,he=utils$q.getTypeOf(e)!=="string";D<e.length;)Te=O-D,he?(t=e[D++],E=D<O?e[D++]:0,y=D<O?e[D++]:0):(t=e.charCodeAt(D++),E=D<O?e.charCodeAt(D++):0,y=D<O?e.charCodeAt(D++):0),x=t>>2,I=(t&3)<<4|E>>4,w=Te>1?(E&15)<<2|y>>6:64,M=Te>2?y&63:64,r.push(_keyStr.charAt(x)+_keyStr.charAt(I)+_keyStr.charAt(w)+_keyStr.charAt(M));return r.join("")},base64$1.decode=function(e){var r,t,E,y,x,I,w,M=0,D=0,O="data:";if(e.substr(0,O.length)===O)throw new Error("Invalid base64 input, it looks like a data url.");e=e.replace(/[^A-Za-z0-9+/=]/g,"");var Te=e.length*3/4;if(e.charAt(e.length-1)===_keyStr.charAt(64)&&Te--,e.charAt(e.length-2)===_keyStr.charAt(64)&&Te--,Te%1!==0)throw new Error("Invalid base64 input, bad content length.");var he;for(support$4.uint8array?he=new Uint8Array(Te|0):he=new Array(Te|0);M<e.length;)y=_keyStr.indexOf(e.charAt(M++)),x=_keyStr.indexOf(e.charAt(M++)),I=_keyStr.indexOf(e.charAt(M++)),w=_keyStr.indexOf(e.charAt(M++)),r=y<<2|x>>4,t=(x&15)<<4|I>>2,E=(I&3)<<6|w,he[D++]=r,I!==64&&(he[D++]=t),w!==64&&(he[D++]=E);return he};var nodejsUtils$2={isNode:typeof Buffer!="undefined",newBufferFrom:function(e,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,r);if(typeof e=="number")throw new Error('The "data" argument must not be a number');return new Buffer(e,r)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var r=new Buffer(e);return r.fill(0),r},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&typeof e.on=="function"&&typeof e.pause=="function"&&typeof e.resume=="function"}},Mutation=commonjsGlobal.MutationObserver||commonjsGlobal.WebKitMutationObserver,scheduleDrain;if(Mutation){var called=0,observer=new Mutation(nextTick),element=commonjsGlobal.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(!commonjsGlobal.setImmediate&&typeof commonjsGlobal.MessageChannel!="undefined"){var channel=new commonjsGlobal.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}else"document"in commonjsGlobal&&"onreadystatechange"in commonjsGlobal.document.createElement("script")?scheduleDrain=function(){var e=commonjsGlobal.document.createElement("script");e.onreadystatechange=function(){nextTick(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},commonjsGlobal.document.documentElement.appendChild(e)}:scheduleDrain=function(){setTimeout(nextTick,0)};var draining,queue=[];function nextTick(){draining=!0;for(var e,r,t=queue.length;t;){for(r=queue,queue=[],e=-1;++e<t;)r[e]();t=queue.length}draining=!1}var lib$2=immediate$1;function immediate$1(e){queue.push(e)===1&&!draining&&scheduleDrain()}var immediate=lib$2;function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"],lib$1=Promise$1;function Promise$1(e){if(typeof e!="function")throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,e!==INTERNAL&&safelyResolveThenable(this,e)}Promise$1.prototype.finally=function(e){if(typeof e!="function")return this;var r=this.constructor;return this.then(t,E);function t(y){function x(){return y}return r.resolve(e()).then(x)}function E(y){function x(){throw y}return r.resolve(e()).then(x)}},Promise$1.prototype.catch=function(e){return this.then(null,e)},Promise$1.prototype.then=function(e,r){if(typeof e!="function"&&this.state===FULFILLED||typeof r!="function"&&this.state===REJECTED)return this;var t=new this.constructor(INTERNAL);if(this.state!==PENDING){var E=this.state===FULFILLED?e:r;unwrap(t,E,this.outcome)}else this.queue.push(new QueueItem(t,e,r));return t};function QueueItem(e,r,t){this.promise=e,typeof r=="function"&&(this.onFulfilled=r,this.callFulfilled=this.otherCallFulfilled),typeof t=="function"&&(this.onRejected=t,this.callRejected=this.otherCallRejected)}QueueItem.prototype.callFulfilled=function(e){handlers.resolve(this.promise,e)},QueueItem.prototype.otherCallFulfilled=function(e){unwrap(this.promise,this.onFulfilled,e)},QueueItem.prototype.callRejected=function(e){handlers.reject(this.promise,e)},QueueItem.prototype.otherCallRejected=function(e){unwrap(this.promise,this.onRejected,e)};function unwrap(e,r,t){immediate(function(){var E;try{E=r(t)}catch(y){return handlers.reject(e,y)}E===e?handlers.reject(e,new TypeError("Cannot resolve promise with itself")):handlers.resolve(e,E)})}handlers.resolve=function(e,r){var t=tryCatch(getThen,r);if(t.status==="error")return handlers.reject(e,t.value);var E=t.value;if(E)safelyResolveThenable(e,E);else{e.state=FULFILLED,e.outcome=r;for(var y=-1,x=e.queue.length;++y<x;)e.queue[y].callFulfilled(r)}return e},handlers.reject=function(e,r){e.state=REJECTED,e.outcome=r;for(var t=-1,E=e.queue.length;++t<E;)e.queue[t].callRejected(r);return e};function getThen(e){var r=e&&e.then;if(e&&(typeof e=="object"||typeof e=="function")&&typeof r=="function")return function(){r.apply(e,arguments)}}function safelyResolveThenable(e,r){var t=!1;function E(w){t||(t=!0,handlers.reject(e,w))}function y(w){t||(t=!0,handlers.resolve(e,w))}function x(){r(y,E)}var I=tryCatch(x);I.status==="error"&&E(I.value)}function tryCatch(e,r){var t={};try{t.value=e(r),t.status="success"}catch(E){t.status="error",t.value=E}return t}Promise$1.resolve=resolve;function resolve(e){return e instanceof this?e:handlers.resolve(new this(INTERNAL),e)}Promise$1.reject=reject;function reject(e){var r=new this(INTERNAL);return handlers.reject(r,e)}Promise$1.all=all;function all(e){var r=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var t=e.length,E=!1;if(!t)return this.resolve([]);for(var y=new Array(t),x=0,I=-1,w=new this(INTERNAL);++I<t;)M(e[I],I);return w;function M(D,O){r.resolve(D).then(Te,function(he){E||(E=!0,handlers.reject(w,he))});function Te(he){y[O]=he,++x===t&&!E&&(E=!0,handlers.resolve(w,y))}}}Promise$1.race=race;function race(e){var r=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var t=e.length,E=!1;if(!t)return this.resolve([]);for(var y=-1,x=new this(INTERNAL);++y<t;)I(e[y]);return x;function I(w){r.resolve(w).then(function(M){E||(E=!0,handlers.resolve(x,M))},function(M){E||(E=!0,handlers.reject(x,M))})}}var ES6Promise=null;typeof Promise!="undefined"?ES6Promise=Promise:ES6Promise=lib$1;var external$3={Promise:ES6Promise};(function(e,r){if(e.setImmediate)return;var t=1,E={},y=!1,x=e.document,I;function w(be){typeof be!="function"&&(be=new Function(""+be));for(var Ne=new Array(arguments.length-1),Ie=0;Ie<Ne.length;Ie++)Ne[Ie]=arguments[Ie+1];var Ae={callback:be,args:Ne};return E[t]=Ae,I(t),t++}function M(be){delete E[be]}function D(be){var Ne=be.callback,Ie=be.args;switch(Ie.length){case 0:Ne();break;case 1:Ne(Ie[0]);break;case 2:Ne(Ie[0],Ie[1]);break;case 3:Ne(Ie[0],Ie[1],Ie[2]);break;default:Ne.apply(r,Ie);break}}function O(be){if(y)setTimeout(O,0,be);else{var Ne=E[be];if(Ne){y=!0;try{D(Ne)}finally{M(be),y=!1}}}}function Te(){I=function(be){setTimeout(function(){O(be)})}}function he(){if(e.postMessage&&!e.importScripts){var be=!0,Ne=e.onmessage;return e.onmessage=function(){be=!1},e.postMessage("","*"),e.onmessage=Ne,be}}function ce(){var be="setImmediate$"+Math.random()+"$",Ne=function(Ie){Ie.source===e&&typeof Ie.data=="string"&&Ie.data.indexOf(be)===0&&O(+Ie.data.slice(be.length))};e.addEventListener?e.addEventListener("message",Ne,!1):e.attachEvent("onmessage",Ne),I=function(Ie){e.postMessage(be+Ie,"*")}}function ge(){var be=new MessageChannel;be.port1.onmessage=function(Ne){var Ie=Ne.data;O(Ie)},I=function(Ne){be.port2.postMessage(Ne)}}function we(){var be=x.documentElement;I=function(Ne){var Ie=x.createElement("script");Ie.onreadystatechange=function(){O(Ne),Ie.onreadystatechange=null,be.removeChild(Ie),Ie=null},be.appendChild(Ie)}}function ye(){I=function(be){setTimeout(O,0,be)}}var xe=Object.getPrototypeOf&&Object.getPrototypeOf(e);xe=xe&&xe.setTimeout?xe:e,{}.toString.call(e.undefined)==="[object undefined]"?Te():he()?ce():e.MessageChannel?ge():x&&"onreadystatechange"in x.createElement("script")?we():ye(),xe.setImmediate=w,xe.clearImmediate=M})(typeof self=="undefined"?commonjsGlobal:self),function(e){var r=support$5,t=base64$1,E=nodejsUtils$2,y=external$3;function x(he){var ce=null;return r.uint8array?ce=new Uint8Array(he.length):ce=new Array(he.length),w(he,ce)}e.newBlob=function(he,ce){e.checkSupport("blob");try{return new Blob([he],{type:ce})}catch(ye){try{var ge=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,we=new ge;return we.append(he),we.getBlob(ce)}catch(xe){throw new Error("Bug : can't construct the Blob.")}}};function I(he){return he}function w(he,ce){for(var ge=0;ge<he.length;++ge)ce[ge]=he.charCodeAt(ge)&255;return ce}var M={stringifyByChunk:function(he,ce,ge){var we=[],ye=0,xe=he.length;if(xe<=ge)return String.fromCharCode.apply(null,he);for(;ye<xe;)ce==="array"||ce==="nodebuffer"?we.push(String.fromCharCode.apply(null,he.slice(ye,Math.min(ye+ge,xe)))):we.push(String.fromCharCode.apply(null,he.subarray(ye,Math.min(ye+ge,xe)))),ye+=ge;return we.join("")},stringifyByChar:function(he){for(var ce="",ge=0;ge<he.length;ge++)ce+=String.fromCharCode(he[ge]);return ce},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(he){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,E.allocBuffer(1)).length===1}catch(he){return!1}}()}};function D(he){var ce=65536,ge=e.getTypeOf(he),we=!0;if(ge==="uint8array"?we=M.applyCanBeUsed.uint8array:ge==="nodebuffer"&&(we=M.applyCanBeUsed.nodebuffer),we)for(;ce>1;)try{return M.stringifyByChunk(he,ge,ce)}catch(ye){ce=Math.floor(ce/2)}return M.stringifyByChar(he)}e.applyFromCharCode=D;function O(he,ce){for(var ge=0;ge<he.length;ge++)ce[ge]=he[ge];return ce}var Te={};Te.string={string:I,array:function(he){return w(he,new Array(he.length))},arraybuffer:function(he){return Te.string.uint8array(he).buffer},uint8array:function(he){return w(he,new Uint8Array(he.length))},nodebuffer:function(he){return w(he,E.allocBuffer(he.length))}},Te.array={string:D,array:I,arraybuffer:function(he){return new Uint8Array(he).buffer},uint8array:function(he){return new Uint8Array(he)},nodebuffer:function(he){return E.newBufferFrom(he)}},Te.arraybuffer={string:function(he){return D(new Uint8Array(he))},array:function(he){return O(new Uint8Array(he),new Array(he.byteLength))},arraybuffer:I,uint8array:function(he){return new Uint8Array(he)},nodebuffer:function(he){return E.newBufferFrom(new Uint8Array(he))}},Te.uint8array={string:D,array:function(he){return O(he,new Array(he.length))},arraybuffer:function(he){return he.buffer},uint8array:I,nodebuffer:function(he){return E.newBufferFrom(he)}},Te.nodebuffer={string:D,array:function(he){return O(he,new Array(he.length))},arraybuffer:function(he){return Te.nodebuffer.uint8array(he).buffer},uint8array:function(he){return O(he,new Uint8Array(he.length))},nodebuffer:I},e.transformTo=function(he,ce){if(ce||(ce=""),!he)return ce;e.checkSupport(he);var ge=e.getTypeOf(ce),we=Te[ge][he](ce);return we},e.resolve=function(he){for(var ce=he.split("/"),ge=[],we=0;we<ce.length;we++){var ye=ce[we];ye==="."||ye===""&&we!==0&&we!==ce.length-1||(ye===".."?ge.pop():ge.push(ye))}return ge.join("/")},e.getTypeOf=function(he){if(typeof he=="string")return"string";if(Object.prototype.toString.call(he)==="[object Array]")return"array";if(r.nodebuffer&&E.isBuffer(he))return"nodebuffer";if(r.uint8array&&he instanceof Uint8Array)return"uint8array";if(r.arraybuffer&&he instanceof ArrayBuffer)return"arraybuffer"},e.checkSupport=function(he){var ce=r[he.toLowerCase()];if(!ce)throw new Error(he+" is not supported by this platform")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(he){var ce="",ge,we;for(we=0;we<(he||"").length;we++)ge=he.charCodeAt(we),ce+="\\x"+(ge<16?"0":"")+ge.toString(16).toUpperCase();return ce},e.delay=function(he,ce,ge){setImmediate(function(){he.apply(ge||null,ce||[])})},e.inherits=function(he,ce){var ge=function(){};ge.prototype=ce.prototype,he.prototype=new ge},e.extend=function(){var he={},ce,ge;for(ce=0;ce<arguments.length;ce++)for(ge in arguments[ce])Object.prototype.hasOwnProperty.call(arguments[ce],ge)&&typeof he[ge]=="undefined"&&(he[ge]=arguments[ce][ge]);return he},e.prepareContent=function(he,ce,ge,we,ye){var xe=y.Promise.resolve(ce).then(function(be){var Ne=r.blob&&(be instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(be))!==-1);return Ne&&typeof FileReader!="undefined"?new y.Promise(function(Ie,Ae){var Re=new FileReader;Re.onload=function(ke){Ie(ke.target.result)},Re.onerror=function(ke){Ae(ke.target.error)},Re.readAsArrayBuffer(be)}):be});return xe.then(function(be){var Ne=e.getTypeOf(be);return Ne?(Ne==="arraybuffer"?be=e.transformTo("uint8array",be):Ne==="string"&&(ye?be=t.decode(be):ge&&we!==!0&&(be=x(be))),be):y.Promise.reject(new Error("Can't read the data of '"+he+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}}(utils$r);function GenericWorker$b(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}GenericWorker$b.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return this.isFinished?!1:(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,r){return this._listeners[e].push(r),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,r){if(this._listeners[e])for(var t=0;t<this._listeners[e].length;t++)this._listeners[e][t].call(this,r)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var r=this;return e.on("data",function(t){r.processChunk(t)}),e.on("end",function(){r.end()}),e.on("error",function(t){r.error(t)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,r){return this.extraStreamInfo[e]=r,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)!Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)||(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}};var GenericWorker_1=GenericWorker$b;(function(e){for(var r=utils$r,t=support$5,E=nodejsUtils$2,y=GenericWorker_1,x=new Array(256),I=0;I<256;I++)x[I]=I>=252?6:I>=248?5:I>=240?4:I>=224?3:I>=192?2:1;x[254]=x[254]=1;var w=function(he){var ce,ge,we,ye,xe,be=he.length,Ne=0;for(ye=0;ye<be;ye++)ge=he.charCodeAt(ye),(ge&64512)===55296&&ye+1<be&&(we=he.charCodeAt(ye+1),(we&64512)===56320&&(ge=65536+(ge-55296<<10)+(we-56320),ye++)),Ne+=ge<128?1:ge<2048?2:ge<65536?3:4;for(t.uint8array?ce=new Uint8Array(Ne):ce=new Array(Ne),xe=0,ye=0;xe<Ne;ye++)ge=he.charCodeAt(ye),(ge&64512)===55296&&ye+1<be&&(we=he.charCodeAt(ye+1),(we&64512)===56320&&(ge=65536+(ge-55296<<10)+(we-56320),ye++)),ge<128?ce[xe++]=ge:ge<2048?(ce[xe++]=192|ge>>>6,ce[xe++]=128|ge&63):ge<65536?(ce[xe++]=224|ge>>>12,ce[xe++]=128|ge>>>6&63,ce[xe++]=128|ge&63):(ce[xe++]=240|ge>>>18,ce[xe++]=128|ge>>>12&63,ce[xe++]=128|ge>>>6&63,ce[xe++]=128|ge&63);return ce},M=function(he,ce){var ge;for(ce=ce||he.length,ce>he.length&&(ce=he.length),ge=ce-1;ge>=0&&(he[ge]&192)===128;)ge--;return ge<0||ge===0?ce:ge+x[he[ge]]>ce?ge:ce},D=function(he){var ce,ge,we,ye,xe=he.length,be=new Array(xe*2);for(ge=0,ce=0;ce<xe;){if(we=he[ce++],we<128){be[ge++]=we;continue}if(ye=x[we],ye>4){be[ge++]=65533,ce+=ye-1;continue}for(we&=ye===2?31:ye===3?15:7;ye>1&&ce<xe;)we=we<<6|he[ce++]&63,ye--;if(ye>1){be[ge++]=65533;continue}we<65536?be[ge++]=we:(we-=65536,be[ge++]=55296|we>>10&1023,be[ge++]=56320|we&1023)}return be.length!==ge&&(be.subarray?be=be.subarray(0,ge):be.length=ge),r.applyFromCharCode(be)};e.utf8encode=function(ce){return t.nodebuffer?E.newBufferFrom(ce,"utf-8"):w(ce)},e.utf8decode=function(ce){return t.nodebuffer?r.transformTo("nodebuffer",ce).toString("utf-8"):(ce=r.transformTo(t.uint8array?"uint8array":"array",ce),D(ce))};function O(){y.call(this,"utf-8 decode"),this.leftOver=null}r.inherits(O,y),O.prototype.processChunk=function(he){var ce=r.transformTo(t.uint8array?"uint8array":"array",he.data);if(this.leftOver&&this.leftOver.length){if(t.uint8array){var ge=ce;ce=new Uint8Array(ge.length+this.leftOver.length),ce.set(this.leftOver,0),ce.set(ge,this.leftOver.length)}else ce=this.leftOver.concat(ce);this.leftOver=null}var we=M(ce),ye=ce;we!==ce.length&&(t.uint8array?(ye=ce.subarray(0,we),this.leftOver=ce.subarray(we,ce.length)):(ye=ce.slice(0,we),this.leftOver=ce.slice(we,ce.length))),this.push({data:e.utf8decode(ye),meta:he.meta})},O.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:e.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},e.Utf8DecodeWorker=O;function Te(){y.call(this,"utf-8 encode")}r.inherits(Te,y),Te.prototype.processChunk=function(he){this.push({data:e.utf8encode(he.data),meta:he.meta})},e.Utf8EncodeWorker=Te})(utf8$5);var GenericWorker$a=GenericWorker_1,utils$p=utils$r;function ConvertWorker$1(e){GenericWorker$a.call(this,"ConvertWorker to "+e),this.destType=e}utils$p.inherits(ConvertWorker$1,GenericWorker$a),ConvertWorker$1.prototype.processChunk=function(e){this.push({data:utils$p.transformTo(this.destType,e.data),meta:e.meta})};var ConvertWorker_1=ConvertWorker$1,utils$o=utils$r,ConvertWorker=ConvertWorker_1,GenericWorker$9=GenericWorker_1,base64=base64$1,support$3=support$5,external$2=external$3,NodejsStreamOutputAdapter=null;if(support$3.nodestream)try{NodejsStreamOutputAdapter=require("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function transformZipOutput(e,r,t){switch(e){case"blob":return utils$o.newBlob(utils$o.transformTo("arraybuffer",r),t);case"base64":return base64.encode(r);default:return utils$o.transformTo(e,r)}}function concat(e,r){var t,E=0,y=null,x=0;for(t=0;t<r.length;t++)x+=r[t].length;switch(e){case"string":return r.join("");case"array":return Array.prototype.concat.apply([],r);case"uint8array":for(y=new Uint8Array(x),t=0;t<r.length;t++)y.set(r[t],E),E+=r[t].length;return y;case"nodebuffer":return Buffer.concat(r);default:throw new Error("concat : unsupported type '"+e+"'")}}function accumulate(e,r){return new external$2.Promise(function(t,E){var y=[],x=e._internalType,I=e._outputType,w=e._mimeType;e.on("data",function(M,D){y.push(M),r&&r(D)}).on("error",function(M){y=[],E(M)}).on("end",function(){try{var M=transformZipOutput(I,concat(x,y),w);t(M)}catch(D){E(D)}y=[]}).resume()})}function StreamHelper$2(e,r,t){var E=r;switch(r){case"blob":case"arraybuffer":E="uint8array";break;case"base64":E="string";break}try{this._internalType=E,this._outputType=r,this._mimeType=t,utils$o.checkSupport(E),this._worker=e.pipe(new ConvertWorker(E)),e.lock()}catch(y){this._worker=new GenericWorker$9("error"),this._worker.error(y)}}StreamHelper$2.prototype={accumulate:function(e){return accumulate(this,e)},on:function(e,r){var t=this;return e==="data"?this._worker.on(e,function(E){r.call(t,E.data,E.meta)}):this._worker.on(e,function(){utils$o.delay(r,arguments,t)}),this},resume:function(){return utils$o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(utils$o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new NodejsStreamOutputAdapter(this,{objectMode:this._outputType!=="nodebuffer"},e)}};var StreamHelper_1=StreamHelper$2,defaults$1={};defaults$1.base64=!1,defaults$1.binary=!1,defaults$1.dir=!1,defaults$1.createFolders=!0,defaults$1.date=null,defaults$1.compression=null,defaults$1.compressionOptions=null,defaults$1.comment=null,defaults$1.unixPermissions=null,defaults$1.dosPermissions=null;var utils$n=utils$r,GenericWorker$8=GenericWorker_1,DEFAULT_BLOCK_SIZE=16*1024;function DataWorker$2(e){GenericWorker$8.call(this,"DataWorker");var r=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(t){r.dataIsReady=!0,r.data=t,r.max=t&&t.length||0,r.type=utils$n.getTypeOf(t),r.isPaused||r._tickAndRepeat()},function(t){r.error(t)})}utils$n.inherits(DataWorker$2,GenericWorker$8),DataWorker$2.prototype.cleanUp=function(){GenericWorker$8.prototype.cleanUp.call(this),this.data=null},DataWorker$2.prototype.resume=function(){return GenericWorker$8.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,utils$n.delay(this._tickAndRepeat,[],this)),!0):!1},DataWorker$2.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(utils$n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},DataWorker$2.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=DEFAULT_BLOCK_SIZE,r=null,t=Math.min(this.max,this.index+e);if(this.index>=this.max)return this.end();switch(this.type){case"string":r=this.data.substring(this.index,t);break;case"uint8array":r=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":r=this.data.slice(this.index,t);break}return this.index=t,this.push({data:r,meta:{percent:this.max?this.index/this.max*100:0}})};var DataWorker_1=DataWorker$2,utils$m=utils$r;function makeTable$1(){for(var e,r=[],t=0;t<256;t++){e=t;for(var E=0;E<8;E++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r}var crcTable$1=makeTable$1();function crc32$5(e,r,t,E){var y=crcTable$1,x=E+t;e=e^-1;for(var I=E;I<x;I++)e=e>>>8^y[(e^r[I])&255];return e^-1}function crc32str(e,r,t,E){var y=crcTable$1,x=E+t;e=e^-1;for(var I=E;I<x;I++)e=e>>>8^y[(e^r.charCodeAt(I))&255];return e^-1}var crc32_1$1=function(r,t){if(typeof r=="undefined"||!r.length)return 0;var E=utils$m.getTypeOf(r)!=="string";return E?crc32$5(t|0,r,r.length,0):crc32str(t|0,r,r.length,0)},GenericWorker$7=GenericWorker_1,crc32$4=crc32_1$1,utils$l=utils$r;function Crc32Probe$2(){GenericWorker$7.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}utils$l.inherits(Crc32Probe$2,GenericWorker$7),Crc32Probe$2.prototype.processChunk=function(e){this.streamInfo.crc32=crc32$4(e.data,this.streamInfo.crc32||0),this.push(e)};var Crc32Probe_1=Crc32Probe$2,utils$k=utils$r,GenericWorker$6=GenericWorker_1;function DataLengthProbe$1(e){GenericWorker$6.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}utils$k.inherits(DataLengthProbe$1,GenericWorker$6),DataLengthProbe$1.prototype.processChunk=function(e){if(e){var r=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=r+e.data.length}GenericWorker$6.prototype.processChunk.call(this,e)};var DataLengthProbe_1=DataLengthProbe$1,external$1=external$3,DataWorker$1=DataWorker_1,Crc32Probe$1=Crc32Probe_1,DataLengthProbe=DataLengthProbe_1;function CompressedObject$3(e,r,t,E,y){this.compressedSize=e,this.uncompressedSize=r,this.crc32=t,this.compression=E,this.compressedContent=y}CompressedObject$3.prototype={getContentWorker:function(){var e=new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new DataLengthProbe("data_length")),r=this;return e.on("end",function(){if(this.streamInfo.data_length!==r.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},CompressedObject$3.createWorkerFrom=function(e,r,t){return e.pipe(new Crc32Probe$1).pipe(new DataLengthProbe("uncompressedSize")).pipe(r.compressWorker(t)).pipe(new DataLengthProbe("compressedSize")).withStreamInfo("compression",r)};var compressedObject=CompressedObject$3,StreamHelper$1=StreamHelper_1,DataWorker=DataWorker_1,utf8$4=utf8$5,CompressedObject$2=compressedObject,GenericWorker$5=GenericWorker_1,ZipObject$1=function(e,r,t){this.name=e,this.dir=t.dir,this.date=t.date,this.comment=t.comment,this.unixPermissions=t.unixPermissions,this.dosPermissions=t.dosPermissions,this._data=r,this._dataBinary=t.binary,this.options={compression:t.compression,compressionOptions:t.compressionOptions}};ZipObject$1.prototype={internalStream:function(e){var r=null,t="string";try{if(!e)throw new Error("No output type specified.");t=e.toLowerCase();var E=t==="string"||t==="text";(t==="binarystring"||t==="text")&&(t="string"),r=this._decompressWorker();var y=!this._dataBinary;y&&!E&&(r=r.pipe(new utf8$4.Utf8EncodeWorker)),!y&&E&&(r=r.pipe(new utf8$4.Utf8DecodeWorker))}catch(x){r=new GenericWorker$5("error"),r.error(x)}return new StreamHelper$1(r,t,"")},async:function(e,r){return this.internalStream(e).accumulate(r)},nodeStream:function(e,r){return this.internalStream(e||"nodebuffer").toNodejsStream(r)},_compressWorker:function(e,r){if(this._data instanceof CompressedObject$2&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var t=this._decompressWorker();return this._dataBinary||(t=t.pipe(new utf8$4.Utf8EncodeWorker)),CompressedObject$2.createWorkerFrom(t,e,r)},_decompressWorker:function(){return this._data instanceof CompressedObject$2?this._data.getContentWorker():this._data instanceof GenericWorker$5?this._data:new DataWorker(this._data)}};for(var removedMethods=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],removedFn=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},i$2=0;i$2<removedMethods.length;i$2++)ZipObject$1.prototype[removedMethods[i$2]]=removedFn;var zipObject=ZipObject$1,generate$1={},compressions$2={},flate={},common={};(function(e){var r=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function t(x,I){return Object.prototype.hasOwnProperty.call(x,I)}e.assign=function(x){for(var I=Array.prototype.slice.call(arguments,1);I.length;){var w=I.shift();if(!!w){if(typeof w!="object")throw new TypeError(w+"must be non-object");for(var M in w)t(w,M)&&(x[M]=w[M])}}return x},e.shrinkBuf=function(x,I){return x.length===I?x:x.subarray?x.subarray(0,I):(x.length=I,x)};var E={arraySet:function(x,I,w,M,D){if(I.subarray&&x.subarray){x.set(I.subarray(w,w+M),D);return}for(var O=0;O<M;O++)x[D+O]=I[w+O]},flattenChunks:function(x){var I,w,M,D,O,Te;for(M=0,I=0,w=x.length;I<w;I++)M+=x[I].length;for(Te=new Uint8Array(M),D=0,I=0,w=x.length;I<w;I++)O=x[I],Te.set(O,D),D+=O.length;return Te}},y={arraySet:function(x,I,w,M,D){for(var O=0;O<M;O++)x[D+O]=I[w+O]},flattenChunks:function(x){return[].concat.apply([],x)}};e.setTyped=function(x){x?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,E)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,y))},e.setTyped(r)})(common);var deflate$4={},deflate$3={},trees$1={},utils$j=common,Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(e){for(var r=e.length;--r>=0;)e[r]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);var static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(e,r,t,E,y){this.static_tree=e,this.extra_bits=r,this.extra_base=t,this.elems=E,this.max_length=y,this.has_stree=e&&e.length}var static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(e,r){this.dyn_tree=e,this.max_code=0,this.stat_desc=r}function d_code(e){return e<256?_dist_code[e]:_dist_code[256+(e>>>7)]}function put_short(e,r){e.pending_buf[e.pending++]=r&255,e.pending_buf[e.pending++]=r>>>8&255}function send_bits(e,r,t){e.bi_valid>Buf_size-t?(e.bi_buf|=r<<e.bi_valid&65535,put_short(e,e.bi_buf),e.bi_buf=r>>Buf_size-e.bi_valid,e.bi_valid+=t-Buf_size):(e.bi_buf|=r<<e.bi_valid&65535,e.bi_valid+=t)}function send_code(e,r,t){send_bits(e,t[r*2],t[r*2+1])}function bi_reverse(e,r){var t=0;do t|=e&1,e>>>=1,t<<=1;while(--r>0);return t>>>1}function bi_flush(e){e.bi_valid===16?(put_short(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function gen_bitlen(e,r){var t=r.dyn_tree,E=r.max_code,y=r.stat_desc.static_tree,x=r.stat_desc.has_stree,I=r.stat_desc.extra_bits,w=r.stat_desc.extra_base,M=r.stat_desc.max_length,D,O,Te,he,ce,ge,we=0;for(he=0;he<=MAX_BITS$1;he++)e.bl_count[he]=0;for(t[e.heap[e.heap_max]*2+1]=0,D=e.heap_max+1;D<HEAP_SIZE$1;D++)O=e.heap[D],he=t[t[O*2+1]*2+1]+1,he>M&&(he=M,we++),t[O*2+1]=he,!(O>E)&&(e.bl_count[he]++,ce=0,O>=w&&(ce=I[O-w]),ge=t[O*2],e.opt_len+=ge*(he+ce),x&&(e.static_len+=ge*(y[O*2+1]+ce)));if(we!==0){do{for(he=M-1;e.bl_count[he]===0;)he--;e.bl_count[he]--,e.bl_count[he+1]+=2,e.bl_count[M]--,we-=2}while(we>0);for(he=M;he!==0;he--)for(O=e.bl_count[he];O!==0;)Te=e.heap[--D],!(Te>E)&&(t[Te*2+1]!==he&&(e.opt_len+=(he-t[Te*2+1])*t[Te*2],t[Te*2+1]=he),O--)}}function gen_codes(e,r,t){var E=new Array(MAX_BITS$1+1),y=0,x,I;for(x=1;x<=MAX_BITS$1;x++)E[x]=y=y+t[x-1]<<1;for(I=0;I<=r;I++){var w=e[I*2+1];w!==0&&(e[I*2]=bi_reverse(E[w]++,w))}}function tr_static_init(){var e,r,t,E,y,x=new Array(MAX_BITS$1+1);for(t=0,E=0;E<LENGTH_CODES$1-1;E++)for(base_length[E]=t,e=0;e<1<<extra_lbits[E];e++)_length_code[t++]=E;for(_length_code[t-1]=E,y=0,E=0;E<16;E++)for(base_dist[E]=y,e=0;e<1<<extra_dbits[E];e++)_dist_code[y++]=E;for(y>>=7;E<D_CODES$1;E++)for(base_dist[E]=y<<7,e=0;e<1<<extra_dbits[E]-7;e++)_dist_code[256+y++]=E;for(r=0;r<=MAX_BITS$1;r++)x[r]=0;for(e=0;e<=143;)static_ltree[e*2+1]=8,e++,x[8]++;for(;e<=255;)static_ltree[e*2+1]=9,e++,x[9]++;for(;e<=279;)static_ltree[e*2+1]=7,e++,x[7]++;for(;e<=287;)static_ltree[e*2+1]=8,e++,x[8]++;for(gen_codes(static_ltree,L_CODES$1+1,x),e=0;e<D_CODES$1;e++)static_dtree[e*2+1]=5,static_dtree[e*2]=bi_reverse(e,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)}function init_block(e){var r;for(r=0;r<L_CODES$1;r++)e.dyn_ltree[r*2]=0;for(r=0;r<D_CODES$1;r++)e.dyn_dtree[r*2]=0;for(r=0;r<BL_CODES$1;r++)e.bl_tree[r*2]=0;e.dyn_ltree[END_BLOCK*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function bi_windup(e){e.bi_valid>8?put_short(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function copy_block(e,r,t,E){bi_windup(e),E&&(put_short(e,t),put_short(e,~t)),utils$j.arraySet(e.pending_buf,e.window,r,t,e.pending),e.pending+=t}function smaller(e,r,t,E){var y=r*2,x=t*2;return e[y]<e[x]||e[y]===e[x]&&E[r]<=E[t]}function pqdownheap(e,r,t){for(var E=e.heap[t],y=t<<1;y<=e.heap_len&&(y<e.heap_len&&smaller(r,e.heap[y+1],e.heap[y],e.depth)&&y++,!smaller(r,E,e.heap[y],e.depth));)e.heap[t]=e.heap[y],t=y,y<<=1;e.heap[t]=E}function compress_block(e,r,t){var E,y,x=0,I,w;if(e.last_lit!==0)do E=e.pending_buf[e.d_buf+x*2]<<8|e.pending_buf[e.d_buf+x*2+1],y=e.pending_buf[e.l_buf+x],x++,E===0?send_code(e,y,r):(I=_length_code[y],send_code(e,I+LITERALS$1+1,r),w=extra_lbits[I],w!==0&&(y-=base_length[I],send_bits(e,y,w)),E--,I=d_code(E),send_code(e,I,t),w=extra_dbits[I],w!==0&&(E-=base_dist[I],send_bits(e,E,w)));while(x<e.last_lit);send_code(e,END_BLOCK,r)}function build_tree(e,r){var t=r.dyn_tree,E=r.stat_desc.static_tree,y=r.stat_desc.has_stree,x=r.stat_desc.elems,I,w,M=-1,D;for(e.heap_len=0,e.heap_max=HEAP_SIZE$1,I=0;I<x;I++)t[I*2]!==0?(e.heap[++e.heap_len]=M=I,e.depth[I]=0):t[I*2+1]=0;for(;e.heap_len<2;)D=e.heap[++e.heap_len]=M<2?++M:0,t[D*2]=1,e.depth[D]=0,e.opt_len--,y&&(e.static_len-=E[D*2+1]);for(r.max_code=M,I=e.heap_len>>1;I>=1;I--)pqdownheap(e,t,I);D=x;do I=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pqdownheap(e,t,1),w=e.heap[1],e.heap[--e.heap_max]=I,e.heap[--e.heap_max]=w,t[D*2]=t[I*2]+t[w*2],e.depth[D]=(e.depth[I]>=e.depth[w]?e.depth[I]:e.depth[w])+1,t[I*2+1]=t[w*2+1]=D,e.heap[1]=D++,pqdownheap(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],gen_bitlen(e,r),gen_codes(t,M,e.bl_count)}function scan_tree(e,r,t){var E,y=-1,x,I=r[0*2+1],w=0,M=7,D=4;for(I===0&&(M=138,D=3),r[(t+1)*2+1]=65535,E=0;E<=t;E++)x=I,I=r[(E+1)*2+1],!(++w<M&&x===I)&&(w<D?e.bl_tree[x*2]+=w:x!==0?(x!==y&&e.bl_tree[x*2]++,e.bl_tree[REP_3_6*2]++):w<=10?e.bl_tree[REPZ_3_10*2]++:e.bl_tree[REPZ_11_138*2]++,w=0,y=x,I===0?(M=138,D=3):x===I?(M=6,D=3):(M=7,D=4))}function send_tree(e,r,t){var E,y=-1,x,I=r[0*2+1],w=0,M=7,D=4;for(I===0&&(M=138,D=3),E=0;E<=t;E++)if(x=I,I=r[(E+1)*2+1],!(++w<M&&x===I)){if(w<D)do send_code(e,x,e.bl_tree);while(--w!==0);else x!==0?(x!==y&&(send_code(e,x,e.bl_tree),w--),send_code(e,REP_3_6,e.bl_tree),send_bits(e,w-3,2)):w<=10?(send_code(e,REPZ_3_10,e.bl_tree),send_bits(e,w-3,3)):(send_code(e,REPZ_11_138,e.bl_tree),send_bits(e,w-11,7));w=0,y=x,I===0?(M=138,D=3):x===I?(M=6,D=3):(M=7,D=4)}}function build_bl_tree(e){var r;for(scan_tree(e,e.dyn_ltree,e.l_desc.max_code),scan_tree(e,e.dyn_dtree,e.d_desc.max_code),build_tree(e,e.bl_desc),r=BL_CODES$1-1;r>=3&&e.bl_tree[bl_order[r]*2+1]===0;r--);return e.opt_len+=3*(r+1)+5+5+4,r}function send_all_trees(e,r,t,E){var y;for(send_bits(e,r-257,5),send_bits(e,t-1,5),send_bits(e,E-4,4),y=0;y<E;y++)send_bits(e,e.bl_tree[bl_order[y]*2+1],3);send_tree(e,e.dyn_ltree,r-1),send_tree(e,e.dyn_dtree,t-1)}function detect_data_type(e){var r=4093624447,t;for(t=0;t<=31;t++,r>>>=1)if(r&1&&e.dyn_ltree[t*2]!==0)return Z_BINARY;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Z_TEXT;for(t=32;t<LITERALS$1;t++)if(e.dyn_ltree[t*2]!==0)return Z_TEXT;return Z_BINARY}var static_init_done=!1;function _tr_init(e){static_init_done||(tr_static_init(),static_init_done=!0),e.l_desc=new TreeDesc(e.dyn_ltree,static_l_desc),e.d_desc=new TreeDesc(e.dyn_dtree,static_d_desc),e.bl_desc=new TreeDesc(e.bl_tree,static_bl_desc),e.bi_buf=0,e.bi_valid=0,init_block(e)}function _tr_stored_block(e,r,t,E){send_bits(e,(STORED_BLOCK<<1)+(E?1:0),3),copy_block(e,r,t,!0)}function _tr_align(e){send_bits(e,STATIC_TREES<<1,3),send_code(e,END_BLOCK,static_ltree),bi_flush(e)}function _tr_flush_block(e,r,t,E){var y,x,I=0;e.level>0?(e.strm.data_type===Z_UNKNOWN$1&&(e.strm.data_type=detect_data_type(e)),build_tree(e,e.l_desc),build_tree(e,e.d_desc),I=build_bl_tree(e),y=e.opt_len+3+7>>>3,x=e.static_len+3+7>>>3,x<=y&&(y=x)):y=x=t+5,t+4<=y&&r!==-1?_tr_stored_block(e,r,t,E):e.strategy===Z_FIXED$1||x===y?(send_bits(e,(STATIC_TREES<<1)+(E?1:0),3),compress_block(e,static_ltree,static_dtree)):(send_bits(e,(DYN_TREES<<1)+(E?1:0),3),send_all_trees(e,e.l_desc.max_code+1,e.d_desc.max_code+1,I+1),compress_block(e,e.dyn_ltree,e.dyn_dtree)),init_block(e),E&&bi_windup(e)}function _tr_tally(e,r,t){return e.pending_buf[e.d_buf+e.last_lit*2]=r>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=r&255,e.pending_buf[e.l_buf+e.last_lit]=t&255,e.last_lit++,r===0?e.dyn_ltree[t*2]++:(e.matches++,r--,e.dyn_ltree[(_length_code[t]+LITERALS$1+1)*2]++,e.dyn_dtree[d_code(r)*2]++),e.last_lit===e.lit_bufsize-1}trees$1._tr_init=_tr_init,trees$1._tr_stored_block=_tr_stored_block,trees$1._tr_flush_block=_tr_flush_block,trees$1._tr_tally=_tr_tally,trees$1._tr_align=_tr_align;function adler32$2(e,r,t,E){for(var y=e&65535|0,x=e>>>16&65535|0,I=0;t!==0;){I=t>2e3?2e3:t,t-=I;do y=y+r[E++]|0,x=x+y|0;while(--I);y%=65521,x%=65521}return y|x<<16|0}var adler32_1=adler32$2;function makeTable(){for(var e,r=[],t=0;t<256;t++){e=t;for(var E=0;E<8;E++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r}var crcTable=makeTable();function crc32$3(e,r,t,E){var y=crcTable,x=E+t;e^=-1;for(var I=E;I<x;I++)e=e>>>8^y[(e^r[I])&255];return e^-1}var crc32_1=crc32$3,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},utils$i=common,trees=trees$1,adler32$1=adler32_1,crc32$2=crc32_1,msg$2=messages,Z_NO_FLUSH$1=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH$2=4,Z_BLOCK$1=5,Z_OK$2=0,Z_STREAM_END$2=1,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_BUF_ERROR$1=-5,Z_DEFAULT_COMPRESSION$1=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY$1=0,Z_UNKNOWN=2,Z_DEFLATED$2=8,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;function err(e,r){return e.msg=msg$2[r],r}function rank(e){return(e<<1)-(e>4?9:0)}function zero(e){for(var r=e.length;--r>=0;)e[r]=0}function flush_pending(e){var r=e.state,t=r.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(utils$i.arraySet(e.output,r.pending_buf,r.pending_out,t,e.next_out),e.next_out+=t,r.pending_out+=t,e.total_out+=t,e.avail_out-=t,r.pending-=t,r.pending===0&&(r.pending_out=0))}function flush_block_only(e,r){trees._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,r),e.block_start=e.strstart,flush_pending(e.strm)}function put_byte(e,r){e.pending_buf[e.pending++]=r}function putShortMSB(e,r){e.pending_buf[e.pending++]=r>>>8&255,e.pending_buf[e.pending++]=r&255}function read_buf(e,r,t,E){var y=e.avail_in;return y>E&&(y=E),y===0?0:(e.avail_in-=y,utils$i.arraySet(r,e.input,e.next_in,y,t),e.state.wrap===1?e.adler=adler32$1(e.adler,r,y,t):e.state.wrap===2&&(e.adler=crc32$2(e.adler,r,y,t)),e.next_in+=y,e.total_in+=y,y)}function longest_match(e,r){var t=e.max_chain_length,E=e.strstart,y,x,I=e.prev_length,w=e.nice_match,M=e.strstart>e.w_size-MIN_LOOKAHEAD?e.strstart-(e.w_size-MIN_LOOKAHEAD):0,D=e.window,O=e.w_mask,Te=e.prev,he=e.strstart+MAX_MATCH,ce=D[E+I-1],ge=D[E+I];e.prev_length>=e.good_match&&(t>>=2),w>e.lookahead&&(w=e.lookahead);do if(y=r,!(D[y+I]!==ge||D[y+I-1]!==ce||D[y]!==D[E]||D[++y]!==D[E+1])){E+=2,y++;do;while(D[++E]===D[++y]&&D[++E]===D[++y]&&D[++E]===D[++y]&&D[++E]===D[++y]&&D[++E]===D[++y]&&D[++E]===D[++y]&&D[++E]===D[++y]&&D[++E]===D[++y]&&E<he);if(x=MAX_MATCH-(he-E),E=he-MAX_MATCH,x>I){if(e.match_start=r,I=x,x>=w)break;ce=D[E+I-1],ge=D[E+I]}}while((r=Te[r&O])>M&&--t!==0);return I<=e.lookahead?I:e.lookahead}function fill_window(e){var r=e.w_size,t,E,y,x,I;do{if(x=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-MIN_LOOKAHEAD)){utils$i.arraySet(e.window,e.window,r,r,0),e.match_start-=r,e.strstart-=r,e.block_start-=r,E=e.hash_size,t=E;do y=e.head[--t],e.head[t]=y>=r?y-r:0;while(--E);E=r,t=E;do y=e.prev[--t],e.prev[t]=y>=r?y-r:0;while(--E);x+=r}if(e.strm.avail_in===0)break;if(E=read_buf(e.strm,e.window,e.strstart+e.lookahead,x),e.lookahead+=E,e.lookahead+e.insert>=MIN_MATCH)for(I=e.strstart-e.insert,e.ins_h=e.window[I],e.ins_h=(e.ins_h<<e.hash_shift^e.window[I+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[I+MIN_MATCH-1])&e.hash_mask,e.prev[I&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=I,I++,e.insert--,!(e.lookahead+e.insert<MIN_MATCH)););}while(e.lookahead<MIN_LOOKAHEAD&&e.strm.avail_in!==0)}function deflate_stored(e,r){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(fill_window(e),e.lookahead===0&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var E=e.block_start+t;if((e.strstart===0||e.strstart>=E)&&(e.lookahead=e.strstart-E,e.strstart=E,flush_block_only(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-MIN_LOOKAHEAD&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):(e.strstart>e.block_start&&(flush_block_only(e,!1),e.strm.avail_out===0),BS_NEED_MORE)}function deflate_fast(e,r){for(var t,E;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}if(t=0,e.lookahead>=MIN_MATCH&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,t)),e.match_length>=MIN_MATCH)if(E=trees._tr_tally(e,e.strstart-e.match_start,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=MIN_MATCH){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else E=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(E&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(e,r){for(var t,E,y;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}if(t=0,e.lookahead>=MIN_MATCH&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=MIN_MATCH-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,t),e.match_length<=5&&(e.strategy===Z_FILTERED||e.match_length===MIN_MATCH&&e.strstart-e.match_start>4096)&&(e.match_length=MIN_MATCH-1)),e.prev_length>=MIN_MATCH&&e.match_length<=e.prev_length){y=e.strstart+e.lookahead-MIN_MATCH,E=trees._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-MIN_MATCH),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=y&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=MIN_MATCH-1,e.strstart++,E&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}else if(e.match_available){if(E=trees._tr_tally(e,0,e.window[e.strstart-1]),E&&flush_block_only(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return BS_NEED_MORE}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(E=trees._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(e,r){for(var t,E,y,x,I=e.window;;){if(e.lookahead<=MAX_MATCH){if(fill_window(e),e.lookahead<=MAX_MATCH&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=MIN_MATCH&&e.strstart>0&&(y=e.strstart-1,E=I[y],E===I[++y]&&E===I[++y]&&E===I[++y])){x=e.strstart+MAX_MATCH;do;while(E===I[++y]&&E===I[++y]&&E===I[++y]&&E===I[++y]&&E===I[++y]&&E===I[++y]&&E===I[++y]&&E===I[++y]&&y<x);e.match_length=MAX_MATCH-(x-y),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=MIN_MATCH?(t=trees._tr_tally(e,1,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(e,r){for(var t;;){if(e.lookahead===0&&(fill_window(e),e.lookahead===0)){if(r===Z_NO_FLUSH$1)return BS_NEED_MORE;break}if(e.match_length=0,t=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(e,r,t,E,y){this.good_length=e,this.max_lazy=r,this.nice_length=t,this.max_chain=E,this.func=y}var configuration_table;configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(e){e.window_size=2*e.w_size,zero(e.head),e.max_lazy_match=configuration_table[e.level].max_lazy,e.good_match=configuration_table[e.level].good_length,e.nice_match=configuration_table[e.level].nice_length,e.max_chain_length=configuration_table[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=MIN_MATCH-1,e.match_available=0,e.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils$i.Buf16(HEAP_SIZE*2),this.dyn_dtree=new utils$i.Buf16((2*D_CODES+1)*2),this.bl_tree=new utils$i.Buf16((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils$i.Buf16(MAX_BITS+1),this.heap=new utils$i.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils$i.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(e){var r;return!e||!e.state?err(e,Z_STREAM_ERROR$1):(e.total_in=e.total_out=0,e.data_type=Z_UNKNOWN,r=e.state,r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap?INIT_STATE:BUSY_STATE,e.adler=r.wrap===2?0:1,r.last_flush=Z_NO_FLUSH$1,trees._tr_init(r),Z_OK$2)}function deflateReset(e){var r=deflateResetKeep(e);return r===Z_OK$2&&lm_init(e.state),r}function deflateSetHeader(e,r){return!e||!e.state||e.state.wrap!==2?Z_STREAM_ERROR$1:(e.state.gzhead=r,Z_OK$2)}function deflateInit2(e,r,t,E,y,x){if(!e)return Z_STREAM_ERROR$1;var I=1;if(r===Z_DEFAULT_COMPRESSION$1&&(r=6),E<0?(I=0,E=-E):E>15&&(I=2,E-=16),y<1||y>MAX_MEM_LEVEL||t!==Z_DEFLATED$2||E<8||E>15||r<0||r>9||x<0||x>Z_FIXED)return err(e,Z_STREAM_ERROR$1);E===8&&(E=9);var w=new DeflateState;return e.state=w,w.strm=e,w.wrap=I,w.gzhead=null,w.w_bits=E,w.w_size=1<<w.w_bits,w.w_mask=w.w_size-1,w.hash_bits=y+7,w.hash_size=1<<w.hash_bits,w.hash_mask=w.hash_size-1,w.hash_shift=~~((w.hash_bits+MIN_MATCH-1)/MIN_MATCH),w.window=new utils$i.Buf8(w.w_size*2),w.head=new utils$i.Buf16(w.hash_size),w.prev=new utils$i.Buf16(w.w_size),w.lit_bufsize=1<<y+6,w.pending_buf_size=w.lit_bufsize*4,w.pending_buf=new utils$i.Buf8(w.pending_buf_size),w.d_buf=1*w.lit_bufsize,w.l_buf=(1+2)*w.lit_bufsize,w.level=r,w.strategy=x,w.method=t,deflateReset(e)}function deflateInit(e,r){return deflateInit2(e,r,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1)}function deflate$2(e,r){var t,E,y,x;if(!e||!e.state||r>Z_BLOCK$1||r<0)return e?err(e,Z_STREAM_ERROR$1):Z_STREAM_ERROR$1;if(E=e.state,!e.output||!e.input&&e.avail_in!==0||E.status===FINISH_STATE&&r!==Z_FINISH$2)return err(e,e.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$1);if(E.strm=e,t=E.last_flush,E.last_flush=r,E.status===INIT_STATE)if(E.wrap===2)e.adler=0,put_byte(E,31),put_byte(E,139),put_byte(E,8),E.gzhead?(put_byte(E,(E.gzhead.text?1:0)+(E.gzhead.hcrc?2:0)+(E.gzhead.extra?4:0)+(E.gzhead.name?8:0)+(E.gzhead.comment?16:0)),put_byte(E,E.gzhead.time&255),put_byte(E,E.gzhead.time>>8&255),put_byte(E,E.gzhead.time>>16&255),put_byte(E,E.gzhead.time>>24&255),put_byte(E,E.level===9?2:E.strategy>=Z_HUFFMAN_ONLY||E.level<2?4:0),put_byte(E,E.gzhead.os&255),E.gzhead.extra&&E.gzhead.extra.length&&(put_byte(E,E.gzhead.extra.length&255),put_byte(E,E.gzhead.extra.length>>8&255)),E.gzhead.hcrc&&(e.adler=crc32$2(e.adler,E.pending_buf,E.pending,0)),E.gzindex=0,E.status=EXTRA_STATE):(put_byte(E,0),put_byte(E,0),put_byte(E,0),put_byte(E,0),put_byte(E,0),put_byte(E,E.level===9?2:E.strategy>=Z_HUFFMAN_ONLY||E.level<2?4:0),put_byte(E,OS_CODE),E.status=BUSY_STATE);else{var I=Z_DEFLATED$2+(E.w_bits-8<<4)<<8,w=-1;E.strategy>=Z_HUFFMAN_ONLY||E.level<2?w=0:E.level<6?w=1:E.level===6?w=2:w=3,I|=w<<6,E.strstart!==0&&(I|=PRESET_DICT),I+=31-I%31,E.status=BUSY_STATE,putShortMSB(E,I),E.strstart!==0&&(putShortMSB(E,e.adler>>>16),putShortMSB(E,e.adler&65535)),e.adler=1}if(E.status===EXTRA_STATE)if(E.gzhead.extra){for(y=E.pending;E.gzindex<(E.gzhead.extra.length&65535)&&!(E.pending===E.pending_buf_size&&(E.gzhead.hcrc&&E.pending>y&&(e.adler=crc32$2(e.adler,E.pending_buf,E.pending-y,y)),flush_pending(e),y=E.pending,E.pending===E.pending_buf_size));)put_byte(E,E.gzhead.extra[E.gzindex]&255),E.gzindex++;E.gzhead.hcrc&&E.pending>y&&(e.adler=crc32$2(e.adler,E.pending_buf,E.pending-y,y)),E.gzindex===E.gzhead.extra.length&&(E.gzindex=0,E.status=NAME_STATE)}else E.status=NAME_STATE;if(E.status===NAME_STATE)if(E.gzhead.name){y=E.pending;do{if(E.pending===E.pending_buf_size&&(E.gzhead.hcrc&&E.pending>y&&(e.adler=crc32$2(e.adler,E.pending_buf,E.pending-y,y)),flush_pending(e),y=E.pending,E.pending===E.pending_buf_size)){x=1;break}E.gzindex<E.gzhead.name.length?x=E.gzhead.name.charCodeAt(E.gzindex++)&255:x=0,put_byte(E,x)}while(x!==0);E.gzhead.hcrc&&E.pending>y&&(e.adler=crc32$2(e.adler,E.pending_buf,E.pending-y,y)),x===0&&(E.gzindex=0,E.status=COMMENT_STATE)}else E.status=COMMENT_STATE;if(E.status===COMMENT_STATE)if(E.gzhead.comment){y=E.pending;do{if(E.pending===E.pending_buf_size&&(E.gzhead.hcrc&&E.pending>y&&(e.adler=crc32$2(e.adler,E.pending_buf,E.pending-y,y)),flush_pending(e),y=E.pending,E.pending===E.pending_buf_size)){x=1;break}E.gzindex<E.gzhead.comment.length?x=E.gzhead.comment.charCodeAt(E.gzindex++)&255:x=0,put_byte(E,x)}while(x!==0);E.gzhead.hcrc&&E.pending>y&&(e.adler=crc32$2(e.adler,E.pending_buf,E.pending-y,y)),x===0&&(E.status=HCRC_STATE)}else E.status=HCRC_STATE;if(E.status===HCRC_STATE&&(E.gzhead.hcrc?(E.pending+2>E.pending_buf_size&&flush_pending(e),E.pending+2<=E.pending_buf_size&&(put_byte(E,e.adler&255),put_byte(E,e.adler>>8&255),e.adler=0,E.status=BUSY_STATE)):E.status=BUSY_STATE),E.pending!==0){if(flush_pending(e),e.avail_out===0)return E.last_flush=-1,Z_OK$2}else if(e.avail_in===0&&rank(r)<=rank(t)&&r!==Z_FINISH$2)return err(e,Z_BUF_ERROR$1);if(E.status===FINISH_STATE&&e.avail_in!==0)return err(e,Z_BUF_ERROR$1);if(e.avail_in!==0||E.lookahead!==0||r!==Z_NO_FLUSH$1&&E.status!==FINISH_STATE){var M=E.strategy===Z_HUFFMAN_ONLY?deflate_huff(E,r):E.strategy===Z_RLE?deflate_rle(E,r):configuration_table[E.level].func(E,r);if((M===BS_FINISH_STARTED||M===BS_FINISH_DONE)&&(E.status=FINISH_STATE),M===BS_NEED_MORE||M===BS_FINISH_STARTED)return e.avail_out===0&&(E.last_flush=-1),Z_OK$2;if(M===BS_BLOCK_DONE&&(r===Z_PARTIAL_FLUSH?trees._tr_align(E):r!==Z_BLOCK$1&&(trees._tr_stored_block(E,0,0,!1),r===Z_FULL_FLUSH&&(zero(E.head),E.lookahead===0&&(E.strstart=0,E.block_start=0,E.insert=0))),flush_pending(e),e.avail_out===0))return E.last_flush=-1,Z_OK$2}return r!==Z_FINISH$2?Z_OK$2:E.wrap<=0?Z_STREAM_END$2:(E.wrap===2?(put_byte(E,e.adler&255),put_byte(E,e.adler>>8&255),put_byte(E,e.adler>>16&255),put_byte(E,e.adler>>24&255),put_byte(E,e.total_in&255),put_byte(E,e.total_in>>8&255),put_byte(E,e.total_in>>16&255),put_byte(E,e.total_in>>24&255)):(putShortMSB(E,e.adler>>>16),putShortMSB(E,e.adler&65535)),flush_pending(e),E.wrap>0&&(E.wrap=-E.wrap),E.pending!==0?Z_OK$2:Z_STREAM_END$2)}function deflateEnd(e){var r;return!e||!e.state?Z_STREAM_ERROR$1:(r=e.state.status,r!==INIT_STATE&&r!==EXTRA_STATE&&r!==NAME_STATE&&r!==COMMENT_STATE&&r!==HCRC_STATE&&r!==BUSY_STATE&&r!==FINISH_STATE?err(e,Z_STREAM_ERROR$1):(e.state=null,r===BUSY_STATE?err(e,Z_DATA_ERROR$1):Z_OK$2))}function deflateSetDictionary(e,r){var t=r.length,E,y,x,I,w,M,D,O;if(!e||!e.state||(E=e.state,I=E.wrap,I===2||I===1&&E.status!==INIT_STATE||E.lookahead))return Z_STREAM_ERROR$1;for(I===1&&(e.adler=adler32$1(e.adler,r,t,0)),E.wrap=0,t>=E.w_size&&(I===0&&(zero(E.head),E.strstart=0,E.block_start=0,E.insert=0),O=new utils$i.Buf8(E.w_size),utils$i.arraySet(O,r,t-E.w_size,E.w_size,0),r=O,t=E.w_size),w=e.avail_in,M=e.next_in,D=e.input,e.avail_in=t,e.next_in=0,e.input=r,fill_window(E);E.lookahead>=MIN_MATCH;){y=E.strstart,x=E.lookahead-(MIN_MATCH-1);do E.ins_h=(E.ins_h<<E.hash_shift^E.window[y+MIN_MATCH-1])&E.hash_mask,E.prev[y&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=y,y++;while(--x);E.strstart=y,E.lookahead=MIN_MATCH-1,fill_window(E)}return E.strstart+=E.lookahead,E.block_start=E.strstart,E.insert=E.lookahead,E.lookahead=0,E.match_length=E.prev_length=MIN_MATCH-1,E.match_available=0,e.next_in=M,e.input=D,e.avail_in=w,E.wrap=I,Z_OK$2}deflate$3.deflateInit=deflateInit,deflate$3.deflateInit2=deflateInit2,deflate$3.deflateReset=deflateReset,deflate$3.deflateResetKeep=deflateResetKeep,deflate$3.deflateSetHeader=deflateSetHeader,deflate$3.deflate=deflate$2,deflate$3.deflateEnd=deflateEnd,deflate$3.deflateSetDictionary=deflateSetDictionary,deflate$3.deflateInfo="pako deflate (from Nodeca project)";var strings$2={},utils$h=common,STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(e){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}for(var _utf8len=new utils$h.Buf8(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1,strings$2.string2buf=function(e){var r,t,E,y,x,I=e.length,w=0;for(y=0;y<I;y++)t=e.charCodeAt(y),(t&64512)===55296&&y+1<I&&(E=e.charCodeAt(y+1),(E&64512)===56320&&(t=65536+(t-55296<<10)+(E-56320),y++)),w+=t<128?1:t<2048?2:t<65536?3:4;for(r=new utils$h.Buf8(w),x=0,y=0;x<w;y++)t=e.charCodeAt(y),(t&64512)===55296&&y+1<I&&(E=e.charCodeAt(y+1),(E&64512)===56320&&(t=65536+(t-55296<<10)+(E-56320),y++)),t<128?r[x++]=t:t<2048?(r[x++]=192|t>>>6,r[x++]=128|t&63):t<65536?(r[x++]=224|t>>>12,r[x++]=128|t>>>6&63,r[x++]=128|t&63):(r[x++]=240|t>>>18,r[x++]=128|t>>>12&63,r[x++]=128|t>>>6&63,r[x++]=128|t&63);return r};function buf2binstring(e,r){if(r<65534&&(e.subarray&&STR_APPLY_UIA_OK||!e.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils$h.shrinkBuf(e,r));for(var t="",E=0;E<r;E++)t+=String.fromCharCode(e[E]);return t}strings$2.buf2binstring=function(e){return buf2binstring(e,e.length)},strings$2.binstring2buf=function(e){for(var r=new utils$h.Buf8(e.length),t=0,E=r.length;t<E;t++)r[t]=e.charCodeAt(t);return r},strings$2.buf2string=function(e,r){var t,E,y,x,I=r||e.length,w=new Array(I*2);for(E=0,t=0;t<I;){if(y=e[t++],y<128){w[E++]=y;continue}if(x=_utf8len[y],x>4){w[E++]=65533,t+=x-1;continue}for(y&=x===2?31:x===3?15:7;x>1&&t<I;)y=y<<6|e[t++]&63,x--;if(x>1){w[E++]=65533;continue}y<65536?w[E++]=y:(y-=65536,w[E++]=55296|y>>10&1023,w[E++]=56320|y&1023)}return buf2binstring(w,E)},strings$2.utf8border=function(e,r){var t;for(r=r||e.length,r>e.length&&(r=e.length),t=r-1;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?r:t+_utf8len[e[t]]>r?t:r};function ZStream$2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream$2,zlib_deflate=deflate$3,utils$g=common,strings$1=strings$2,msg$1=messages,ZStream$1=zstream,toString$1=Object.prototype.toString,Z_NO_FLUSH=0,Z_FINISH$1=4,Z_OK$1=0,Z_STREAM_END$1=1,Z_SYNC_FLUSH=2,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED$1=8;function Deflate(e){if(!(this instanceof Deflate))return new Deflate(e);this.options=utils$g.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},e||{});var r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream$1,this.strm.avail_out=0;var t=zlib_deflate.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(t!==Z_OK$1)throw new Error(msg$1[t]);if(r.header&&zlib_deflate.deflateSetHeader(this.strm,r.header),r.dictionary){var E;if(typeof r.dictionary=="string"?E=strings$1.string2buf(r.dictionary):toString$1.call(r.dictionary)==="[object ArrayBuffer]"?E=new Uint8Array(r.dictionary):E=r.dictionary,t=zlib_deflate.deflateSetDictionary(this.strm,E),t!==Z_OK$1)throw new Error(msg$1[t]);this._dict_set=!0}}Deflate.prototype.push=function(e,r){var t=this.strm,E=this.options.chunkSize,y,x;if(this.ended)return!1;x=r===~~r?r:r===!0?Z_FINISH$1:Z_NO_FLUSH,typeof e=="string"?t.input=strings$1.string2buf(e):toString$1.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new utils$g.Buf8(E),t.next_out=0,t.avail_out=E),y=zlib_deflate.deflate(t,x),y!==Z_STREAM_END$1&&y!==Z_OK$1)return this.onEnd(y),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(x===Z_FINISH$1||x===Z_SYNC_FLUSH))&&(this.options.to==="string"?this.onData(strings$1.buf2binstring(utils$g.shrinkBuf(t.output,t.next_out))):this.onData(utils$g.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&y!==Z_STREAM_END$1);return x===Z_FINISH$1?(y=zlib_deflate.deflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===Z_OK$1):(x===Z_SYNC_FLUSH&&(this.onEnd(Z_OK$1),t.avail_out=0),!0)},Deflate.prototype.onData=function(e){this.chunks.push(e)},Deflate.prototype.onEnd=function(e){e===Z_OK$1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$g.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function deflate$1(e,r){var t=new Deflate(r);if(t.push(e,!0),t.err)throw t.msg||msg$1[t.err];return t.result}function deflateRaw(e,r){return r=r||{},r.raw=!0,deflate$1(e,r)}function gzip(e,r){return r=r||{},r.gzip=!0,deflate$1(e,r)}deflate$4.Deflate=Deflate,deflate$4.deflate=deflate$1,deflate$4.deflateRaw=deflateRaw,deflate$4.gzip=gzip;var inflate$4={},inflate$3={},BAD$1=30,TYPE$1=12,inffast=function(r,t){var E,y,x,I,w,M,D,O,Te,he,ce,ge,we,ye,xe,be,Ne,Ie,Ae,Re,ke,De,_e,Le,Ce;E=r.state,y=r.next_in,Le=r.input,x=y+(r.avail_in-5),I=r.next_out,Ce=r.output,w=I-(t-r.avail_out),M=I+(r.avail_out-257),D=E.dmax,O=E.wsize,Te=E.whave,he=E.wnext,ce=E.window,ge=E.hold,we=E.bits,ye=E.lencode,xe=E.distcode,be=(1<<E.lenbits)-1,Ne=(1<<E.distbits)-1;e:do{we<15&&(ge+=Le[y++]<<we,we+=8,ge+=Le[y++]<<we,we+=8),Ie=ye[ge&be];t:for(;;){if(Ae=Ie>>>24,ge>>>=Ae,we-=Ae,Ae=Ie>>>16&255,Ae===0)Ce[I++]=Ie&65535;else if(Ae&16){Re=Ie&65535,Ae&=15,Ae&&(we<Ae&&(ge+=Le[y++]<<we,we+=8),Re+=ge&(1<<Ae)-1,ge>>>=Ae,we-=Ae),we<15&&(ge+=Le[y++]<<we,we+=8,ge+=Le[y++]<<we,we+=8),Ie=xe[ge&Ne];r:for(;;){if(Ae=Ie>>>24,ge>>>=Ae,we-=Ae,Ae=Ie>>>16&255,Ae&16){if(ke=Ie&65535,Ae&=15,we<Ae&&(ge+=Le[y++]<<we,we+=8,we<Ae&&(ge+=Le[y++]<<we,we+=8)),ke+=ge&(1<<Ae)-1,ke>D){r.msg="invalid distance too far back",E.mode=BAD$1;break e}if(ge>>>=Ae,we-=Ae,Ae=I-w,ke>Ae){if(Ae=ke-Ae,Ae>Te&&E.sane){r.msg="invalid distance too far back",E.mode=BAD$1;break e}if(De=0,_e=ce,he===0){if(De+=O-Ae,Ae<Re){Re-=Ae;do Ce[I++]=ce[De++];while(--Ae);De=I-ke,_e=Ce}}else if(he<Ae){if(De+=O+he-Ae,Ae-=he,Ae<Re){Re-=Ae;do Ce[I++]=ce[De++];while(--Ae);if(De=0,he<Re){Ae=he,Re-=Ae;do Ce[I++]=ce[De++];while(--Ae);De=I-ke,_e=Ce}}}else if(De+=he-Ae,Ae<Re){Re-=Ae;do Ce[I++]=ce[De++];while(--Ae);De=I-ke,_e=Ce}for(;Re>2;)Ce[I++]=_e[De++],Ce[I++]=_e[De++],Ce[I++]=_e[De++],Re-=3;Re&&(Ce[I++]=_e[De++],Re>1&&(Ce[I++]=_e[De++]))}else{De=I-ke;do Ce[I++]=Ce[De++],Ce[I++]=Ce[De++],Ce[I++]=Ce[De++],Re-=3;while(Re>2);Re&&(Ce[I++]=Ce[De++],Re>1&&(Ce[I++]=Ce[De++]))}}else if((Ae&64)===0){Ie=xe[(Ie&65535)+(ge&(1<<Ae)-1)];continue r}else{r.msg="invalid distance code",E.mode=BAD$1;break e}break}}else if((Ae&64)===0){Ie=ye[(Ie&65535)+(ge&(1<<Ae)-1)];continue t}else if(Ae&32){E.mode=TYPE$1;break e}else{r.msg="invalid literal/length code",E.mode=BAD$1;break e}break}}while(y<x&&I<M);Re=we>>3,y-=Re,we-=Re<<3,ge&=(1<<we)-1,r.next_in=y,r.next_out=I,r.avail_in=y<x?5+(x-y):5-(y-x),r.avail_out=I<M?257+(M-I):257-(I-M),E.hold=ge,E.bits=we},utils$f=common,MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],inftrees=function(r,t,E,y,x,I,w,M){var D=M.bits,O=0,Te=0,he=0,ce=0,ge=0,we=0,ye=0,xe=0,be=0,Ne=0,Ie,Ae,Re,ke,De,_e=null,Le=0,Ce,Oe=new utils$f.Buf16(MAXBITS+1),Ye=new utils$f.Buf16(MAXBITS+1),Qe=null,Je=0,rt,Be,tt;for(O=0;O<=MAXBITS;O++)Oe[O]=0;for(Te=0;Te<y;Te++)Oe[t[E+Te]]++;for(ge=D,ce=MAXBITS;ce>=1&&Oe[ce]===0;ce--);if(ge>ce&&(ge=ce),ce===0)return x[I++]=1<<24|64<<16|0,x[I++]=1<<24|64<<16|0,M.bits=1,0;for(he=1;he<ce&&Oe[he]===0;he++);for(ge<he&&(ge=he),xe=1,O=1;O<=MAXBITS;O++)if(xe<<=1,xe-=Oe[O],xe<0)return-1;if(xe>0&&(r===CODES$1||ce!==1))return-1;for(Ye[1]=0,O=1;O<MAXBITS;O++)Ye[O+1]=Ye[O]+Oe[O];for(Te=0;Te<y;Te++)t[E+Te]!==0&&(w[Ye[t[E+Te]]++]=Te);if(r===CODES$1?(_e=Qe=w,Ce=19):r===LENS$1?(_e=lbase,Le-=257,Qe=lext,Je-=257,Ce=256):(_e=dbase,Qe=dext,Ce=-1),Ne=0,Te=0,O=he,De=I,we=ge,ye=0,Re=-1,be=1<<ge,ke=be-1,r===LENS$1&&be>ENOUGH_LENS$1||r===DISTS$1&&be>ENOUGH_DISTS$1)return 1;for(;;){rt=O-ye,w[Te]<Ce?(Be=0,tt=w[Te]):w[Te]>Ce?(Be=Qe[Je+w[Te]],tt=_e[Le+w[Te]]):(Be=32+64,tt=0),Ie=1<<O-ye,Ae=1<<we,he=Ae;do Ae-=Ie,x[De+(Ne>>ye)+Ae]=rt<<24|Be<<16|tt|0;while(Ae!==0);for(Ie=1<<O-1;Ne&Ie;)Ie>>=1;if(Ie!==0?(Ne&=Ie-1,Ne+=Ie):Ne=0,Te++,--Oe[O]===0){if(O===ce)break;O=t[E+w[Te]]}if(O>ge&&(Ne&ke)!==Re){for(ye===0&&(ye=ge),De+=he,we=O-ye,xe=1<<we;we+ye<ce&&(xe-=Oe[we+ye],!(xe<=0));)we++,xe<<=1;if(be+=1<<we,r===LENS$1&&be>ENOUGH_LENS$1||r===DISTS$1&&be>ENOUGH_DISTS$1)return 1;Re=Ne&ke,x[Re]=ge<<24|we<<16|De-I|0}}return Ne!==0&&(x[De+Ne]=O-ye<<24|64<<16|0),M.bits=ge,0},utils$e=common,adler32=adler32_1,crc32$1=crc32_1,inflate_fast=inffast,inflate_table=inftrees,CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS;function zswap32(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils$e.Buf16(320),this.work=new utils$e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(e){var r;return!e||!e.state?Z_STREAM_ERROR:(r=e.state,e.total_in=e.total_out=r.total=0,e.msg="",r.wrap&&(e.adler=r.wrap&1),r.mode=HEAD,r.last=0,r.havedict=0,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new utils$e.Buf32(ENOUGH_LENS),r.distcode=r.distdyn=new utils$e.Buf32(ENOUGH_DISTS),r.sane=1,r.back=-1,Z_OK)}function inflateReset(e){var r;return!e||!e.state?Z_STREAM_ERROR:(r=e.state,r.wsize=0,r.whave=0,r.wnext=0,inflateResetKeep(e))}function inflateReset2(e,r){var t,E;return!e||!e.state||(E=e.state,r<0?(t=0,r=-r):(t=(r>>4)+1,r<48&&(r&=15)),r&&(r<8||r>15))?Z_STREAM_ERROR:(E.window!==null&&E.wbits!==r&&(E.window=null),E.wrap=t,E.wbits=r,inflateReset(e))}function inflateInit2(e,r){var t,E;return e?(E=new InflateState,e.state=E,E.window=null,t=inflateReset2(e,r),t!==Z_OK&&(e.state=null),t):Z_STREAM_ERROR}function inflateInit(e){return inflateInit2(e,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(e){if(virgin){var r;for(lenfix=new utils$e.Buf32(512),distfix=new utils$e.Buf32(32),r=0;r<144;)e.lens[r++]=8;for(;r<256;)e.lens[r++]=9;for(;r<280;)e.lens[r++]=7;for(;r<288;)e.lens[r++]=8;for(inflate_table(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),r=0;r<32;)e.lens[r++]=5;inflate_table(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5}function updatewindow(e,r,t,E){var y,x=e.state;return x.window===null&&(x.wsize=1<<x.wbits,x.wnext=0,x.whave=0,x.window=new utils$e.Buf8(x.wsize)),E>=x.wsize?(utils$e.arraySet(x.window,r,t-x.wsize,x.wsize,0),x.wnext=0,x.whave=x.wsize):(y=x.wsize-x.wnext,y>E&&(y=E),utils$e.arraySet(x.window,r,t-E,y,x.wnext),E-=y,E?(utils$e.arraySet(x.window,r,t-E,E,0),x.wnext=E,x.whave=x.wsize):(x.wnext+=y,x.wnext===x.wsize&&(x.wnext=0),x.whave<x.wsize&&(x.whave+=y))),0}function inflate$2(e,r){var t,E,y,x,I,w,M,D,O,Te,he,ce,ge,we,ye=0,xe,be,Ne,Ie,Ae,Re,ke,De,_e=new utils$e.Buf8(4),Le,Ce,Oe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return Z_STREAM_ERROR;t=e.state,t.mode===TYPE&&(t.mode=TYPEDO),I=e.next_out,y=e.output,M=e.avail_out,x=e.next_in,E=e.input,w=e.avail_in,D=t.hold,O=t.bits,Te=w,he=M,De=Z_OK;e:for(;;)switch(t.mode){case HEAD:if(t.wrap===0){t.mode=TYPEDO;break}for(;O<16;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}if(t.wrap&2&&D===35615){t.check=0,_e[0]=D&255,_e[1]=D>>>8&255,t.check=crc32$1(t.check,_e,2,0),D=0,O=0,t.mode=FLAGS;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((D&255)<<8)+(D>>8))%31){e.msg="incorrect header check",t.mode=BAD;break}if((D&15)!==Z_DEFLATED){e.msg="unknown compression method",t.mode=BAD;break}if(D>>>=4,O-=4,ke=(D&15)+8,t.wbits===0)t.wbits=ke;else if(ke>t.wbits){e.msg="invalid window size",t.mode=BAD;break}t.dmax=1<<ke,e.adler=t.check=1,t.mode=D&512?DICTID:TYPE,D=0,O=0;break;case FLAGS:for(;O<16;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}if(t.flags=D,(t.flags&255)!==Z_DEFLATED){e.msg="unknown compression method",t.mode=BAD;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=BAD;break}t.head&&(t.head.text=D>>8&1),t.flags&512&&(_e[0]=D&255,_e[1]=D>>>8&255,t.check=crc32$1(t.check,_e,2,0)),D=0,O=0,t.mode=TIME;case TIME:for(;O<32;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}t.head&&(t.head.time=D),t.flags&512&&(_e[0]=D&255,_e[1]=D>>>8&255,_e[2]=D>>>16&255,_e[3]=D>>>24&255,t.check=crc32$1(t.check,_e,4,0)),D=0,O=0,t.mode=OS;case OS:for(;O<16;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}t.head&&(t.head.xflags=D&255,t.head.os=D>>8),t.flags&512&&(_e[0]=D&255,_e[1]=D>>>8&255,t.check=crc32$1(t.check,_e,2,0)),D=0,O=0,t.mode=EXLEN;case EXLEN:if(t.flags&1024){for(;O<16;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}t.length=D,t.head&&(t.head.extra_len=D),t.flags&512&&(_e[0]=D&255,_e[1]=D>>>8&255,t.check=crc32$1(t.check,_e,2,0)),D=0,O=0}else t.head&&(t.head.extra=null);t.mode=EXTRA;case EXTRA:if(t.flags&1024&&(ce=t.length,ce>w&&(ce=w),ce&&(t.head&&(ke=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),utils$e.arraySet(t.head.extra,E,x,ce,ke)),t.flags&512&&(t.check=crc32$1(t.check,E,ce,x)),w-=ce,x+=ce,t.length-=ce),t.length))break e;t.length=0,t.mode=NAME;case NAME:if(t.flags&2048){if(w===0)break e;ce=0;do ke=E[x+ce++],t.head&&ke&&t.length<65536&&(t.head.name+=String.fromCharCode(ke));while(ke&&ce<w);if(t.flags&512&&(t.check=crc32$1(t.check,E,ce,x)),w-=ce,x+=ce,ke)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=COMMENT;case COMMENT:if(t.flags&4096){if(w===0)break e;ce=0;do ke=E[x+ce++],t.head&&ke&&t.length<65536&&(t.head.comment+=String.fromCharCode(ke));while(ke&&ce<w);if(t.flags&512&&(t.check=crc32$1(t.check,E,ce,x)),w-=ce,x+=ce,ke)break e}else t.head&&(t.head.comment=null);t.mode=HCRC;case HCRC:if(t.flags&512){for(;O<16;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}if(D!==(t.check&65535)){e.msg="header crc mismatch",t.mode=BAD;break}D=0,O=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=TYPE;break;case DICTID:for(;O<32;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}e.adler=t.check=zswap32(D),D=0,O=0,t.mode=DICT;case DICT:if(t.havedict===0)return e.next_out=I,e.avail_out=M,e.next_in=x,e.avail_in=w,t.hold=D,t.bits=O,Z_NEED_DICT;e.adler=t.check=1,t.mode=TYPE;case TYPE:if(r===Z_BLOCK||r===Z_TREES)break e;case TYPEDO:if(t.last){D>>>=O&7,O-=O&7,t.mode=CHECK;break}for(;O<3;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}switch(t.last=D&1,D>>>=1,O-=1,D&3){case 0:t.mode=STORED;break;case 1:if(fixedtables(t),t.mode=LEN_,r===Z_TREES){D>>>=2,O-=2;break e}break;case 2:t.mode=TABLE;break;case 3:e.msg="invalid block type",t.mode=BAD}D>>>=2,O-=2;break;case STORED:for(D>>>=O&7,O-=O&7;O<32;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}if((D&65535)!==(D>>>16^65535)){e.msg="invalid stored block lengths",t.mode=BAD;break}if(t.length=D&65535,D=0,O=0,t.mode=COPY_,r===Z_TREES)break e;case COPY_:t.mode=COPY;case COPY:if(ce=t.length,ce){if(ce>w&&(ce=w),ce>M&&(ce=M),ce===0)break e;utils$e.arraySet(y,E,x,ce,I),w-=ce,x+=ce,M-=ce,I+=ce,t.length-=ce;break}t.mode=TYPE;break;case TABLE:for(;O<14;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}if(t.nlen=(D&31)+257,D>>>=5,O-=5,t.ndist=(D&31)+1,D>>>=5,O-=5,t.ncode=(D&15)+4,D>>>=4,O-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=BAD;break}t.have=0,t.mode=LENLENS;case LENLENS:for(;t.have<t.ncode;){for(;O<3;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}t.lens[Oe[t.have++]]=D&7,D>>>=3,O-=3}for(;t.have<19;)t.lens[Oe[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,Le={bits:t.lenbits},De=inflate_table(CODES,t.lens,0,19,t.lencode,0,t.work,Le),t.lenbits=Le.bits,De){e.msg="invalid code lengths set",t.mode=BAD;break}t.have=0,t.mode=CODELENS;case CODELENS:for(;t.have<t.nlen+t.ndist;){for(;ye=t.lencode[D&(1<<t.lenbits)-1],xe=ye>>>24,be=ye>>>16&255,Ne=ye&65535,!(xe<=O);){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}if(Ne<16)D>>>=xe,O-=xe,t.lens[t.have++]=Ne;else{if(Ne===16){for(Ce=xe+2;O<Ce;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}if(D>>>=xe,O-=xe,t.have===0){e.msg="invalid bit length repeat",t.mode=BAD;break}ke=t.lens[t.have-1],ce=3+(D&3),D>>>=2,O-=2}else if(Ne===17){for(Ce=xe+3;O<Ce;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}D>>>=xe,O-=xe,ke=0,ce=3+(D&7),D>>>=3,O-=3}else{for(Ce=xe+7;O<Ce;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}D>>>=xe,O-=xe,ke=0,ce=11+(D&127),D>>>=7,O-=7}if(t.have+ce>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=BAD;break}for(;ce--;)t.lens[t.have++]=ke}}if(t.mode===BAD)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=BAD;break}if(t.lenbits=9,Le={bits:t.lenbits},De=inflate_table(LENS,t.lens,0,t.nlen,t.lencode,0,t.work,Le),t.lenbits=Le.bits,De){e.msg="invalid literal/lengths set",t.mode=BAD;break}if(t.distbits=6,t.distcode=t.distdyn,Le={bits:t.distbits},De=inflate_table(DISTS,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,Le),t.distbits=Le.bits,De){e.msg="invalid distances set",t.mode=BAD;break}if(t.mode=LEN_,r===Z_TREES)break e;case LEN_:t.mode=LEN;case LEN:if(w>=6&&M>=258){e.next_out=I,e.avail_out=M,e.next_in=x,e.avail_in=w,t.hold=D,t.bits=O,inflate_fast(e,he),I=e.next_out,y=e.output,M=e.avail_out,x=e.next_in,E=e.input,w=e.avail_in,D=t.hold,O=t.bits,t.mode===TYPE&&(t.back=-1);break}for(t.back=0;ye=t.lencode[D&(1<<t.lenbits)-1],xe=ye>>>24,be=ye>>>16&255,Ne=ye&65535,!(xe<=O);){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}if(be&&(be&240)===0){for(Ie=xe,Ae=be,Re=Ne;ye=t.lencode[Re+((D&(1<<Ie+Ae)-1)>>Ie)],xe=ye>>>24,be=ye>>>16&255,Ne=ye&65535,!(Ie+xe<=O);){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}D>>>=Ie,O-=Ie,t.back+=Ie}if(D>>>=xe,O-=xe,t.back+=xe,t.length=Ne,be===0){t.mode=LIT;break}if(be&32){t.back=-1,t.mode=TYPE;break}if(be&64){e.msg="invalid literal/length code",t.mode=BAD;break}t.extra=be&15,t.mode=LENEXT;case LENEXT:if(t.extra){for(Ce=t.extra;O<Ce;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}t.length+=D&(1<<t.extra)-1,D>>>=t.extra,O-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=DIST;case DIST:for(;ye=t.distcode[D&(1<<t.distbits)-1],xe=ye>>>24,be=ye>>>16&255,Ne=ye&65535,!(xe<=O);){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}if((be&240)===0){for(Ie=xe,Ae=be,Re=Ne;ye=t.distcode[Re+((D&(1<<Ie+Ae)-1)>>Ie)],xe=ye>>>24,be=ye>>>16&255,Ne=ye&65535,!(Ie+xe<=O);){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}D>>>=Ie,O-=Ie,t.back+=Ie}if(D>>>=xe,O-=xe,t.back+=xe,be&64){e.msg="invalid distance code",t.mode=BAD;break}t.offset=Ne,t.extra=be&15,t.mode=DISTEXT;case DISTEXT:if(t.extra){for(Ce=t.extra;O<Ce;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}t.offset+=D&(1<<t.extra)-1,D>>>=t.extra,O-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=BAD;break}t.mode=MATCH;case MATCH:if(M===0)break e;if(ce=he-M,t.offset>ce){if(ce=t.offset-ce,ce>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=BAD;break}ce>t.wnext?(ce-=t.wnext,ge=t.wsize-ce):ge=t.wnext-ce,ce>t.length&&(ce=t.length),we=t.window}else we=y,ge=I-t.offset,ce=t.length;ce>M&&(ce=M),M-=ce,t.length-=ce;do y[I++]=we[ge++];while(--ce);t.length===0&&(t.mode=LEN);break;case LIT:if(M===0)break e;y[I++]=t.length,M--,t.mode=LEN;break;case CHECK:if(t.wrap){for(;O<32;){if(w===0)break e;w--,D|=E[x++]<<O,O+=8}if(he-=M,e.total_out+=he,t.total+=he,he&&(e.adler=t.check=t.flags?crc32$1(t.check,y,he,I-he):adler32(t.check,y,he,I-he)),he=M,(t.flags?D:zswap32(D))!==t.check){e.msg="incorrect data check",t.mode=BAD;break}D=0,O=0}t.mode=LENGTH;case LENGTH:if(t.wrap&&t.flags){for(;O<32;){if(w===0)break e;w--,D+=E[x++]<<O,O+=8}if(D!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=BAD;break}D=0,O=0}t.mode=DONE;case DONE:De=Z_STREAM_END;break e;case BAD:De=Z_DATA_ERROR;break e;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return e.next_out=I,e.avail_out=M,e.next_in=x,e.avail_in=w,t.hold=D,t.bits=O,(t.wsize||he!==e.avail_out&&t.mode<BAD&&(t.mode<CHECK||r!==Z_FINISH))&&updatewindow(e,e.output,e.next_out,he-e.avail_out),Te-=e.avail_in,he-=e.avail_out,e.total_in+=Te,e.total_out+=he,t.total+=he,t.wrap&&he&&(e.adler=t.check=t.flags?crc32$1(t.check,y,he,e.next_out-he):adler32(t.check,y,he,e.next_out-he)),e.data_type=t.bits+(t.last?64:0)+(t.mode===TYPE?128:0)+(t.mode===LEN_||t.mode===COPY_?256:0),(Te===0&&he===0||r===Z_FINISH)&&De===Z_OK&&(De=Z_BUF_ERROR),De}function inflateEnd(e){if(!e||!e.state)return Z_STREAM_ERROR;var r=e.state;return r.window&&(r.window=null),e.state=null,Z_OK}function inflateGetHeader(e,r){var t;return!e||!e.state||(t=e.state,(t.wrap&2)===0)?Z_STREAM_ERROR:(t.head=r,r.done=!1,Z_OK)}function inflateSetDictionary(e,r){var t=r.length,E,y,x;return!e||!e.state||(E=e.state,E.wrap!==0&&E.mode!==DICT)?Z_STREAM_ERROR:E.mode===DICT&&(y=1,y=adler32(y,r,t,0),y!==E.check)?Z_DATA_ERROR:(x=updatewindow(e,r,t,t),x?(E.mode=MEM,Z_MEM_ERROR):(E.havedict=1,Z_OK))}inflate$3.inflateReset=inflateReset,inflate$3.inflateReset2=inflateReset2,inflate$3.inflateResetKeep=inflateResetKeep,inflate$3.inflateInit=inflateInit,inflate$3.inflateInit2=inflateInit2,inflate$3.inflate=inflate$2,inflate$3.inflateEnd=inflateEnd,inflate$3.inflateGetHeader=inflateGetHeader,inflate$3.inflateSetDictionary=inflateSetDictionary,inflate$3.inflateInfo="pako inflate (from Nodeca project)";var constants$1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function GZheader$1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader$1,zlib_inflate=inflate$3,utils$d=common,strings=strings$2,c$4=constants$1,msg=messages,ZStream=zstream,GZheader=gzheader,toString=Object.prototype.toString;function Inflate(e){if(!(this instanceof Inflate))return new Inflate(e);this.options=utils$d.assign({chunkSize:16384,windowBits:0,to:""},e||{});var r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(e&&e.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var t=zlib_inflate.inflateInit2(this.strm,r.windowBits);if(t!==c$4.Z_OK)throw new Error(msg[t]);if(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=strings.string2buf(r.dictionary):toString.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(t=zlib_inflate.inflateSetDictionary(this.strm,r.dictionary),t!==c$4.Z_OK)))throw new Error(msg[t])}Inflate.prototype.push=function(e,r){var t=this.strm,E=this.options.chunkSize,y=this.options.dictionary,x,I,w,M,D,O=!1;if(this.ended)return!1;I=r===~~r?r:r===!0?c$4.Z_FINISH:c$4.Z_NO_FLUSH,typeof e=="string"?t.input=strings.binstring2buf(e):toString.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new utils$d.Buf8(E),t.next_out=0,t.avail_out=E),x=zlib_inflate.inflate(t,c$4.Z_NO_FLUSH),x===c$4.Z_NEED_DICT&&y&&(x=zlib_inflate.inflateSetDictionary(this.strm,y)),x===c$4.Z_BUF_ERROR&&O===!0&&(x=c$4.Z_OK,O=!1),x!==c$4.Z_STREAM_END&&x!==c$4.Z_OK)return this.onEnd(x),this.ended=!0,!1;t.next_out&&(t.avail_out===0||x===c$4.Z_STREAM_END||t.avail_in===0&&(I===c$4.Z_FINISH||I===c$4.Z_SYNC_FLUSH))&&(this.options.to==="string"?(w=strings.utf8border(t.output,t.next_out),M=t.next_out-w,D=strings.buf2string(t.output,w),t.next_out=M,t.avail_out=E-M,M&&utils$d.arraySet(t.output,t.output,w,M,0),this.onData(D)):this.onData(utils$d.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(O=!0)}while((t.avail_in>0||t.avail_out===0)&&x!==c$4.Z_STREAM_END);return x===c$4.Z_STREAM_END&&(I=c$4.Z_FINISH),I===c$4.Z_FINISH?(x=zlib_inflate.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===c$4.Z_OK):(I===c$4.Z_SYNC_FLUSH&&(this.onEnd(c$4.Z_OK),t.avail_out=0),!0)},Inflate.prototype.onData=function(e){this.chunks.push(e)},Inflate.prototype.onEnd=function(e){e===c$4.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$d.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function inflate$1(e,r){var t=new Inflate(r);if(t.push(e,!0),t.err)throw t.msg||msg[t.err];return t.result}function inflateRaw(e,r){return r=r||{},r.raw=!0,inflate$1(e,r)}inflate$4.Inflate=Inflate,inflate$4.inflate=inflate$1,inflate$4.inflateRaw=inflateRaw,inflate$4.ungzip=inflate$1;var assign=common.assign,deflate=deflate$4,inflate=inflate$4,constants=constants$1,pako$1={};assign(pako$1,deflate,inflate,constants);var pako_1=pako$1,USE_TYPEDARRAY=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",pako=pako_1,utils$c=utils$r,GenericWorker$4=GenericWorker_1,ARRAY_TYPE=USE_TYPEDARRAY?"uint8array":"array";flate.magic="\b\0";function FlateWorker(e,r){GenericWorker$4.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=r,this.meta={}}utils$c.inherits(FlateWorker,GenericWorker$4),FlateWorker.prototype.processChunk=function(e){this.meta=e.meta,this._pako===null&&this._createPako(),this._pako.push(utils$c.transformTo(ARRAY_TYPE,e.data),!1)},FlateWorker.prototype.flush=function(){GenericWorker$4.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},FlateWorker.prototype.cleanUp=function(){GenericWorker$4.prototype.cleanUp.call(this),this._pako=null},FlateWorker.prototype._createPako=function(){this._pako=new pako[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(r){e.push({data:r,meta:e.meta})}},flate.compressWorker=function(e){return new FlateWorker("Deflate",e)},flate.uncompressWorker=function(){return new FlateWorker("Inflate",{})};var GenericWorker$3=GenericWorker_1;compressions$2.STORE={magic:"\0\0",compressWorker:function(){return new GenericWorker$3("STORE compression")},uncompressWorker:function(){return new GenericWorker$3("STORE decompression")}},compressions$2.DEFLATE=flate;var signature$1={};signature$1.LOCAL_FILE_HEADER="PK",signature$1.CENTRAL_FILE_HEADER="PK",signature$1.CENTRAL_DIRECTORY_END="PK",signature$1.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",signature$1.ZIP64_CENTRAL_DIRECTORY_END="PK",signature$1.DATA_DESCRIPTOR="PK\x07\b";var utils$b=utils$r,GenericWorker$2=GenericWorker_1,utf8$3=utf8$5,crc32=crc32_1$1,signature=signature$1,decToHex=function(e,r){var t="",E;for(E=0;E<r;E++)t+=String.fromCharCode(e&255),e=e>>>8;return t},generateUnixExternalFileAttr=function(e,r){var t=e;return e||(t=r?16893:33204),(t&65535)<<16},generateDosExternalFileAttr=function(e){return(e||0)&63},generateZipParts=function(e,r,t,E,y,x){var I=e.file,w=e.compression,M=x!==utf8$3.utf8encode,D=utils$b.transformTo("string",x(I.name)),O=utils$b.transformTo("string",utf8$3.utf8encode(I.name)),Te=I.comment,he=utils$b.transformTo("string",x(Te)),ce=utils$b.transformTo("string",utf8$3.utf8encode(Te)),ge=O.length!==I.name.length,we=ce.length!==Te.length,ye,xe,be="",Ne="",Ie="",Ae=I.dir,Re=I.date,ke={crc32:0,compressedSize:0,uncompressedSize:0};(!r||t)&&(ke.crc32=e.crc32,ke.compressedSize=e.compressedSize,ke.uncompressedSize=e.uncompressedSize);var De=0;r&&(De|=8),!M&&(ge||we)&&(De|=2048);var _e=0,Le=0;Ae&&(_e|=16),y==="UNIX"?(Le=798,_e|=generateUnixExternalFileAttr(I.unixPermissions,Ae)):(Le=20,_e|=generateDosExternalFileAttr(I.dosPermissions)),ye=Re.getUTCHours(),ye=ye<<6,ye=ye|Re.getUTCMinutes(),ye=ye<<5,ye=ye|Re.getUTCSeconds()/2,xe=Re.getUTCFullYear()-1980,xe=xe<<4,xe=xe|Re.getUTCMonth()+1,xe=xe<<5,xe=xe|Re.getUTCDate(),ge&&(Ne=decToHex(1,1)+decToHex(crc32(D),4)+O,be+="up"+decToHex(Ne.length,2)+Ne),we&&(Ie=decToHex(1,1)+decToHex(crc32(he),4)+ce,be+="uc"+decToHex(Ie.length,2)+Ie);var Ce="";Ce+=`
\0`,Ce+=decToHex(De,2),Ce+=w.magic,Ce+=decToHex(ye,2),Ce+=decToHex(xe,2),Ce+=decToHex(ke.crc32,4),Ce+=decToHex(ke.compressedSize,4),Ce+=decToHex(ke.uncompressedSize,4),Ce+=decToHex(D.length,2),Ce+=decToHex(be.length,2);var Oe=signature.LOCAL_FILE_HEADER+Ce+D+be,Ye=signature.CENTRAL_FILE_HEADER+decToHex(Le,2)+Ce+decToHex(he.length,2)+"\0\0\0\0"+decToHex(_e,4)+decToHex(E,4)+D+be+he;return{fileRecord:Oe,dirRecord:Ye}},generateCentralDirectoryEnd=function(e,r,t,E,y){var x="",I=utils$b.transformTo("string",y(E));return x=signature.CENTRAL_DIRECTORY_END+"\0\0\0\0"+decToHex(e,2)+decToHex(e,2)+decToHex(r,4)+decToHex(t,4)+decToHex(I.length,2)+I,x},generateDataDescriptors=function(e){var r="";return r=signature.DATA_DESCRIPTOR+decToHex(e.crc32,4)+decToHex(e.compressedSize,4)+decToHex(e.uncompressedSize,4),r};function ZipFileWorker$1(e,r,t,E){GenericWorker$2.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=r,this.zipPlatform=t,this.encodeFileName=E,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}utils$b.inherits(ZipFileWorker$1,GenericWorker$2),ZipFileWorker$1.prototype.push=function(e){var r=e.meta.percent||0,t=this.entriesCount,E=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,GenericWorker$2.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:t?(r+100*(t-E-1))/t:100}}))},ZipFileWorker$1.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var r=this.streamFiles&&!e.file.dir;if(r){var t=generateZipParts(e,r,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:t.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ZipFileWorker$1.prototype.closedSource=function(e){this.accumulate=!1;var r=this.streamFiles&&!e.file.dir,t=generateZipParts(e,r,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(t.dirRecord),r)this.push({data:generateDataDescriptors(e),meta:{percent:100}});else for(this.push({data:t.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ZipFileWorker$1.prototype.flush=function(){for(var e=this.bytesWritten,r=0;r<this.dirRecords.length;r++)this.push({data:this.dirRecords[r],meta:{percent:100}});var t=this.bytesWritten-e,E=generateCentralDirectoryEnd(this.dirRecords.length,t,e,this.zipComment,this.encodeFileName);this.push({data:E,meta:{percent:100}})},ZipFileWorker$1.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ZipFileWorker$1.prototype.registerPrevious=function(e){this._sources.push(e);var r=this;return e.on("data",function(t){r.processChunk(t)}),e.on("end",function(){r.closedSource(r.previous.streamInfo),r._sources.length?r.prepareNextSource():r.end()}),e.on("error",function(t){r.error(t)}),this},ZipFileWorker$1.prototype.resume=function(){if(!GenericWorker$2.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},ZipFileWorker$1.prototype.error=function(e){var r=this._sources;if(!GenericWorker$2.prototype.error.call(this,e))return!1;for(var t=0;t<r.length;t++)try{r[t].error(e)}catch(E){}return!0},ZipFileWorker$1.prototype.lock=function(){GenericWorker$2.prototype.lock.call(this);for(var e=this._sources,r=0;r<e.length;r++)e[r].lock()};var ZipFileWorker_1=ZipFileWorker$1,compressions$1=compressions$2,ZipFileWorker=ZipFileWorker_1,getCompression=function(e,r){var t=e||r,E=compressions$1[t];if(!E)throw new Error(t+" is not a valid compression method !");return E};generate$1.generateWorker=function(e,r,t){var E=new ZipFileWorker(r.streamFiles,t,r.platform,r.encodeFileName),y=0;try{e.forEach(function(x,I){y++;var w=getCompression(I.options.compression,r.compression),M=I.options.compressionOptions||r.compressionOptions||{},D=I.dir,O=I.date;I._compressWorker(w,M).withStreamInfo("file",{name:x,dir:D,date:O,comment:I.comment||"",unixPermissions:I.unixPermissions,dosPermissions:I.dosPermissions}).pipe(E)}),E.entriesCount=y}catch(x){E.error(x)}return E};var utils$a=utils$r,GenericWorker$1=GenericWorker_1;function NodejsStreamInputAdapter$1(e,r){GenericWorker$1.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(r)}utils$a.inherits(NodejsStreamInputAdapter$1,GenericWorker$1),NodejsStreamInputAdapter$1.prototype._bindStream=function(e){var r=this;this._stream=e,e.pause(),e.on("data",function(t){r.push({data:t,meta:{percent:0}})}).on("error",function(t){r.isPaused?this.generatedError=t:r.error(t)}).on("end",function(){r.isPaused?r._upstreamEnded=!0:r.end()})},NodejsStreamInputAdapter$1.prototype.pause=function(){return GenericWorker$1.prototype.pause.call(this)?(this._stream.pause(),!0):!1},NodejsStreamInputAdapter$1.prototype.resume=function(){return GenericWorker$1.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};var NodejsStreamInputAdapter_1=NodejsStreamInputAdapter$1,utf8$2=utf8$5,utils$9=utils$r,GenericWorker=GenericWorker_1,StreamHelper=StreamHelper_1,defaults=defaults$1,CompressedObject$1=compressedObject,ZipObject=zipObject,generate=generate$1,nodejsUtils$1=nodejsUtils$2,NodejsStreamInputAdapter=NodejsStreamInputAdapter_1,fileAdd=function(e,r,t){var E=utils$9.getTypeOf(r),y,x=utils$9.extend(t||{},defaults);x.date=x.date||new Date,x.compression!==null&&(x.compression=x.compression.toUpperCase()),typeof x.unixPermissions=="string"&&(x.unixPermissions=parseInt(x.unixPermissions,8)),x.unixPermissions&&x.unixPermissions&16384&&(x.dir=!0),x.dosPermissions&&x.dosPermissions&16&&(x.dir=!0),x.dir&&(e=forceTrailingSlash(e)),x.createFolders&&(y=parentFolder(e))&&folderAdd.call(this,y,!0);var I=E==="string"&&x.binary===!1&&x.base64===!1;(!t||typeof t.binary=="undefined")&&(x.binary=!I);var w=r instanceof CompressedObject$1&&r.uncompressedSize===0;(w||x.dir||!r||r.length===0)&&(x.base64=!1,x.binary=!0,r="",x.compression="STORE",E="string");var M=null;r instanceof CompressedObject$1||r instanceof GenericWorker?M=r:nodejsUtils$1.isNode&&nodejsUtils$1.isStream(r)?M=new NodejsStreamInputAdapter(e,r):M=utils$9.prepareContent(e,r,x.binary,x.optimizedBinaryString,x.base64);var D=new ZipObject(e,M,x);this.files[e]=D},parentFolder=function(e){e.slice(-1)==="/"&&(e=e.substring(0,e.length-1));var r=e.lastIndexOf("/");return r>0?e.substring(0,r):""},forceTrailingSlash=function(e){return e.slice(-1)!=="/"&&(e+="/"),e},folderAdd=function(e,r){return r=typeof r!="undefined"?r:defaults.createFolders,e=forceTrailingSlash(e),this.files[e]||fileAdd.call(this,e,null,{dir:!0,createFolders:r}),this.files[e]};function isRegExp(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var out={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var r,t,E;for(r in this.files)E=this.files[r],t=r.slice(this.root.length,r.length),t&&r.slice(0,this.root.length)===this.root&&e(t,E)},filter:function(e){var r=[];return this.forEach(function(t,E){e(t,E)&&r.push(E)}),r},file:function(e,r,t){if(arguments.length===1)if(isRegExp(e)){var E=e;return this.filter(function(x,I){return!I.dir&&E.test(x)})}else{var y=this.files[this.root+e];return y&&!y.dir?y:null}else e=this.root+e,fileAdd.call(this,e,r,t);return this},folder:function(e){if(!e)return this;if(isRegExp(e))return this.filter(function(y,x){return x.dir&&e.test(y)});var r=this.root+e,t=folderAdd.call(this,r),E=this.clone();return E.root=t.name,E},remove:function(e){e=this.root+e;var r=this.files[e];if(r||(e.slice(-1)!=="/"&&(e+="/"),r=this.files[e]),r&&!r.dir)delete this.files[e];else for(var t=this.filter(function(y,x){return x.name.slice(0,e.length)===e}),E=0;E<t.length;E++)delete this.files[t[E].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var r,t={};try{if(t=utils$9.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:utf8$2.utf8encode}),t.type=t.type.toLowerCase(),t.compression=t.compression.toUpperCase(),t.type==="binarystring"&&(t.type="string"),!t.type)throw new Error("No output type specified.");utils$9.checkSupport(t.type),(t.platform==="darwin"||t.platform==="freebsd"||t.platform==="linux"||t.platform==="sunos")&&(t.platform="UNIX"),t.platform==="win32"&&(t.platform="DOS");var E=t.comment||this.comment||"";r=generate.generateWorker(this,t,E)}catch(y){r=new GenericWorker("error"),r.error(y)}return new StreamHelper(r,t.type||"string",t.mimeType)},generateAsync:function(e,r){return this.generateInternalStream(e).accumulate(r)},generateNodeStream:function(e,r){return e=e||{},e.type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(r)}},object=out,utils$8=utils$r;function DataReader$2(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}DataReader$2.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var r=0,t;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return utils$8.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1))}};var DataReader_1=DataReader$2,DataReader$1=DataReader_1,utils$7=utils$r;function ArrayReader$2(e){DataReader$1.call(this,e);for(var r=0;r<this.data.length;r++)e[r]=e[r]&255}utils$7.inherits(ArrayReader$2,DataReader$1),ArrayReader$2.prototype.byteAt=function(e){return this.data[this.zero+e]},ArrayReader$2.prototype.lastIndexOfSignature=function(e){for(var r=e.charCodeAt(0),t=e.charCodeAt(1),E=e.charCodeAt(2),y=e.charCodeAt(3),x=this.length-4;x>=0;--x)if(this.data[x]===r&&this.data[x+1]===t&&this.data[x+2]===E&&this.data[x+3]===y)return x-this.zero;return-1},ArrayReader$2.prototype.readAndCheckSignature=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1),E=e.charCodeAt(2),y=e.charCodeAt(3),x=this.readData(4);return r===x[0]&&t===x[1]&&E===x[2]&&y===x[3]},ArrayReader$2.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var ArrayReader_1=ArrayReader$2,DataReader=DataReader_1,utils$6=utils$r;function StringReader$1(e){DataReader.call(this,e)}utils$6.inherits(StringReader$1,DataReader),StringReader$1.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},StringReader$1.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},StringReader$1.prototype.readAndCheckSignature=function(e){var r=this.readData(4);return e===r},StringReader$1.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var StringReader_1=StringReader$1,ArrayReader$1=ArrayReader_1,utils$5=utils$r;function Uint8ArrayReader$2(e){ArrayReader$1.call(this,e)}utils$5.inherits(Uint8ArrayReader$2,ArrayReader$1),Uint8ArrayReader$2.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var r=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var Uint8ArrayReader_1=Uint8ArrayReader$2,Uint8ArrayReader$1=Uint8ArrayReader_1,utils$4=utils$r;function NodeBufferReader$1(e){Uint8ArrayReader$1.call(this,e)}utils$4.inherits(NodeBufferReader$1,Uint8ArrayReader$1),NodeBufferReader$1.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var NodeBufferReader_1=NodeBufferReader$1,utils$3=utils$r,support$2=support$5,ArrayReader=ArrayReader_1,StringReader=StringReader_1,NodeBufferReader=NodeBufferReader_1,Uint8ArrayReader=Uint8ArrayReader_1,readerFor$2=function(e){var r=utils$3.getTypeOf(e);return utils$3.checkSupport(r),r==="string"&&!support$2.uint8array?new StringReader(e):r==="nodebuffer"?new NodeBufferReader(e):support$2.uint8array?new Uint8ArrayReader(utils$3.transformTo("uint8array",e)):new ArrayReader(utils$3.transformTo("array",e))},readerFor$1=readerFor$2,utils$2=utils$r,CompressedObject=compressedObject,crc32fn=crc32_1$1,utf8$1=utf8$5,compressions=compressions$2,support$1=support$5,MADE_BY_DOS=0,MADE_BY_UNIX=3,findCompression=function(e){for(var r in compressions)if(!!Object.prototype.hasOwnProperty.call(compressions,r)&&compressions[r].magic===e)return compressions[r];return null};function ZipEntry$1(e,r){this.options=e,this.loadOptions=r}ZipEntry$1.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(e){var r,t;if(e.skip(22),this.fileNameLength=e.readInt(2),t=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(t),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(r=findCompression(this.compressionMethod),r===null)throw new Error("Corrupted zip : compression "+utils$2.pretty(this.compressionMethod)+" unknown (inner file : "+utils$2.transformTo("string",this.fileName)+")");this.decompressed=new CompressedObject(this.compressedSize,this.uncompressedSize,this.crc32,r,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var r=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(r),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),e===MADE_BY_DOS&&(this.dosPermissions=this.externalFileAttributes&63),e===MADE_BY_UNIX&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(!!this.extraFields[1]){var e=readerFor$1(this.extraFields[1].value);this.uncompressedSize===utils$2.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===utils$2.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===utils$2.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===utils$2.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var r=e.index+this.extraFieldsLength,t,E,y;for(this.extraFields||(this.extraFields={});e.index+4<r;)t=e.readInt(2),E=e.readInt(2),y=e.readData(E),this.extraFields[t]={id:t,length:E,value:y};e.setIndex(r)},handleUTF8:function(){var e=support$1.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=utf8$1.utf8decode(this.fileName),this.fileCommentStr=utf8$1.utf8decode(this.fileComment);else{var r=this.findExtraFieldUnicodePath();if(r!==null)this.fileNameStr=r;else{var t=utils$2.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(t)}var E=this.findExtraFieldUnicodeComment();if(E!==null)this.fileCommentStr=E;else{var y=utils$2.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var r=readerFor$1(e.value);return r.readInt(1)!==1||crc32fn(this.fileName)!==r.readInt(4)?null:utf8$1.utf8decode(r.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var r=readerFor$1(e.value);return r.readInt(1)!==1||crc32fn(this.fileComment)!==r.readInt(4)?null:utf8$1.utf8decode(r.readData(e.length-5))}return null}};var zipEntry=ZipEntry$1,readerFor=readerFor$2,utils$1=utils$r,sig=signature$1,ZipEntry=zipEntry,support=support$5;function ZipEntries$1(e){this.files=[],this.loadOptions=e}ZipEntries$1.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var r=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+utils$1.pretty(r)+", expected "+utils$1.pretty(e)+")")}},isSignature:function(e,r){var t=this.reader.index;this.reader.setIndex(e);var E=this.reader.readString(4),y=E===r;return this.reader.setIndex(t),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),r=support.uint8array?"uint8array":"array",t=utils$1.transformTo(r,e);this.zipComment=this.loadOptions.decodeFileName(t)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e=this.zip64EndOfCentralSize-44,r=0,t,E,y;r<e;)t=this.reader.readInt(2),E=this.reader.readInt(4),y=this.reader.readData(E),this.zip64ExtensibleData[t]={id:t,length:E,value:y}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,r;for(e=0;e<this.files.length;e++)r=this.files[e],this.reader.setIndex(r.localHeaderOffset),this.checkSignature(sig.LOCAL_FILE_HEADER),r.readLocalPart(this.reader),r.handleUTF8(),r.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(sig.CENTRAL_FILE_HEADER);)e=new ZipEntry({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(sig.CENTRAL_DIRECTORY_END);if(e<0){var r=!this.isSignature(0,sig.LOCAL_FILE_HEADER);throw r?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(e);var t=e;if(this.checkSignature(sig.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===utils$1.MAX_VALUE_16BITS||this.diskWithCentralDirStart===utils$1.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===utils$1.MAX_VALUE_16BITS||this.centralDirRecords===utils$1.MAX_VALUE_16BITS||this.centralDirSize===utils$1.MAX_VALUE_32BITS||this.centralDirOffset===utils$1.MAX_VALUE_32BITS){if(this.zip64=!0,e=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),e<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,sig.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var E=this.centralDirOffset+this.centralDirSize;this.zip64&&(E+=20,E+=12+this.zip64EndOfCentralSize);var y=t-E;if(y>0)this.isSignature(t,sig.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(e){this.reader=readerFor(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var zipEntries=ZipEntries$1,utils=utils$r,external=external$3,utf8=utf8$5,ZipEntries=zipEntries,Crc32Probe=Crc32Probe_1,nodejsUtils=nodejsUtils$2;function checkEntryCRC32(e){return new external.Promise(function(r,t){var E=e.decompressed.getContentWorker().pipe(new Crc32Probe);E.on("error",function(y){t(y)}).on("end",function(){E.streamInfo.crc32!==e.decompressed.crc32?t(new Error("Corrupted zip : CRC32 mismatch")):r()}).resume()})}var load=function(e,r){var t=this;return r=utils.extend(r||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:utf8.utf8decode}),nodejsUtils.isNode&&nodejsUtils.isStream(e)?external.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):utils.prepareContent("the loaded zip file",e,!0,r.optimizedBinaryString,r.base64).then(function(E){var y=new ZipEntries(r);return y.load(E),y}).then(function(y){var x=[external.Promise.resolve(y)],I=y.files;if(r.checkCRC32)for(var w=0;w<I.length;w++)x.push(checkEntryCRC32(I[w]));return external.Promise.all(x)}).then(function(y){for(var x=y.shift(),I=x.files,w=0;w<I.length;w++){var M=I[w],D=M.fileNameStr,O=utils.resolve(M.fileNameStr);t.file(O,M.decompressed,{binary:!0,optimizedBinaryString:!0,date:M.date,dir:M.dir,comment:M.fileCommentStr.length?M.fileCommentStr:null,unixPermissions:M.unixPermissions,dosPermissions:M.dosPermissions,createFolders:r.createFolders}),M.dir||(t.file(O).unsafeOriginalName=D)}return x.zipComment.length&&(t.comment=x.zipComment),t})};function JSZip(){if(!(this instanceof JSZip))return new JSZip;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new JSZip;for(var r in this)typeof this[r]!="function"&&(e[r]=this[r]);return e}}JSZip.prototype=object,JSZip.prototype.loadAsync=load,JSZip.support=support$5,JSZip.defaults=defaults$1,JSZip.version="3.10.1",JSZip.loadAsync=function(e,r){return new JSZip().loadAsync(e,r)},JSZip.external=external$3;var lib=JSZip;const n=e=>lib.loadAsync(e),s$1=(e,r)=>{const t=e.file(r);return t?t.async("text"):null},p$1=(e,r,t)=>e.file(r,t),o=(e,r,t)=>e.file(r,t,{binary:!0}),a$1=(e,r,t)=>e.file(r,t,{base64:!0}),c$3=e=>e.generateAsync({type:"uint8array",compression:"DEFLATE",compressionOptions:{level:1}});var sax={},string_decoder={},safeBuffer={exports:{}},buffer={},base64Js={};base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr=typeof Uint8Array!="undefined"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i$1=0,len=code.length;i$1<len;++i$1)lookup[i$1]=code[i$1],revLookup[code.charCodeAt(i$1)]=i$1;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;function getLens(e){var r=e.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=e.indexOf("=");t===-1&&(t=r);var E=t===r?0:4-t%4;return[t,E]}function byteLength(e){var r=getLens(e),t=r[0],E=r[1];return(t+E)*3/4-E}function _byteLength(e,r,t){return(r+t)*3/4-t}function toByteArray(e){var r,t=getLens(e),E=t[0],y=t[1],x=new Arr(_byteLength(e,E,y)),I=0,w=y>0?E-4:E,M;for(M=0;M<w;M+=4)r=revLookup[e.charCodeAt(M)]<<18|revLookup[e.charCodeAt(M+1)]<<12|revLookup[e.charCodeAt(M+2)]<<6|revLookup[e.charCodeAt(M+3)],x[I++]=r>>16&255,x[I++]=r>>8&255,x[I++]=r&255;return y===2&&(r=revLookup[e.charCodeAt(M)]<<2|revLookup[e.charCodeAt(M+1)]>>4,x[I++]=r&255),y===1&&(r=revLookup[e.charCodeAt(M)]<<10|revLookup[e.charCodeAt(M+1)]<<4|revLookup[e.charCodeAt(M+2)]>>2,x[I++]=r>>8&255,x[I++]=r&255),x}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[e&63]}function encodeChunk(e,r,t){for(var E,y=[],x=r;x<t;x+=3)E=(e[x]<<16&16711680)+(e[x+1]<<8&65280)+(e[x+2]&255),y.push(tripletToBase64(E));return y.join("")}function fromByteArray(e){for(var r,t=e.length,E=t%3,y=[],x=16383,I=0,w=t-E;I<w;I+=x)y.push(encodeChunk(e,I,I+x>w?w:I+x));return E===1?(r=e[t-1],y.push(lookup[r>>2]+lookup[r<<4&63]+"==")):E===2&&(r=(e[t-2]<<8)+e[t-1],y.push(lookup[r>>10]+lookup[r>>4&63]+lookup[r<<2&63]+"=")),y.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(e,r,t,E,y){var x,I,w=y*8-E-1,M=(1<<w)-1,D=M>>1,O=-7,Te=t?y-1:0,he=t?-1:1,ce=e[r+Te];for(Te+=he,x=ce&(1<<-O)-1,ce>>=-O,O+=w;O>0;x=x*256+e[r+Te],Te+=he,O-=8);for(I=x&(1<<-O)-1,x>>=-O,O+=E;O>0;I=I*256+e[r+Te],Te+=he,O-=8);if(x===0)x=1-D;else{if(x===M)return I?NaN:(ce?-1:1)*(1/0);I=I+Math.pow(2,E),x=x-D}return(ce?-1:1)*I*Math.pow(2,x-E)},ieee754.write=function(e,r,t,E,y,x){var I,w,M,D=x*8-y-1,O=(1<<D)-1,Te=O>>1,he=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,ce=E?0:x-1,ge=E?1:-1,we=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(w=isNaN(r)?1:0,I=O):(I=Math.floor(Math.log(r)/Math.LN2),r*(M=Math.pow(2,-I))<1&&(I--,M*=2),I+Te>=1?r+=he/M:r+=he*Math.pow(2,1-Te),r*M>=2&&(I++,M/=2),I+Te>=O?(w=0,I=O):I+Te>=1?(w=(r*M-1)*Math.pow(2,y),I=I+Te):(w=r*Math.pow(2,Te-1)*Math.pow(2,y),I=0));y>=8;e[t+ce]=w&255,ce+=ge,w/=256,y-=8);for(I=I<<y|w,D+=y;D>0;e[t+ce]=I&255,ce+=ge,I/=256,D-=8);e[t+ce-ge]|=we*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const r=base64Js,t=ieee754,E=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=w,e.SlowBuffer=be,e.INSPECT_MAX_BYTES=50;const y=2147483647;e.kMaxLength=y,w.TYPED_ARRAY_SUPPORT=x(),!w.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function x(){try{const k=new Uint8Array(1),v={foo:function(){return 42}};return Object.setPrototypeOf(v,Uint8Array.prototype),Object.setPrototypeOf(k,v),k.foo()===42}catch(k){return!1}}Object.defineProperty(w.prototype,"parent",{enumerable:!0,get:function(){if(!!w.isBuffer(this))return this.buffer}}),Object.defineProperty(w.prototype,"offset",{enumerable:!0,get:function(){if(!!w.isBuffer(this))return this.byteOffset}});function I(k){if(k>y)throw new RangeError('The value "'+k+'" is invalid for option "size"');const v=new Uint8Array(k);return Object.setPrototypeOf(v,w.prototype),v}function w(k,v,T){if(typeof k=="number"){if(typeof v=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Te(k)}return M(k,v,T)}w.poolSize=8192;function M(k,v,T){if(typeof k=="string")return he(k,v);if(ArrayBuffer.isView(k))return ge(k);if(k==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k);if(qe(k,ArrayBuffer)||k&&qe(k.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(qe(k,SharedArrayBuffer)||k&&qe(k.buffer,SharedArrayBuffer)))return we(k,v,T);if(typeof k=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const z=k.valueOf&&k.valueOf();if(z!=null&&z!==k)return w.from(z,v,T);const me=ye(k);if(me)return me;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof k[Symbol.toPrimitive]=="function")return w.from(k[Symbol.toPrimitive]("string"),v,T);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k)}w.from=function(k,v,T){return M(k,v,T)},Object.setPrototypeOf(w.prototype,Uint8Array.prototype),Object.setPrototypeOf(w,Uint8Array);function D(k){if(typeof k!="number")throw new TypeError('"size" argument must be of type number');if(k<0)throw new RangeError('The value "'+k+'" is invalid for option "size"')}function O(k,v,T){return D(k),k<=0?I(k):v!==void 0?typeof T=="string"?I(k).fill(v,T):I(k).fill(v):I(k)}w.alloc=function(k,v,T){return O(k,v,T)};function Te(k){return D(k),I(k<0?0:xe(k)|0)}w.allocUnsafe=function(k){return Te(k)},w.allocUnsafeSlow=function(k){return Te(k)};function he(k,v){if((typeof v!="string"||v==="")&&(v="utf8"),!w.isEncoding(v))throw new TypeError("Unknown encoding: "+v);const T=Ne(k,v)|0;let z=I(T);const me=z.write(k,v);return me!==T&&(z=z.slice(0,me)),z}function ce(k){const v=k.length<0?0:xe(k.length)|0,T=I(v);for(let z=0;z<v;z+=1)T[z]=k[z]&255;return T}function ge(k){if(qe(k,Uint8Array)){const v=new Uint8Array(k);return we(v.buffer,v.byteOffset,v.byteLength)}return ce(k)}function we(k,v,T){if(v<0||k.byteLength<v)throw new RangeError('"offset" is outside of buffer bounds');if(k.byteLength<v+(T||0))throw new RangeError('"length" is outside of buffer bounds');let z;return v===void 0&&T===void 0?z=new Uint8Array(k):T===void 0?z=new Uint8Array(k,v):z=new Uint8Array(k,v,T),Object.setPrototypeOf(z,w.prototype),z}function ye(k){if(w.isBuffer(k)){const v=xe(k.length)|0,T=I(v);return T.length===0||k.copy(T,0,0,v),T}if(k.length!==void 0)return typeof k.length!="number"||_t(k.length)?I(0):ce(k);if(k.type==="Buffer"&&Array.isArray(k.data))return ce(k.data)}function xe(k){if(k>=y)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+y.toString(16)+" bytes");return k|0}function be(k){return+k!=k&&(k=0),w.alloc(+k)}w.isBuffer=function(v){return v!=null&&v._isBuffer===!0&&v!==w.prototype},w.compare=function(v,T){if(qe(v,Uint8Array)&&(v=w.from(v,v.offset,v.byteLength)),qe(T,Uint8Array)&&(T=w.from(T,T.offset,T.byteLength)),!w.isBuffer(v)||!w.isBuffer(T))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(v===T)return 0;let z=v.length,me=T.length;for(let ve=0,Se=Math.min(z,me);ve<Se;++ve)if(v[ve]!==T[ve]){z=v[ve],me=T[ve];break}return z<me?-1:me<z?1:0},w.isEncoding=function(v){switch(String(v).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},w.concat=function(v,T){if(!Array.isArray(v))throw new TypeError('"list" argument must be an Array of Buffers');if(v.length===0)return w.alloc(0);let z;if(T===void 0)for(T=0,z=0;z<v.length;++z)T+=v[z].length;const me=w.allocUnsafe(T);let ve=0;for(z=0;z<v.length;++z){let Se=v[z];if(qe(Se,Uint8Array))ve+Se.length>me.length?(w.isBuffer(Se)||(Se=w.from(Se)),Se.copy(me,ve)):Uint8Array.prototype.set.call(me,Se,ve);else if(w.isBuffer(Se))Se.copy(me,ve);else throw new TypeError('"list" argument must be an Array of Buffers');ve+=Se.length}return me};function Ne(k,v){if(w.isBuffer(k))return k.length;if(ArrayBuffer.isView(k)||qe(k,ArrayBuffer))return k.byteLength;if(typeof k!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof k);const T=k.length,z=arguments.length>2&&arguments[2]===!0;if(!z&&T===0)return 0;let me=!1;for(;;)switch(v){case"ascii":case"latin1":case"binary":return T;case"utf8":case"utf-8":return Ge(k).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T*2;case"hex":return T>>>1;case"base64":return ct(k).length;default:if(me)return z?-1:Ge(k).length;v=(""+v).toLowerCase(),me=!0}}w.byteLength=Ne;function Ie(k,v,T){let z=!1;if((v===void 0||v<0)&&(v=0),v>this.length||((T===void 0||T>this.length)&&(T=this.length),T<=0)||(T>>>=0,v>>>=0,T<=v))return"";for(k||(k="utf8");;)switch(k){case"hex":return ot(this,v,T);case"utf8":case"utf-8":return Qe(this,v,T);case"ascii":return Be(this,v,T);case"latin1":case"binary":return tt(this,v,T);case"base64":return Ye(this,v,T);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return st(this,v,T);default:if(z)throw new TypeError("Unknown encoding: "+k);k=(k+"").toLowerCase(),z=!0}}w.prototype._isBuffer=!0;function Ae(k,v,T){const z=k[v];k[v]=k[T],k[T]=z}w.prototype.swap16=function(){const v=this.length;if(v%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let T=0;T<v;T+=2)Ae(this,T,T+1);return this},w.prototype.swap32=function(){const v=this.length;if(v%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let T=0;T<v;T+=4)Ae(this,T,T+3),Ae(this,T+1,T+2);return this},w.prototype.swap64=function(){const v=this.length;if(v%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let T=0;T<v;T+=8)Ae(this,T,T+7),Ae(this,T+1,T+6),Ae(this,T+2,T+5),Ae(this,T+3,T+4);return this},w.prototype.toString=function(){const v=this.length;return v===0?"":arguments.length===0?Qe(this,0,v):Ie.apply(this,arguments)},w.prototype.toLocaleString=w.prototype.toString,w.prototype.equals=function(v){if(!w.isBuffer(v))throw new TypeError("Argument must be a Buffer");return this===v?!0:w.compare(this,v)===0},w.prototype.inspect=function(){let v="";const T=e.INSPECT_MAX_BYTES;return v=this.toString("hex",0,T).replace(/(.{2})/g,"$1 ").trim(),this.length>T&&(v+=" ... "),"<Buffer "+v+">"},E&&(w.prototype[E]=w.prototype.inspect),w.prototype.compare=function(v,T,z,me,ve){if(qe(v,Uint8Array)&&(v=w.from(v,v.offset,v.byteLength)),!w.isBuffer(v))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof v);if(T===void 0&&(T=0),z===void 0&&(z=v?v.length:0),me===void 0&&(me=0),ve===void 0&&(ve=this.length),T<0||z>v.length||me<0||ve>this.length)throw new RangeError("out of range index");if(me>=ve&&T>=z)return 0;if(me>=ve)return-1;if(T>=z)return 1;if(T>>>=0,z>>>=0,me>>>=0,ve>>>=0,this===v)return 0;let Se=ve-me,Fe=z-T;const je=Math.min(Se,Fe),He=this.slice(me,ve),We=v.slice(T,z);for(let Ue=0;Ue<je;++Ue)if(He[Ue]!==We[Ue]){Se=He[Ue],Fe=We[Ue];break}return Se<Fe?-1:Fe<Se?1:0};function Re(k,v,T,z,me){if(k.length===0)return-1;if(typeof T=="string"?(z=T,T=0):T>2147483647?T=2147483647:T<-2147483648&&(T=-2147483648),T=+T,_t(T)&&(T=me?0:k.length-1),T<0&&(T=k.length+T),T>=k.length){if(me)return-1;T=k.length-1}else if(T<0)if(me)T=0;else return-1;if(typeof v=="string"&&(v=w.from(v,z)),w.isBuffer(v))return v.length===0?-1:ke(k,v,T,z,me);if(typeof v=="number")return v=v&255,typeof Uint8Array.prototype.indexOf=="function"?me?Uint8Array.prototype.indexOf.call(k,v,T):Uint8Array.prototype.lastIndexOf.call(k,v,T):ke(k,[v],T,z,me);throw new TypeError("val must be string, number or Buffer")}function ke(k,v,T,z,me){let ve=1,Se=k.length,Fe=v.length;if(z!==void 0&&(z=String(z).toLowerCase(),z==="ucs2"||z==="ucs-2"||z==="utf16le"||z==="utf-16le")){if(k.length<2||v.length<2)return-1;ve=2,Se/=2,Fe/=2,T/=2}function je(We,Ue){return ve===1?We[Ue]:We.readUInt16BE(Ue*ve)}let He;if(me){let We=-1;for(He=T;He<Se;He++)if(je(k,He)===je(v,We===-1?0:He-We)){if(We===-1&&(We=He),He-We+1===Fe)return We*ve}else We!==-1&&(He-=He-We),We=-1}else for(T+Fe>Se&&(T=Se-Fe),He=T;He>=0;He--){let We=!0;for(let Ue=0;Ue<Fe;Ue++)if(je(k,He+Ue)!==je(v,Ue)){We=!1;break}if(We)return He}return-1}w.prototype.includes=function(v,T,z){return this.indexOf(v,T,z)!==-1},w.prototype.indexOf=function(v,T,z){return Re(this,v,T,z,!0)},w.prototype.lastIndexOf=function(v,T,z){return Re(this,v,T,z,!1)};function De(k,v,T,z){T=Number(T)||0;const me=k.length-T;z?(z=Number(z),z>me&&(z=me)):z=me;const ve=v.length;z>ve/2&&(z=ve/2);let Se;for(Se=0;Se<z;++Se){const Fe=parseInt(v.substr(Se*2,2),16);if(_t(Fe))return Se;k[T+Se]=Fe}return Se}function _e(k,v,T,z){return nt(Ge(v,k.length-T),k,T,z)}function Le(k,v,T,z){return nt(et(v),k,T,z)}function Ce(k,v,T,z){return nt(ct(v),k,T,z)}function Oe(k,v,T,z){return nt(dt(v,k.length-T),k,T,z)}w.prototype.write=function(v,T,z,me){if(T===void 0)me="utf8",z=this.length,T=0;else if(z===void 0&&typeof T=="string")me=T,z=this.length,T=0;else if(isFinite(T))T=T>>>0,isFinite(z)?(z=z>>>0,me===void 0&&(me="utf8")):(me=z,z=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ve=this.length-T;if((z===void 0||z>ve)&&(z=ve),v.length>0&&(z<0||T<0)||T>this.length)throw new RangeError("Attempt to write outside buffer bounds");me||(me="utf8");let Se=!1;for(;;)switch(me){case"hex":return De(this,v,T,z);case"utf8":case"utf-8":return _e(this,v,T,z);case"ascii":case"latin1":case"binary":return Le(this,v,T,z);case"base64":return Ce(this,v,T,z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Oe(this,v,T,z);default:if(Se)throw new TypeError("Unknown encoding: "+me);me=(""+me).toLowerCase(),Se=!0}},w.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ye(k,v,T){return v===0&&T===k.length?r.fromByteArray(k):r.fromByteArray(k.slice(v,T))}function Qe(k,v,T){T=Math.min(k.length,T);const z=[];let me=v;for(;me<T;){const ve=k[me];let Se=null,Fe=ve>239?4:ve>223?3:ve>191?2:1;if(me+Fe<=T){let je,He,We,Ue;switch(Fe){case 1:ve<128&&(Se=ve);break;case 2:je=k[me+1],(je&192)===128&&(Ue=(ve&31)<<6|je&63,Ue>127&&(Se=Ue));break;case 3:je=k[me+1],He=k[me+2],(je&192)===128&&(He&192)===128&&(Ue=(ve&15)<<12|(je&63)<<6|He&63,Ue>2047&&(Ue<55296||Ue>57343)&&(Se=Ue));break;case 4:je=k[me+1],He=k[me+2],We=k[me+3],(je&192)===128&&(He&192)===128&&(We&192)===128&&(Ue=(ve&15)<<18|(je&63)<<12|(He&63)<<6|We&63,Ue>65535&&Ue<1114112&&(Se=Ue))}}Se===null?(Se=65533,Fe=1):Se>65535&&(Se-=65536,z.push(Se>>>10&1023|55296),Se=56320|Se&1023),z.push(Se),me+=Fe}return rt(z)}const Je=4096;function rt(k){const v=k.length;if(v<=Je)return String.fromCharCode.apply(String,k);let T="",z=0;for(;z<v;)T+=String.fromCharCode.apply(String,k.slice(z,z+=Je));return T}function Be(k,v,T){let z="";T=Math.min(k.length,T);for(let me=v;me<T;++me)z+=String.fromCharCode(k[me]&127);return z}function tt(k,v,T){let z="";T=Math.min(k.length,T);for(let me=v;me<T;++me)z+=String.fromCharCode(k[me]);return z}function ot(k,v,T){const z=k.length;(!v||v<0)&&(v=0),(!T||T<0||T>z)&&(T=z);let me="";for(let ve=v;ve<T;++ve)me+=pt[k[ve]];return me}function st(k,v,T){const z=k.slice(v,T);let me="";for(let ve=0;ve<z.length-1;ve+=2)me+=String.fromCharCode(z[ve]+z[ve+1]*256);return me}w.prototype.slice=function(v,T){const z=this.length;v=~~v,T=T===void 0?z:~~T,v<0?(v+=z,v<0&&(v=0)):v>z&&(v=z),T<0?(T+=z,T<0&&(T=0)):T>z&&(T=z),T<v&&(T=v);const me=this.subarray(v,T);return Object.setPrototypeOf(me,w.prototype),me};function Pe(k,v,T){if(k%1!==0||k<0)throw new RangeError("offset is not uint");if(k+v>T)throw new RangeError("Trying to access beyond buffer length")}w.prototype.readUintLE=w.prototype.readUIntLE=function(v,T,z){v=v>>>0,T=T>>>0,z||Pe(v,T,this.length);let me=this[v],ve=1,Se=0;for(;++Se<T&&(ve*=256);)me+=this[v+Se]*ve;return me},w.prototype.readUintBE=w.prototype.readUIntBE=function(v,T,z){v=v>>>0,T=T>>>0,z||Pe(v,T,this.length);let me=this[v+--T],ve=1;for(;T>0&&(ve*=256);)me+=this[v+--T]*ve;return me},w.prototype.readUint8=w.prototype.readUInt8=function(v,T){return v=v>>>0,T||Pe(v,1,this.length),this[v]},w.prototype.readUint16LE=w.prototype.readUInt16LE=function(v,T){return v=v>>>0,T||Pe(v,2,this.length),this[v]|this[v+1]<<8},w.prototype.readUint16BE=w.prototype.readUInt16BE=function(v,T){return v=v>>>0,T||Pe(v,2,this.length),this[v]<<8|this[v+1]},w.prototype.readUint32LE=w.prototype.readUInt32LE=function(v,T){return v=v>>>0,T||Pe(v,4,this.length),(this[v]|this[v+1]<<8|this[v+2]<<16)+this[v+3]*16777216},w.prototype.readUint32BE=w.prototype.readUInt32BE=function(v,T){return v=v>>>0,T||Pe(v,4,this.length),this[v]*16777216+(this[v+1]<<16|this[v+2]<<8|this[v+3])},w.prototype.readBigUInt64LE=at(function(v){v=v>>>0,Ze(v,"offset");const T=this[v],z=this[v+7];(T===void 0||z===void 0)&&Xe(v,this.length-8);const me=T+this[++v]*2**8+this[++v]*2**16+this[++v]*2**24,ve=this[++v]+this[++v]*2**8+this[++v]*2**16+z*2**24;return BigInt(me)+(BigInt(ve)<<BigInt(32))}),w.prototype.readBigUInt64BE=at(function(v){v=v>>>0,Ze(v,"offset");const T=this[v],z=this[v+7];(T===void 0||z===void 0)&&Xe(v,this.length-8);const me=T*2**24+this[++v]*2**16+this[++v]*2**8+this[++v],ve=this[++v]*2**24+this[++v]*2**16+this[++v]*2**8+z;return(BigInt(me)<<BigInt(32))+BigInt(ve)}),w.prototype.readIntLE=function(v,T,z){v=v>>>0,T=T>>>0,z||Pe(v,T,this.length);let me=this[v],ve=1,Se=0;for(;++Se<T&&(ve*=256);)me+=this[v+Se]*ve;return ve*=128,me>=ve&&(me-=Math.pow(2,8*T)),me},w.prototype.readIntBE=function(v,T,z){v=v>>>0,T=T>>>0,z||Pe(v,T,this.length);let me=T,ve=1,Se=this[v+--me];for(;me>0&&(ve*=256);)Se+=this[v+--me]*ve;return ve*=128,Se>=ve&&(Se-=Math.pow(2,8*T)),Se},w.prototype.readInt8=function(v,T){return v=v>>>0,T||Pe(v,1,this.length),this[v]&128?(255-this[v]+1)*-1:this[v]},w.prototype.readInt16LE=function(v,T){v=v>>>0,T||Pe(v,2,this.length);const z=this[v]|this[v+1]<<8;return z&32768?z|4294901760:z},w.prototype.readInt16BE=function(v,T){v=v>>>0,T||Pe(v,2,this.length);const z=this[v+1]|this[v]<<8;return z&32768?z|4294901760:z},w.prototype.readInt32LE=function(v,T){return v=v>>>0,T||Pe(v,4,this.length),this[v]|this[v+1]<<8|this[v+2]<<16|this[v+3]<<24},w.prototype.readInt32BE=function(v,T){return v=v>>>0,T||Pe(v,4,this.length),this[v]<<24|this[v+1]<<16|this[v+2]<<8|this[v+3]},w.prototype.readBigInt64LE=at(function(v){v=v>>>0,Ze(v,"offset");const T=this[v],z=this[v+7];(T===void 0||z===void 0)&&Xe(v,this.length-8);const me=this[v+4]+this[v+5]*2**8+this[v+6]*2**16+(z<<24);return(BigInt(me)<<BigInt(32))+BigInt(T+this[++v]*2**8+this[++v]*2**16+this[++v]*2**24)}),w.prototype.readBigInt64BE=at(function(v){v=v>>>0,Ze(v,"offset");const T=this[v],z=this[v+7];(T===void 0||z===void 0)&&Xe(v,this.length-8);const me=(T<<24)+this[++v]*2**16+this[++v]*2**8+this[++v];return(BigInt(me)<<BigInt(32))+BigInt(this[++v]*2**24+this[++v]*2**16+this[++v]*2**8+z)}),w.prototype.readFloatLE=function(v,T){return v=v>>>0,T||Pe(v,4,this.length),t.read(this,v,!0,23,4)},w.prototype.readFloatBE=function(v,T){return v=v>>>0,T||Pe(v,4,this.length),t.read(this,v,!1,23,4)},w.prototype.readDoubleLE=function(v,T){return v=v>>>0,T||Pe(v,8,this.length),t.read(this,v,!0,52,8)},w.prototype.readDoubleBE=function(v,T){return v=v>>>0,T||Pe(v,8,this.length),t.read(this,v,!1,52,8)};function Ke(k,v,T,z,me,ve){if(!w.isBuffer(k))throw new TypeError('"buffer" argument must be a Buffer instance');if(v>me||v<ve)throw new RangeError('"value" argument is out of bounds');if(T+z>k.length)throw new RangeError("Index out of range")}w.prototype.writeUintLE=w.prototype.writeUIntLE=function(v,T,z,me){if(v=+v,T=T>>>0,z=z>>>0,!me){const Fe=Math.pow(2,8*z)-1;Ke(this,v,T,z,Fe,0)}let ve=1,Se=0;for(this[T]=v&255;++Se<z&&(ve*=256);)this[T+Se]=v/ve&255;return T+z},w.prototype.writeUintBE=w.prototype.writeUIntBE=function(v,T,z,me){if(v=+v,T=T>>>0,z=z>>>0,!me){const Fe=Math.pow(2,8*z)-1;Ke(this,v,T,z,Fe,0)}let ve=z-1,Se=1;for(this[T+ve]=v&255;--ve>=0&&(Se*=256);)this[T+ve]=v/Se&255;return T+z},w.prototype.writeUint8=w.prototype.writeUInt8=function(v,T,z){return v=+v,T=T>>>0,z||Ke(this,v,T,1,255,0),this[T]=v&255,T+1},w.prototype.writeUint16LE=w.prototype.writeUInt16LE=function(v,T,z){return v=+v,T=T>>>0,z||Ke(this,v,T,2,65535,0),this[T]=v&255,this[T+1]=v>>>8,T+2},w.prototype.writeUint16BE=w.prototype.writeUInt16BE=function(v,T,z){return v=+v,T=T>>>0,z||Ke(this,v,T,2,65535,0),this[T]=v>>>8,this[T+1]=v&255,T+2},w.prototype.writeUint32LE=w.prototype.writeUInt32LE=function(v,T,z){return v=+v,T=T>>>0,z||Ke(this,v,T,4,4294967295,0),this[T+3]=v>>>24,this[T+2]=v>>>16,this[T+1]=v>>>8,this[T]=v&255,T+4},w.prototype.writeUint32BE=w.prototype.writeUInt32BE=function(v,T,z){return v=+v,T=T>>>0,z||Ke(this,v,T,4,4294967295,0),this[T]=v>>>24,this[T+1]=v>>>16,this[T+2]=v>>>8,this[T+3]=v&255,T+4};function lt(k,v,T,z,me){ze(v,z,me,k,T,7);let ve=Number(v&BigInt(4294967295));k[T++]=ve,ve=ve>>8,k[T++]=ve,ve=ve>>8,k[T++]=ve,ve=ve>>8,k[T++]=ve;let Se=Number(v>>BigInt(32)&BigInt(4294967295));return k[T++]=Se,Se=Se>>8,k[T++]=Se,Se=Se>>8,k[T++]=Se,Se=Se>>8,k[T++]=Se,T}function ft(k,v,T,z,me){ze(v,z,me,k,T,7);let ve=Number(v&BigInt(4294967295));k[T+7]=ve,ve=ve>>8,k[T+6]=ve,ve=ve>>8,k[T+5]=ve,ve=ve>>8,k[T+4]=ve;let Se=Number(v>>BigInt(32)&BigInt(4294967295));return k[T+3]=Se,Se=Se>>8,k[T+2]=Se,Se=Se>>8,k[T+1]=Se,Se=Se>>8,k[T]=Se,T+8}w.prototype.writeBigUInt64LE=at(function(v,T=0){return lt(this,v,T,BigInt(0),BigInt("0xffffffffffffffff"))}),w.prototype.writeBigUInt64BE=at(function(v,T=0){return ft(this,v,T,BigInt(0),BigInt("0xffffffffffffffff"))}),w.prototype.writeIntLE=function(v,T,z,me){if(v=+v,T=T>>>0,!me){const je=Math.pow(2,8*z-1);Ke(this,v,T,z,je-1,-je)}let ve=0,Se=1,Fe=0;for(this[T]=v&255;++ve<z&&(Se*=256);)v<0&&Fe===0&&this[T+ve-1]!==0&&(Fe=1),this[T+ve]=(v/Se>>0)-Fe&255;return T+z},w.prototype.writeIntBE=function(v,T,z,me){if(v=+v,T=T>>>0,!me){const je=Math.pow(2,8*z-1);Ke(this,v,T,z,je-1,-je)}let ve=z-1,Se=1,Fe=0;for(this[T+ve]=v&255;--ve>=0&&(Se*=256);)v<0&&Fe===0&&this[T+ve+1]!==0&&(Fe=1),this[T+ve]=(v/Se>>0)-Fe&255;return T+z},w.prototype.writeInt8=function(v,T,z){return v=+v,T=T>>>0,z||Ke(this,v,T,1,127,-128),v<0&&(v=255+v+1),this[T]=v&255,T+1},w.prototype.writeInt16LE=function(v,T,z){return v=+v,T=T>>>0,z||Ke(this,v,T,2,32767,-32768),this[T]=v&255,this[T+1]=v>>>8,T+2},w.prototype.writeInt16BE=function(v,T,z){return v=+v,T=T>>>0,z||Ke(this,v,T,2,32767,-32768),this[T]=v>>>8,this[T+1]=v&255,T+2},w.prototype.writeInt32LE=function(v,T,z){return v=+v,T=T>>>0,z||Ke(this,v,T,4,2147483647,-2147483648),this[T]=v&255,this[T+1]=v>>>8,this[T+2]=v>>>16,this[T+3]=v>>>24,T+4},w.prototype.writeInt32BE=function(v,T,z){return v=+v,T=T>>>0,z||Ke(this,v,T,4,2147483647,-2147483648),v<0&&(v=4294967295+v+1),this[T]=v>>>24,this[T+1]=v>>>16,this[T+2]=v>>>8,this[T+3]=v&255,T+4},w.prototype.writeBigInt64LE=at(function(v,T=0){return lt(this,v,T,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),w.prototype.writeBigInt64BE=at(function(v,T=0){return ft(this,v,T,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ut(k,v,T,z,me,ve){if(T+z>k.length)throw new RangeError("Index out of range");if(T<0)throw new RangeError("Index out of range")}function ht(k,v,T,z,me){return v=+v,T=T>>>0,me||ut(k,v,T,4),t.write(k,v,T,z,23,4),T+4}w.prototype.writeFloatLE=function(v,T,z){return ht(this,v,T,!0,z)},w.prototype.writeFloatBE=function(v,T,z){return ht(this,v,T,!1,z)};function Z(k,v,T,z,me){return v=+v,T=T>>>0,me||ut(k,v,T,8),t.write(k,v,T,z,52,8),T+8}w.prototype.writeDoubleLE=function(v,T,z){return Z(this,v,T,!0,z)},w.prototype.writeDoubleBE=function(v,T,z){return Z(this,v,T,!1,z)},w.prototype.copy=function(v,T,z,me){if(!w.isBuffer(v))throw new TypeError("argument should be a Buffer");if(z||(z=0),!me&&me!==0&&(me=this.length),T>=v.length&&(T=v.length),T||(T=0),me>0&&me<z&&(me=z),me===z||v.length===0||this.length===0)return 0;if(T<0)throw new RangeError("targetStart out of bounds");if(z<0||z>=this.length)throw new RangeError("Index out of range");if(me<0)throw new RangeError("sourceEnd out of bounds");me>this.length&&(me=this.length),v.length-T<me-z&&(me=v.length-T+z);const ve=me-z;return this===v&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(T,z,me):Uint8Array.prototype.set.call(v,this.subarray(z,me),T),ve},w.prototype.fill=function(v,T,z,me){if(typeof v=="string"){if(typeof T=="string"?(me=T,T=0,z=this.length):typeof z=="string"&&(me=z,z=this.length),me!==void 0&&typeof me!="string")throw new TypeError("encoding must be a string");if(typeof me=="string"&&!w.isEncoding(me))throw new TypeError("Unknown encoding: "+me);if(v.length===1){const Se=v.charCodeAt(0);(me==="utf8"&&Se<128||me==="latin1")&&(v=Se)}}else typeof v=="number"?v=v&255:typeof v=="boolean"&&(v=Number(v));if(T<0||this.length<T||this.length<z)throw new RangeError("Out of range index");if(z<=T)return this;T=T>>>0,z=z===void 0?this.length:z>>>0,v||(v=0);let ve;if(typeof v=="number")for(ve=T;ve<z;++ve)this[ve]=v;else{const Se=w.isBuffer(v)?v:w.from(v,me),Fe=Se.length;if(Fe===0)throw new TypeError('The value "'+v+'" is invalid for argument "value"');for(ve=0;ve<z-T;++ve)this[ve+T]=Se[ve%Fe]}return this};const N={};function $e(k,v,T){N[k]=class extends T{constructor(){super(),Object.defineProperty(this,"message",{value:v.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${k}]`,this.stack,delete this.name}get code(){return k}set code(me){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:me,writable:!0})}toString(){return`${this.name} [${k}]: ${this.message}`}}}$e("ERR_BUFFER_OUT_OF_BOUNDS",function(k){return k?`${k} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),$e("ERR_INVALID_ARG_TYPE",function(k,v){return`The "${k}" argument must be of type number. Received type ${typeof v}`},TypeError),$e("ERR_OUT_OF_RANGE",function(k,v,T){let z=`The value of "${k}" is out of range.`,me=T;return Number.isInteger(T)&&Math.abs(T)>2**32?me=Ee(String(T)):typeof T=="bigint"&&(me=String(T),(T>BigInt(2)**BigInt(32)||T<-(BigInt(2)**BigInt(32)))&&(me=Ee(me)),me+="n"),z+=` It must be ${v}. Received ${me}`,z},RangeError);function Ee(k){let v="",T=k.length;const z=k[0]==="-"?1:0;for(;T>=z+4;T-=3)v=`_${k.slice(T-3,T)}${v}`;return`${k.slice(0,T)}${v}`}function Me(k,v,T){Ze(v,"offset"),(k[v]===void 0||k[v+T]===void 0)&&Xe(v,k.length-(T+1))}function ze(k,v,T,z,me,ve){if(k>T||k<v){const Se=typeof v=="bigint"?"n":"";let Fe;throw ve>3?v===0||v===BigInt(0)?Fe=`>= 0${Se} and < 2${Se} ** ${(ve+1)*8}${Se}`:Fe=`>= -(2${Se} ** ${(ve+1)*8-1}${Se}) and < 2 ** ${(ve+1)*8-1}${Se}`:Fe=`>= ${v}${Se} and <= ${T}${Se}`,new N.ERR_OUT_OF_RANGE("value",Fe,k)}Me(z,me,ve)}function Ze(k,v){if(typeof k!="number")throw new N.ERR_INVALID_ARG_TYPE(v,"number",k)}function Xe(k,v,T){throw Math.floor(k)!==k?(Ze(k,T),new N.ERR_OUT_OF_RANGE(T||"offset","an integer",k)):v<0?new N.ERR_BUFFER_OUT_OF_BOUNDS:new N.ERR_OUT_OF_RANGE(T||"offset",`>= ${T?1:0} and <= ${v}`,k)}const Ve=/[^+/0-9A-Za-z-_]/g;function it(k){if(k=k.split("=")[0],k=k.trim().replace(Ve,""),k.length<2)return"";for(;k.length%4!==0;)k=k+"=";return k}function Ge(k,v){v=v||1/0;let T;const z=k.length;let me=null;const ve=[];for(let Se=0;Se<z;++Se){if(T=k.charCodeAt(Se),T>55295&&T<57344){if(!me){if(T>56319){(v-=3)>-1&&ve.push(239,191,189);continue}else if(Se+1===z){(v-=3)>-1&&ve.push(239,191,189);continue}me=T;continue}if(T<56320){(v-=3)>-1&&ve.push(239,191,189),me=T;continue}T=(me-55296<<10|T-56320)+65536}else me&&(v-=3)>-1&&ve.push(239,191,189);if(me=null,T<128){if((v-=1)<0)break;ve.push(T)}else if(T<2048){if((v-=2)<0)break;ve.push(T>>6|192,T&63|128)}else if(T<65536){if((v-=3)<0)break;ve.push(T>>12|224,T>>6&63|128,T&63|128)}else if(T<1114112){if((v-=4)<0)break;ve.push(T>>18|240,T>>12&63|128,T>>6&63|128,T&63|128)}else throw new Error("Invalid code point")}return ve}function et(k){const v=[];for(let T=0;T<k.length;++T)v.push(k.charCodeAt(T)&255);return v}function dt(k,v){let T,z,me;const ve=[];for(let Se=0;Se<k.length&&!((v-=2)<0);++Se)T=k.charCodeAt(Se),z=T>>8,me=T%256,ve.push(me),ve.push(z);return ve}function ct(k){return r.toByteArray(it(k))}function nt(k,v,T,z){let me;for(me=0;me<z&&!(me+T>=v.length||me>=k.length);++me)v[me+T]=k[me];return me}function qe(k,v){return k instanceof v||k!=null&&k.constructor!=null&&k.constructor.name!=null&&k.constructor.name===v.name}function _t(k){return k!==k}const pt=function(){const k="0123456789abcdef",v=new Array(256);for(let T=0;T<16;++T){const z=T*16;for(let me=0;me<16;++me)v[z+me]=k[T]+k[me]}return v}();function at(k){return typeof BigInt=="undefined"?mt:k}function mt(){throw new Error("BigInt not supported")}})(buffer);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(e,r){var t=buffer,E=t.Buffer;function y(I,w){for(var M in I)w[M]=I[M]}E.from&&E.alloc&&E.allocUnsafe&&E.allocUnsafeSlow?e.exports=t:(y(t,r),r.Buffer=x);function x(I,w,M){return E(I,w,M)}x.prototype=Object.create(E.prototype),y(E,x),x.from=function(I,w,M){if(typeof I=="number")throw new TypeError("Argument must not be a number");return E(I,w,M)},x.alloc=function(I,w,M){if(typeof I!="number")throw new TypeError("Argument must be a number");var D=E(I);return w!==void 0?typeof M=="string"?D.fill(w,M):D.fill(w):D.fill(0),D},x.allocUnsafe=function(I){if(typeof I!="number")throw new TypeError("Argument must be a number");return E(I)},x.allocUnsafeSlow=function(I){if(typeof I!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(I)}})(safeBuffer,safeBuffer.exports);var Buffer$1=safeBuffer.exports.Buffer,isEncoding=Buffer$1.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(e){if(!e)return"utf8";for(var r;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(r)return;e=(""+e).toLowerCase(),r=!0}}function normalizeEncoding(e){var r=_normalizeEncoding(e);if(typeof r!="string"&&(Buffer$1.isEncoding===isEncoding||!isEncoding(e)))throw new Error("Unknown encoding: "+e);return r||e}string_decoder.StringDecoder=StringDecoder;function StringDecoder(e){this.encoding=normalizeEncoding(e);var r;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,r=4;break;case"utf8":this.fillLast=utf8FillLast,r=4;break;case"base64":this.text=base64Text,this.end=base64End,r=3;break;default:this.write=simpleWrite,this.end=simpleEnd;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer$1.allocUnsafe(r)}StringDecoder.prototype.write=function(e){if(e.length===0)return"";var r,t;if(this.lastNeed){if(r=this.fillLast(e),r===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<e.length?r?r+this.text(e,t):this.text(e,t):r||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};function utf8CheckByte(e){return e<=127?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:e>>6===2?-1:-2}function utf8CheckIncomplete(e,r,t){var E=r.length-1;if(E<t)return 0;var y=utf8CheckByte(r[E]);return y>=0?(y>0&&(e.lastNeed=y-1),y):--E<t||y===-2?0:(y=utf8CheckByte(r[E]),y>=0?(y>0&&(e.lastNeed=y-2),y):--E<t||y===-2?0:(y=utf8CheckByte(r[E]),y>=0?(y>0&&(y===2?y=0:e.lastNeed=y-3),y):0))}function utf8CheckExtraBytes(e,r,t){if((r[0]&192)!==128)return e.lastNeed=0,"\uFFFD";if(e.lastNeed>1&&r.length>1){if((r[1]&192)!==128)return e.lastNeed=1,"\uFFFD";if(e.lastNeed>2&&r.length>2&&(r[2]&192)!==128)return e.lastNeed=2,"\uFFFD"}}function utf8FillLast(e){var r=this.lastTotal-this.lastNeed,t=utf8CheckExtraBytes(this,e);if(t!==void 0)return t;if(this.lastNeed<=e.length)return e.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,r,0,e.length),this.lastNeed-=e.length}function utf8Text(e,r){var t=utf8CheckIncomplete(this,e,r);if(!this.lastNeed)return e.toString("utf8",r);this.lastTotal=t;var E=e.length-(t-this.lastNeed);return e.copy(this.lastChar,0,E),e.toString("utf8",r,E)}function utf8End(e){var r=e&&e.length?this.write(e):"";return this.lastNeed?r+"\uFFFD":r}function utf16Text(e,r){if((e.length-r)%2===0){var t=e.toString("utf16le",r);if(t){var E=t.charCodeAt(t.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",r,e.length-1)}function utf16End(e){var r=e&&e.length?this.write(e):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,t)}return r}function base64Text(e,r){var t=(e.length-r)%3;return t===0?e.toString("base64",r):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",r,e.length-t))}function base64End(e){var r=e&&e.length?this.write(e):"";return this.lastNeed?r+this.lastChar.toString("base64",0,3-this.lastNeed):r}function simpleWrite(e){return e.toString(this.encoding)}function simpleEnd(e){return e&&e.length?this.write(e):""}(function(e){(function(r){r.parser=function(Z,N){return new E(Z,N)},r.SAXParser=E,r.SAXStream=O,r.createStream=D,r.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];r.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function E(Z,N){if(!(this instanceof E))return new E(Z,N);var $e=this;x($e),$e.q=$e.c="",$e.bufferCheckPosition=r.MAX_BUFFER_LENGTH,$e.opt=N||{},$e.opt.lowercase=$e.opt.lowercase||$e.opt.lowercasetags,$e.looseCase=$e.opt.lowercase?"toLowerCase":"toUpperCase",$e.tags=[],$e.closed=$e.closedRoot=$e.sawRoot=!1,$e.tag=$e.error=null,$e.strict=!!Z,$e.noscript=!!(Z||$e.opt.noscript),$e.state=_e.BEGIN,$e.strictEntities=$e.opt.strictEntities,$e.ENTITIES=$e.strictEntities?Object.create(r.XML_ENTITIES):Object.create(r.ENTITIES),$e.attribList=[],$e.opt.xmlns&&($e.ns=Object.create(we)),$e.trackPosition=$e.opt.position!==!1,$e.trackPosition&&($e.position=$e.line=$e.column=0),Ce($e,"onready")}Object.create||(Object.create=function(Z){function N(){}N.prototype=Z;var $e=new N;return $e}),Object.keys||(Object.keys=function(Z){var N=[];for(var $e in Z)Z.hasOwnProperty($e)&&N.push($e);return N});function y(Z){for(var N=Math.max(r.MAX_BUFFER_LENGTH,10),$e=0,Ee=0,Me=t.length;Ee<Me;Ee++){var ze=Z[t[Ee]].length;if(ze>N)switch(t[Ee]){case"textNode":Ye(Z);break;case"cdata":Oe(Z,"oncdata",Z.cdata),Z.cdata="";break;case"script":Oe(Z,"onscript",Z.script),Z.script="";break;default:Je(Z,"Max buffer length exceeded: "+t[Ee])}$e=Math.max($e,ze)}var Ze=r.MAX_BUFFER_LENGTH-$e;Z.bufferCheckPosition=Ze+Z.position}function x(Z){for(var N=0,$e=t.length;N<$e;N++)Z[t[N]]=""}function I(Z){Ye(Z),Z.cdata!==""&&(Oe(Z,"oncdata",Z.cdata),Z.cdata=""),Z.script!==""&&(Oe(Z,"onscript",Z.script),Z.script="")}E.prototype={end:function(){rt(this)},write:ht,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){I(this)}};var w;try{w=require("stream").Stream}catch(Z){w=function(){}}w||(w=function(){});var M=r.EVENTS.filter(function(Z){return Z!=="error"&&Z!=="end"});function D(Z,N){return new O(Z,N)}function O(Z,N){if(!(this instanceof O))return new O(Z,N);w.apply(this),this._parser=new E(Z,N),this.writable=!0,this.readable=!0;var $e=this;this._parser.onend=function(){$e.emit("end")},this._parser.onerror=function(Ee){$e.emit("error",Ee),$e._parser.error=null},this._decoder=null,M.forEach(function(Ee){Object.defineProperty($e,"on"+Ee,{get:function(){return $e._parser["on"+Ee]},set:function(Me){if(!Me)return $e.removeAllListeners(Ee),$e._parser["on"+Ee]=Me,Me;$e.on(Ee,Me)},enumerable:!0,configurable:!1})})}O.prototype=Object.create(w.prototype,{constructor:{value:O}}),O.prototype.write=function(Z){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(Z)){if(!this._decoder){var N=string_decoder.StringDecoder;this._decoder=new N("utf8")}Z=this._decoder.write(Z)}return this._parser.write(Z.toString()),this.emit("data",Z),!0},O.prototype.end=function(Z){return Z&&Z.length&&this.write(Z),this._parser.end(),!0},O.prototype.on=function(Z,N){var $e=this;return!$e._parser["on"+Z]&&M.indexOf(Z)!==-1&&($e._parser["on"+Z]=function(){var Ee=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);Ee.splice(0,0,Z),$e.emit.apply($e,Ee)}),w.prototype.on.call($e,Z,N)};var Te="[CDATA[",he="DOCTYPE",ce="http://www.w3.org/XML/1998/namespace",ge="http://www.w3.org/2000/xmlns/",we={xml:ce,xmlns:ge},ye=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,xe=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,be=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Ne=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function Ie(Z){return Z===" "||Z===`
`||Z==="\r"||Z==="	"}function Ae(Z){return Z==='"'||Z==="'"}function Re(Z){return Z===">"||Ie(Z)}function ke(Z,N){return Z.test(N)}function De(Z,N){return!ke(Z,N)}var _e=0;r.STATE={BEGIN:_e++,BEGIN_WHITESPACE:_e++,TEXT:_e++,TEXT_ENTITY:_e++,OPEN_WAKA:_e++,SGML_DECL:_e++,SGML_DECL_QUOTED:_e++,DOCTYPE:_e++,DOCTYPE_QUOTED:_e++,DOCTYPE_DTD:_e++,DOCTYPE_DTD_QUOTED:_e++,COMMENT_STARTING:_e++,COMMENT:_e++,COMMENT_ENDING:_e++,COMMENT_ENDED:_e++,CDATA:_e++,CDATA_ENDING:_e++,CDATA_ENDING_2:_e++,PROC_INST:_e++,PROC_INST_BODY:_e++,PROC_INST_ENDING:_e++,OPEN_TAG:_e++,OPEN_TAG_SLASH:_e++,ATTRIB:_e++,ATTRIB_NAME:_e++,ATTRIB_NAME_SAW_WHITE:_e++,ATTRIB_VALUE:_e++,ATTRIB_VALUE_QUOTED:_e++,ATTRIB_VALUE_CLOSED:_e++,ATTRIB_VALUE_UNQUOTED:_e++,ATTRIB_VALUE_ENTITY_Q:_e++,ATTRIB_VALUE_ENTITY_U:_e++,CLOSE_TAG:_e++,CLOSE_TAG_SAW_WHITE:_e++,SCRIPT:_e++,SCRIPT_ENDING:_e++},r.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},r.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(r.ENTITIES).forEach(function(Z){var N=r.ENTITIES[Z],$e=typeof N=="number"?String.fromCharCode(N):N;r.ENTITIES[Z]=$e});for(var Le in r.STATE)r.STATE[r.STATE[Le]]=Le;_e=r.STATE;function Ce(Z,N,$e){Z[N]&&Z[N]($e)}function Oe(Z,N,$e){Z.textNode&&Ye(Z),Ce(Z,N,$e)}function Ye(Z){Z.textNode=Qe(Z.opt,Z.textNode),Z.textNode&&Ce(Z,"ontext",Z.textNode),Z.textNode=""}function Qe(Z,N){return Z.trim&&(N=N.trim()),Z.normalize&&(N=N.replace(/\s+/g," ")),N}function Je(Z,N){return Ye(Z),Z.trackPosition&&(N+=`
Line: `+Z.line+`
Column: `+Z.column+`
Char: `+Z.c),N=new Error(N),Z.error=N,Ce(Z,"onerror",N),Z}function rt(Z){return Z.sawRoot&&!Z.closedRoot&&Be(Z,"Unclosed root tag"),Z.state!==_e.BEGIN&&Z.state!==_e.BEGIN_WHITESPACE&&Z.state!==_e.TEXT&&Je(Z,"Unexpected end"),Ye(Z),Z.c="",Z.closed=!0,Ce(Z,"onend"),E.call(Z,Z.strict,Z.opt),Z}function Be(Z,N){if(typeof Z!="object"||!(Z instanceof E))throw new Error("bad call to strictFail");Z.strict&&Je(Z,N)}function tt(Z){Z.strict||(Z.tagName=Z.tagName[Z.looseCase]());var N=Z.tags[Z.tags.length-1]||Z,$e=Z.tag={name:Z.tagName,attributes:{}};Z.opt.xmlns&&($e.ns=N.ns),Z.attribList.length=0,Oe(Z,"onopentagstart",$e)}function ot(Z,N){var $e=Z.indexOf(":"),Ee=$e<0?["",Z]:Z.split(":"),Me=Ee[0],ze=Ee[1];return N&&Z==="xmlns"&&(Me="xmlns",ze=""),{prefix:Me,local:ze}}function st(Z){if(Z.strict||(Z.attribName=Z.attribName[Z.looseCase]()),Z.attribList.indexOf(Z.attribName)!==-1||Z.tag.attributes.hasOwnProperty(Z.attribName)){Z.attribName=Z.attribValue="";return}if(Z.opt.xmlns){var N=ot(Z.attribName,!0),$e=N.prefix,Ee=N.local;if($e==="xmlns")if(Ee==="xml"&&Z.attribValue!==ce)Be(Z,"xml: prefix must be bound to "+ce+`
Actual: `+Z.attribValue);else if(Ee==="xmlns"&&Z.attribValue!==ge)Be(Z,"xmlns: prefix must be bound to "+ge+`
Actual: `+Z.attribValue);else{var Me=Z.tag,ze=Z.tags[Z.tags.length-1]||Z;Me.ns===ze.ns&&(Me.ns=Object.create(ze.ns)),Me.ns[Ee]=Z.attribValue}Z.attribList.push([Z.attribName,Z.attribValue])}else Z.tag.attributes[Z.attribName]=Z.attribValue,Oe(Z,"onattribute",{name:Z.attribName,value:Z.attribValue});Z.attribName=Z.attribValue=""}function Pe(Z,N){if(Z.opt.xmlns){var $e=Z.tag,Ee=ot(Z.tagName);$e.prefix=Ee.prefix,$e.local=Ee.local,$e.uri=$e.ns[Ee.prefix]||"",$e.prefix&&!$e.uri&&(Be(Z,"Unbound namespace prefix: "+JSON.stringify(Z.tagName)),$e.uri=Ee.prefix);var Me=Z.tags[Z.tags.length-1]||Z;$e.ns&&Me.ns!==$e.ns&&Object.keys($e.ns).forEach(function(qe){Oe(Z,"onopennamespace",{prefix:qe,uri:$e.ns[qe]})});for(var ze=0,Ze=Z.attribList.length;ze<Ze;ze++){var Xe=Z.attribList[ze],Ve=Xe[0],it=Xe[1],Ge=ot(Ve,!0),et=Ge.prefix,dt=Ge.local,ct=et===""?"":$e.ns[et]||"",nt={name:Ve,value:it,prefix:et,local:dt,uri:ct};et&&et!=="xmlns"&&!ct&&(Be(Z,"Unbound namespace prefix: "+JSON.stringify(et)),nt.uri=et),Z.tag.attributes[Ve]=nt,Oe(Z,"onattribute",nt)}Z.attribList.length=0}Z.tag.isSelfClosing=!!N,Z.sawRoot=!0,Z.tags.push(Z.tag),Oe(Z,"onopentag",Z.tag),N||(!Z.noscript&&Z.tagName.toLowerCase()==="script"?Z.state=_e.SCRIPT:Z.state=_e.TEXT,Z.tag=null,Z.tagName=""),Z.attribName=Z.attribValue="",Z.attribList.length=0}function Ke(Z){if(!Z.tagName){Be(Z,"Weird empty close tag."),Z.textNode+="</>",Z.state=_e.TEXT;return}if(Z.script){if(Z.tagName!=="script"){Z.script+="</"+Z.tagName+">",Z.tagName="",Z.state=_e.SCRIPT;return}Oe(Z,"onscript",Z.script),Z.script=""}var N=Z.tags.length,$e=Z.tagName;Z.strict||($e=$e[Z.looseCase]());for(var Ee=$e;N--;){var Me=Z.tags[N];if(Me.name!==Ee)Be(Z,"Unexpected close tag");else break}if(N<0){Be(Z,"Unmatched closing tag: "+Z.tagName),Z.textNode+="</"+Z.tagName+">",Z.state=_e.TEXT;return}Z.tagName=$e;for(var ze=Z.tags.length;ze-- >N;){var Ze=Z.tag=Z.tags.pop();Z.tagName=Z.tag.name,Oe(Z,"onclosetag",Z.tagName);var Xe={};for(var Ve in Ze.ns)Xe[Ve]=Ze.ns[Ve];var it=Z.tags[Z.tags.length-1]||Z;Z.opt.xmlns&&Ze.ns!==it.ns&&Object.keys(Ze.ns).forEach(function(Ge){var et=Ze.ns[Ge];Oe(Z,"onclosenamespace",{prefix:Ge,uri:et})})}N===0&&(Z.closedRoot=!0),Z.tagName=Z.attribValue=Z.attribName="",Z.attribList.length=0,Z.state=_e.TEXT}function lt(Z){var N=Z.entity,$e=N.toLowerCase(),Ee,Me="";return Z.ENTITIES[N]?Z.ENTITIES[N]:Z.ENTITIES[$e]?Z.ENTITIES[$e]:(N=$e,N.charAt(0)==="#"&&(N.charAt(1)==="x"?(N=N.slice(2),Ee=parseInt(N,16),Me=Ee.toString(16)):(N=N.slice(1),Ee=parseInt(N,10),Me=Ee.toString(10))),N=N.replace(/^0+/,""),isNaN(Ee)||Me.toLowerCase()!==N?(Be(Z,"Invalid character entity"),"&"+Z.entity+";"):String.fromCodePoint(Ee))}function ft(Z,N){N==="<"?(Z.state=_e.OPEN_WAKA,Z.startTagPosition=Z.position):Ie(N)||(Be(Z,"Non-whitespace before first tag."),Z.textNode=N,Z.state=_e.TEXT)}function ut(Z,N){var $e="";return N<Z.length&&($e=Z.charAt(N)),$e}function ht(Z){var N=this;if(this.error)throw this.error;if(N.closed)return Je(N,"Cannot write after close. Assign an onready handler.");if(Z===null)return rt(N);typeof Z=="object"&&(Z=Z.toString());for(var $e=0,Ee="";Ee=ut(Z,$e++),N.c=Ee,!!Ee;)switch(N.trackPosition&&(N.position++,Ee===`
`?(N.line++,N.column=0):N.column++),N.state){case _e.BEGIN:if(N.state=_e.BEGIN_WHITESPACE,Ee==="\uFEFF")continue;ft(N,Ee);continue;case _e.BEGIN_WHITESPACE:ft(N,Ee);continue;case _e.TEXT:if(N.sawRoot&&!N.closedRoot){for(var Me=$e-1;Ee&&Ee!=="<"&&Ee!=="&";)Ee=ut(Z,$e++),Ee&&N.trackPosition&&(N.position++,Ee===`
`?(N.line++,N.column=0):N.column++);N.textNode+=Z.substring(Me,$e-1)}Ee==="<"&&!(N.sawRoot&&N.closedRoot&&!N.strict)?(N.state=_e.OPEN_WAKA,N.startTagPosition=N.position):(!Ie(Ee)&&(!N.sawRoot||N.closedRoot)&&Be(N,"Text data outside of root node."),Ee==="&"?N.state=_e.TEXT_ENTITY:N.textNode+=Ee);continue;case _e.SCRIPT:Ee==="<"?N.state=_e.SCRIPT_ENDING:N.script+=Ee;continue;case _e.SCRIPT_ENDING:Ee==="/"?N.state=_e.CLOSE_TAG:(N.script+="<"+Ee,N.state=_e.SCRIPT);continue;case _e.OPEN_WAKA:if(Ee==="!")N.state=_e.SGML_DECL,N.sgmlDecl="";else if(!Ie(Ee))if(ke(ye,Ee))N.state=_e.OPEN_TAG,N.tagName=Ee;else if(Ee==="/")N.state=_e.CLOSE_TAG,N.tagName="";else if(Ee==="?")N.state=_e.PROC_INST,N.procInstName=N.procInstBody="";else{if(Be(N,"Unencoded <"),N.startTagPosition+1<N.position){var ze=N.position-N.startTagPosition;Ee=new Array(ze).join(" ")+Ee}N.textNode+="<"+Ee,N.state=_e.TEXT}continue;case _e.SGML_DECL:(N.sgmlDecl+Ee).toUpperCase()===Te?(Oe(N,"onopencdata"),N.state=_e.CDATA,N.sgmlDecl="",N.cdata=""):N.sgmlDecl+Ee==="--"?(N.state=_e.COMMENT,N.comment="",N.sgmlDecl=""):(N.sgmlDecl+Ee).toUpperCase()===he?(N.state=_e.DOCTYPE,(N.doctype||N.sawRoot)&&Be(N,"Inappropriately located doctype declaration"),N.doctype="",N.sgmlDecl=""):Ee===">"?(Oe(N,"onsgmldeclaration",N.sgmlDecl),N.sgmlDecl="",N.state=_e.TEXT):(Ae(Ee)&&(N.state=_e.SGML_DECL_QUOTED),N.sgmlDecl+=Ee);continue;case _e.SGML_DECL_QUOTED:Ee===N.q&&(N.state=_e.SGML_DECL,N.q=""),N.sgmlDecl+=Ee;continue;case _e.DOCTYPE:Ee===">"?(N.state=_e.TEXT,Oe(N,"ondoctype",N.doctype),N.doctype=!0):(N.doctype+=Ee,Ee==="["?N.state=_e.DOCTYPE_DTD:Ae(Ee)&&(N.state=_e.DOCTYPE_QUOTED,N.q=Ee));continue;case _e.DOCTYPE_QUOTED:N.doctype+=Ee,Ee===N.q&&(N.q="",N.state=_e.DOCTYPE);continue;case _e.DOCTYPE_DTD:N.doctype+=Ee,Ee==="]"?N.state=_e.DOCTYPE:Ae(Ee)&&(N.state=_e.DOCTYPE_DTD_QUOTED,N.q=Ee);continue;case _e.DOCTYPE_DTD_QUOTED:N.doctype+=Ee,Ee===N.q&&(N.state=_e.DOCTYPE_DTD,N.q="");continue;case _e.COMMENT:Ee==="-"?N.state=_e.COMMENT_ENDING:N.comment+=Ee;continue;case _e.COMMENT_ENDING:Ee==="-"?(N.state=_e.COMMENT_ENDED,N.comment=Qe(N.opt,N.comment),N.comment&&Oe(N,"oncomment",N.comment),N.comment=""):(N.comment+="-"+Ee,N.state=_e.COMMENT);continue;case _e.COMMENT_ENDED:Ee!==">"?(Be(N,"Malformed comment"),N.comment+="--"+Ee,N.state=_e.COMMENT):N.state=_e.TEXT;continue;case _e.CDATA:Ee==="]"?N.state=_e.CDATA_ENDING:N.cdata+=Ee;continue;case _e.CDATA_ENDING:Ee==="]"?N.state=_e.CDATA_ENDING_2:(N.cdata+="]"+Ee,N.state=_e.CDATA);continue;case _e.CDATA_ENDING_2:Ee===">"?(N.cdata&&Oe(N,"oncdata",N.cdata),Oe(N,"onclosecdata"),N.cdata="",N.state=_e.TEXT):Ee==="]"?N.cdata+="]":(N.cdata+="]]"+Ee,N.state=_e.CDATA);continue;case _e.PROC_INST:Ee==="?"?N.state=_e.PROC_INST_ENDING:Ie(Ee)?N.state=_e.PROC_INST_BODY:N.procInstName+=Ee;continue;case _e.PROC_INST_BODY:if(!N.procInstBody&&Ie(Ee))continue;Ee==="?"?N.state=_e.PROC_INST_ENDING:N.procInstBody+=Ee;continue;case _e.PROC_INST_ENDING:Ee===">"?(Oe(N,"onprocessinginstruction",{name:N.procInstName,body:N.procInstBody}),N.procInstName=N.procInstBody="",N.state=_e.TEXT):(N.procInstBody+="?"+Ee,N.state=_e.PROC_INST_BODY);continue;case _e.OPEN_TAG:ke(xe,Ee)?N.tagName+=Ee:(tt(N),Ee===">"?Pe(N):Ee==="/"?N.state=_e.OPEN_TAG_SLASH:(Ie(Ee)||Be(N,"Invalid character in tag name"),N.state=_e.ATTRIB));continue;case _e.OPEN_TAG_SLASH:Ee===">"?(Pe(N,!0),Ke(N)):(Be(N,"Forward-slash in opening tag not followed by >"),N.state=_e.ATTRIB);continue;case _e.ATTRIB:if(Ie(Ee))continue;Ee===">"?Pe(N):Ee==="/"?N.state=_e.OPEN_TAG_SLASH:ke(ye,Ee)?(N.attribName=Ee,N.attribValue="",N.state=_e.ATTRIB_NAME):Be(N,"Invalid attribute name");continue;case _e.ATTRIB_NAME:Ee==="="?N.state=_e.ATTRIB_VALUE:Ee===">"?(Be(N,"Attribute without value"),N.attribValue=N.attribName,st(N),Pe(N)):Ie(Ee)?N.state=_e.ATTRIB_NAME_SAW_WHITE:ke(xe,Ee)?N.attribName+=Ee:Be(N,"Invalid attribute name");continue;case _e.ATTRIB_NAME_SAW_WHITE:if(Ee==="=")N.state=_e.ATTRIB_VALUE;else{if(Ie(Ee))continue;Be(N,"Attribute without value"),N.tag.attributes[N.attribName]="",N.attribValue="",Oe(N,"onattribute",{name:N.attribName,value:""}),N.attribName="",Ee===">"?Pe(N):ke(ye,Ee)?(N.attribName=Ee,N.state=_e.ATTRIB_NAME):(Be(N,"Invalid attribute name"),N.state=_e.ATTRIB)}continue;case _e.ATTRIB_VALUE:if(Ie(Ee))continue;Ae(Ee)?(N.q=Ee,N.state=_e.ATTRIB_VALUE_QUOTED):(Be(N,"Unquoted attribute value"),N.state=_e.ATTRIB_VALUE_UNQUOTED,N.attribValue=Ee);continue;case _e.ATTRIB_VALUE_QUOTED:if(Ee!==N.q){Ee==="&"?N.state=_e.ATTRIB_VALUE_ENTITY_Q:N.attribValue+=Ee;continue}st(N),N.q="",N.state=_e.ATTRIB_VALUE_CLOSED;continue;case _e.ATTRIB_VALUE_CLOSED:Ie(Ee)?N.state=_e.ATTRIB:Ee===">"?Pe(N):Ee==="/"?N.state=_e.OPEN_TAG_SLASH:ke(ye,Ee)?(Be(N,"No whitespace between attributes"),N.attribName=Ee,N.attribValue="",N.state=_e.ATTRIB_NAME):Be(N,"Invalid attribute name");continue;case _e.ATTRIB_VALUE_UNQUOTED:if(!Re(Ee)){Ee==="&"?N.state=_e.ATTRIB_VALUE_ENTITY_U:N.attribValue+=Ee;continue}st(N),Ee===">"?Pe(N):N.state=_e.ATTRIB;continue;case _e.CLOSE_TAG:if(N.tagName)Ee===">"?Ke(N):ke(xe,Ee)?N.tagName+=Ee:N.script?(N.script+="</"+N.tagName,N.tagName="",N.state=_e.SCRIPT):(Ie(Ee)||Be(N,"Invalid tagname in closing tag"),N.state=_e.CLOSE_TAG_SAW_WHITE);else{if(Ie(Ee))continue;De(ye,Ee)?N.script?(N.script+="</"+Ee,N.state=_e.SCRIPT):Be(N,"Invalid tagname in closing tag."):N.tagName=Ee}continue;case _e.CLOSE_TAG_SAW_WHITE:if(Ie(Ee))continue;Ee===">"?Ke(N):Be(N,"Invalid characters in closing tag");continue;case _e.TEXT_ENTITY:case _e.ATTRIB_VALUE_ENTITY_Q:case _e.ATTRIB_VALUE_ENTITY_U:var Ze,Xe;switch(N.state){case _e.TEXT_ENTITY:Ze=_e.TEXT,Xe="textNode";break;case _e.ATTRIB_VALUE_ENTITY_Q:Ze=_e.ATTRIB_VALUE_QUOTED,Xe="attribValue";break;case _e.ATTRIB_VALUE_ENTITY_U:Ze=_e.ATTRIB_VALUE_UNQUOTED,Xe="attribValue";break}if(Ee===";")if(N.opt.unparsedEntities){var Ve=lt(N);N.entity="",N.state=Ze,N.write(Ve)}else N[Xe]+=lt(N),N.entity="",N.state=Ze;else ke(N.entity.length?Ne:be,Ee)?N.entity+=Ee:(Be(N,"Invalid character in entity name"),N[Xe]+="&"+N.entity+Ee,N.entity="",N.state=Ze);continue;default:throw new Error(N,"Unknown state: "+N.state)}return N.position>=N.bufferCheckPosition&&y(N),N}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var Z=String.fromCharCode,N=Math.floor,$e=function(){var Ee=16384,Me=[],ze,Ze,Xe=-1,Ve=arguments.length;if(!Ve)return"";for(var it="";++Xe<Ve;){var Ge=Number(arguments[Xe]);if(!isFinite(Ge)||Ge<0||Ge>1114111||N(Ge)!==Ge)throw RangeError("Invalid code point: "+Ge);Ge<=65535?Me.push(Ge):(Ge-=65536,ze=(Ge>>10)+55296,Ze=Ge%1024+56320,Me.push(ze,Ze)),(Xe+1===Ve||Me.length>Ee)&&(it+=Z.apply(null,Me),Me.length=0)}return it};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:$e,configurable:!0,writable:!0}):String.fromCodePoint=$e}()})(e)})(sax);const logger={debug:()=>{}},g$3=e=>{const r=sax.parser(!0,{trim:!1,normalize:!1});let t,E=null;return new Promise((y,x)=>{r.onopentag=I=>{const w={_parent:E||void 0,_children:[],_fTextNode:!1,_tag:I.name,_attrs:I.attributes};E!=null?E._children.push(w):t=w,E=w},r.onclosetag=()=>{E=E!=null?E._parent:null},r.ontext=I=>{E!=null&&E._children.push({_parent:E,_children:[],_fTextNode:!0,_text:I})},r.onend=()=>{y(t)},r.onerror=I=>{x(I)},r.write(e),r.end()})},c$2=(e,r,t="")=>{let E=t.length?"":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>',y=Buffer.from(E,"utf-8");if(e._fTextNode)y=Buffer.concat([y,Buffer.from(d$1(e._text,r))]);else{let x="";const I=e._attrs;Object.keys(I).forEach(O=>{x+=` ${O}="${_$2(I[O])}"`});const w=e._children.length>0,M=w?"":"/";y=Buffer.concat([y,Buffer.from(`
${t}<${e._tag}${x}${M}>`)]);let D=!1;if(e._children.forEach(O=>{y=Buffer.concat([y,c$2(O,r,`${t}  `)]),D=!O._fTextNode}),w){const O=D?`
${t}`:"";y=Buffer.concat([y,Buffer.from(`${O}</${e._tag}>`)])}}return y},d$1=(e,r)=>{let t="";const E=e.split(r.literalXmlDelimiter);let y=!1;for(let x=0;x<E.length;x++){let I=E[x];y||(I=I.replace(/&/g,"&amp;"),I=I.replace(/</g,"&lt;"),I=I.replace(/>/g,"&gt;")),t+=I,y=!y}return t},_$2=e=>{let r=typeof e=="string"?e:e.value;return r=r.replace(/&/g,"&amp;"),r=r.replace(/</g,"&lt;"),r=r.replace(/>/g,"&gt;"),r=r.replace(/'/g,"&apos;"),r=r.replace(/"/g,"&quot;"),r};function isError(e){return e instanceof Error||typeof e=="object"&&!!e&&"name"in e&&"message"in e}class NullishCommandResultError extends Error{constructor(r){super(`Result of command ${r} is null or undefined and rejectNullish is set`),Object.setPrototypeOf(this,NullishCommandResultError.prototype),this.command=r}}class ObjectCommandResultError extends Error{constructor(r,t){super(`Result of command '${r}' is an object`),Object.setPrototypeOf(this,ObjectCommandResultError.prototype),this.command=r,this.result=t}}class CommandSyntaxError extends Error{constructor(r){super(`Invalid command syntax: ${r}`),Object.setPrototypeOf(this,CommandSyntaxError.prototype),this.command=r}}class InvalidCommandError extends Error{constructor(r,t){super(`${r}: ${t}`),Object.setPrototypeOf(this,InvalidCommandError.prototype),this.command=t}}class CommandExecutionError extends Error{constructor(r,t){console.info("===THROW THIS SHIT CommandExecutionError==="),super(`Error executing command '${t}': ${r.name}: ${r.message}`),Object.setPrototypeOf(this,CommandExecutionError.prototype),this.command=t,this.err=r}}class ImageError extends CommandExecutionError{}class InternalError extends Error{constructor(r){super(`INTERNAL ERROR: ${r}`)}}class TemplateParseError extends Error{}class IncompleteConditionalStatementError extends Error{constructor(){super("Incomplete IF/END-IF statement. Make sure each IF-statement has a corresponding END-IF command.")}}class UnterminatedForLoopError extends Error{constructor(r){super(`Unterminated FOR-loop ('FOR ${r.varName}'). Make sure each FOR loop has a corresponding END-FOR command.`)}}const i=e=>e._fTextNode?{_children:[],_fTextNode:!0,_text:e._text}:{_children:[],_fTextNode:!1,_tag:e._tag,_attrs:e._attrs},_$1=e=>{const r=e._parent;if(r==null)return null;const t=r._children,E=t.indexOf(e);return E<0||E>=t.length-1?null:t[E+1]},a=e=>{const r=e._parent;if(!(r&&!r._fTextNode&&r._tag==="w:t"))throw new TemplateParseError("Template syntax error: text node not within w:t");const t=r._parent;if(t==null)throw new TemplateParseError("Template syntax error: w:t node has no parent");const E=t._children.indexOf(r);if(E<0)throw new TemplateParseError("Template syntax error");const y=i(r);y._parent=t;const x={_parent:y,_children:[],_fTextNode:!0,_text:""};return y._children=[x],t._children.splice(E+1,0,y),x},c$1=(e,r={},t=[])=>{const E={_fTextNode:!1,_tag:e,_attrs:r,_children:t};return E._children.forEach(y=>{y._parent=E}),E},u=e=>({_children:[],_fTextNode:!0,_text:e}),p=(e,r)=>(e._children.push(r),r._parent=e,r),s=e=>e.loops.length?e.loops[e.loops.length-1]:null,f=e=>{const r=s(e);return r!=null&&r.idx<0},h=e=>{if(!e.length)return;const r=e.length-1,{varName:t,idx:E,loopOver:y,isIf:x}=e[r],I=E>=0?E+1:"EXPLORATION";logger.debug(`${x?"IF":"FOR"} loop on ${r}:${t}${I}/${y.length}`)},g$2=(e,r)=>{let t=e,E=!1,y=null,x=0;const I=`${r[0]}CMD_NODE${r[1]}`;for(;t!=null;){if(!t._fTextNode&&t._tag==="w:t"&&(t._attrs["xml:space"]="preserve"),!t._fTextNode&&t._tag==="w:p"&&y&&(y._text+=" "),t._fTextNode&&t._parent&&!t._parent._fTextNode&&t._parent._tag==="w:t"){y==null&&(y=t);const w=t._text;t._text="";for(let M=0;M<w.length;M++){const D=w[M],O=E?r[1]:r[0];if(D===O[x]){if(x+=1,x===O.length){E=!E;const Te=t===y;E&&y._text.length&&(y=a(y),Te&&(t=y)),y._text+=O,!E&&M<w.length-1&&(y=a(y),Te&&(t=y)),x=0,E||(y=t)}}else x&&(y._text+=O.slice(0,x),x=0,E||(y=t)),y._text+=D}!E&&!x&&(y=null),w.length&&!t._text.length&&(t._text=I)}if(t._children.length)t=t._children[0];else{let w=!1;for(;t._parent!=null;){const M=t._parent,D=_$1(t);if(D){w=!0,t=D;break}t=M}w||(t=null)}}return e};var vmBrowserify={};(function(exports){var indexOf=function(e,r){if(e.indexOf)return e.indexOf(r);for(var t=0;t<e.length;t++)if(e[t]===r)return t;return-1},Object_keys=function(e){if(Object.keys)return Object.keys(e);var r=[];for(var t in e)r.push(t);return r},forEach=function(e,r){if(e.forEach)return e.forEach(r);for(var t=0;t<e.length;t++)r(e[t],t,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,r,t){Object.defineProperty(e,r,{writable:!0,enumerable:!1,configurable:!0,value:t})}}catch(e){return function(r,t,E){r[t]=E}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(r){if(!(this instanceof Script))return new Script(r);this.code=r};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var r=document.createElement("iframe");r.style||(r.style={}),r.style.display="none",document.body.appendChild(r);var t=r.contentWindow,E=t.eval,y=t.execScript;!E&&y&&(y.call(t,"null"),E=t.eval),forEach(Object_keys(e),function(w){t[w]=e[w]}),forEach(globals,function(w){e[w]&&(t[w]=e[w])});var x=Object_keys(t),I=E.call(t,this.code);return forEach(Object_keys(t),function(w){(w in e||indexOf(x,w)===-1)&&(e[w]=t[w])}),forEach(globals,function(w){w in e||defineProp(e,w,t[w])}),document.body.removeChild(r),I},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var r=Script.createContext(e),t=this.runInContext(r);return e&&forEach(Object_keys(r),function(E){e[E]=r[E]}),t},forEach(Object_keys(Script.prototype),function(e){exports[e]=Script[e]=function(r){var t=Script(r);return t[e].apply(t,[].slice.call(arguments,1))}}),exports.isContext=function(e){return e instanceof Context},exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var r=new Context;return typeof e=="object"&&forEach(Object_keys(e),function(t){r[t]=e[t]}),r}})(vmBrowserify);var g$1=Object.defineProperty,c=Object.defineProperties,H$1=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertySymbols,S$1=Object.prototype.hasOwnProperty,C$1=Object.prototype.propertyIsEnumerable,_=(e,r,t)=>r in e?g$1(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,l=(e,r)=>{for(var t in r||(r={}))S$1.call(r,t)&&_(e,t,r[t]);if(m)for(var t of m(r))C$1.call(r,t)&&_(e,t,r[t]);return e},d=(e,r)=>c(e,H$1(r));async function runUserJsAndGetRaw(e,r,t){var E;const y=l(l(d(l({},t.jsSandbox||{}),{__code__:r,__result__:void 0}),e),t.options.additionalJsContext),x=s(t);x&&(y.$idx=x.idx),Object.keys(t.vars).forEach(M=>{y[`$${M}`]=t.vars[M]});let I,w;try{if(t.options.runJs){const M=t.options.runJs({sandbox:y,ctx:t});I=M.modifiedSandbox,w=await M.result}else if(t.options.noSandbox)I=y,w=await new Function("with(this) { return eval(__code__); }").call(I);else{const M=new vmBrowserify.Script((E=y.__code__)!=null?E:"");I=vmBrowserify.createContext(y),w=await M.runInContext(I)}}catch(M){console.log("is error",isError(M));const D=isError(M)?M:new Error(`${M}`);if(console.log(M),t.options.errorHandler!=null)I=y,console.log("===THROW THIS SHIT001==="),console.log(D.name,D.message,r),w=await t.options.errorHandler(D,r);else throw console.info("===THROW THIS SHIT 1==="),console.log(D.name,D.message,r),new CommandExecutionError(D,r)}if(t.options.rejectNullish&&w==null){const M=new NullishCommandResultError(r);if(t.options.errorHandler!=null)console.log("===THROW THIS SHIT002==="),console.log(M.name,M.message,r),w=await t.options.errorHandler(M,r);else throw M}return t.jsSandbox=d(l({},I),{__code__:void 0,__result__:void 0}),w}const ImageExtensions=[".png",".gif",".jpg",".jpeg",".svg"],BUILT_IN_COMMANDS=["QUERY","CMD_NODE","ALIAS","FOR","END-FOR","IF","END-IF","INS","EXEC","IMAGE","LINK","HTML"];var W=Object.defineProperty,Q=Object.defineProperties,G$1=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,L=(e,r,t)=>r in e?W(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,$=(e,r)=>{for(var t in r||(r={}))X.call(r,t)&&L(e,t,r[t]);if(S)for(var t of S(r))j.call(r,t)&&L(e,t,r[t]);return e},A=(e,r)=>Q(e,G$1(r));function newContext(e,r=0){return{gCntIf:0,gCntEndIf:0,level:1,fCmd:!1,cmd:"",fSeekQuery:!1,buffers:{"w:p":{text:"",cmds:"",fInsertedText:!1},"w:tr":{text:"",cmds:"",fInsertedText:!1},"w:tc":{text:"",cmds:"",fInsertedText:!1}},imageAndShapeIdIncrement:r,images:{},linkId:0,links:{},htmlId:0,htmls:{},vars:{},loops:[],fJump:!1,shorthands:{},options:e,pIfCheckMap:new Map,trIfCheckMap:new Map}}async function extractQuery(e,r){const t=newContext(r);t.fSeekQuery=!0;let E=e;for(;;){if(E._children.length)E=E._children[0];else{let x=!1;for(;E._parent!=null;){const I=E._parent,w=_$1(E);if(w){E=w,x=!0;break}E=I}if(!x)break}if(!E)break;const y=E._parent;if(E._fTextNode&&y&&!y._fTextNode&&y._tag==="w:t"&&await B$1(null,E,t,U),t.query!=null)break}return t.query}async function produceJsReport(e,r,t){return walkTemplate(e,r,t,U)}function findHighestImgId(e){const r=[],t=E=>{for(const y of E._children){const x=y._fTextNode?null:y._tag;if(x!=null){if(x==="wp:docPr"){if(y._fTextNode)continue;const I=y._attrs.id;if(typeof I!="string")continue;const w=Number.parseInt(I,10);Number.isSafeInteger(w)&&r.push(w)}y._children.length>0&&t(y)}}};return t(e),r.length>0?Math.max(...r):0}const b=e=>JSON.stringify(e._fTextNode?{_ifName:e._ifName,_fTextNode:e._fTextNode,_text:e==null?void 0:e._text}:{_ifName:e._ifName,_fTextNode:e._fTextNode,_tag:e==null?void 0:e._tag,_attrs:e==null?void 0:e._attrs}),H=e=>{let r=e._parent,t=null;for(;r!=null&&t==null;){if((r._fTextNode?null:r._tag)==="w:p"){const E=r._parent!=null?r._parent._parent:null;E!=null&&!E._fTextNode&&E._tag==="w:tr"?t=E:t=r}r=r._parent}return t};async function walkTemplate(e,r,t,E){var y;const x=i(r);let I=r,w=x,M,D=0;const O=[];let Te=0;const he=((y=t.options)==null?void 0:y.maximumWalkingDepth)||1e6;for(;;){const ce=s(t);let ge=null;if(t.fJump){if(!ce)throw new InternalError("jumping while curLoop is null");logger.debug(`Jumping to level ${ce.refNodeLevel}...`,b(ce.refNode)),D=t.level-ce.refNodeLevel,I=ce.refNode,t.level=ce.refNodeLevel,t.fJump=!1,M="JUMP"}else if(I._children.length&&M!=="UP")I=I._children[0],t.level+=1,M="DOWN";else if(ge=_$1(I))I=ge,M="SIDE";else{const we=I._parent;if(we==null)break;if(Te>he)throw logger.debug(`=== parent is still not null after ${Te} loops, something must be wrong ...`,b(we)),new InternalError("infinite loop or massive dataset detected. Please review and try again");I=we,t.level-=1,M="UP"}if(logger.debug(`Next node [${M}, level ${t.level}]`,b(I)),M!=="DOWN"){const we=w._fTextNode?null:w._tag;let ye=!1;if((we==="w:p"||we==="w:tbl"||we==="w:tr"||we==="w:tc")&&f(t))ye=!0;else if(we==="w:p"||we==="w:tr"||we==="w:tc"){const xe=t.buffers[we];ye=xe.text===""&&xe.cmds!==""&&!xe.fInsertedText}ye&&w._parent!=null&&w._parent._children.pop()}if(M==="UP"){f(t)&&ce&&I===ce.refNode._parent&&(ce.refNode=I,ce.refNodeLevel-=1,logger.debug(`Updated loop '${ce.varName}' refNode: `+b(I)));const we=w._parent;if(we==null)throw new InternalError("node parent is null");if(w=we,t.pendingImageNode&&!w._fTextNode&&w._tag==="w:t"){const ye=t.pendingImageNode.image,xe=t.pendingImageNode.caption,be=w._parent;be&&(ye._parent=be,be._children.pop(),be._children.push(ye),xe&&be._children.push(...xe),t.buffers["w:p"].fInsertedText=!0,t.buffers["w:tr"].fInsertedText=!0,t.buffers["w:tc"].fInsertedText=!0),delete t.pendingImageNode}if(t.pendingLinkNode&&!w._fTextNode&&w._tag==="w:r"){const ye=t.pendingLinkNode,xe=w._parent;xe&&(ye._parent=xe,xe._children.pop(),xe._children.push(ye),t.buffers["w:p"].fInsertedText=!0,t.buffers["w:tr"].fInsertedText=!0,t.buffers["w:tc"].fInsertedText=!0),delete t.pendingLinkNode}if(t.pendingHtmlNode&&!w._fTextNode&&w._tag==="w:p"){const ye=t.pendingHtmlNode,xe=w._parent;xe&&(ye._parent=xe,xe._children.pop(),xe._children.push(ye),t.buffers["w:p"].fInsertedText=!0,t.buffers["w:tr"].fInsertedText=!0,t.buffers["w:tc"].fInsertedText=!0),delete t.pendingHtmlNode}!w._fTextNode&&w._tag==="w:tc"&&!w._children.filter(ye=>!ye._fTextNode&&(ye._tag==="w:p"||ye._tag==="w:altChunk")).length&&w._children.push({_parent:w,_children:[],_fTextNode:!1,_tag:"w:p",_attrs:{}}),!w._fTextNode&&w._tag==="w:rPr"&&(t.textRunPropsNode=w),!I._fTextNode&&I._tag==="w:r"&&delete t.textRunPropsNode}if(M==="DOWN"||M==="SIDE"){if(M==="SIDE"){if(w._parent==null)throw new InternalError("node parent is null");w=w._parent}const we=I._fTextNode?null:I._tag;(we==="w:p"||we==="w:tr"||we==="w:tc")&&(t.buffers[we]={text:"",cmds:"",fInsertedText:!1});const ye=i(I);ye._parent=w,w._children.push(ye);const xe=ye._tag;!f(t)&&(xe==="wp:docPr"||xe==="v:shape")&&(logger.debug("detected a - ",b(ye)),pe(ye,t));const be=I._parent;if(I._fTextNode&&be&&!be._fTextNode&&be._tag==="w:t"){const Ne=await B$1(e,I,t,E);typeof Ne=="string"?(ye._text=Ne,logger.debug("Inserted command result string into node. Updated node: "+b(ye))):O.push(...Ne)}w=ye}if(M==="JUMP")for(;D>0;){if(w._parent==null)throw new InternalError("node parent is null");w=w._parent,D-=1}Te++}if(t.gCntIf!==t.gCntEndIf){const ce=new IncompleteConditionalStatementError;if(t.options.failFast)throw ce;O.push(ce)}if(t.loops.filter(ce=>!ce.isIf).length>0){const ce=t.loops[t.loops.length-1],ge=new UnterminatedForLoopError(ce);if(t.options.failFast)throw ge;O.push(ge)}return O.length>0?{status:"errors",errors:O}:{status:"success",report:x,images:t.images,links:t.links,htmls:t.htmls}}const B$1=async(e,r,t,E)=>{const{cmdDelimiter:y,failFast:x}=t.options,I=r._text;if(I==null||I==="")return"";const w=I.split(y[0]).map(O=>O.split(y[1])).reduce((O,Te)=>O.concat(Te));let M="";const D=[];for(let O=0;O<w.length;O++){O>0&&R(y[0],t,{fCmd:!0});const Te=w[O];if(t.fCmd?t.cmd+=Te:f(t)||(M+=Te),R(Te,t,{fCmd:t.fCmd}),O<w.length-1){if(t.fCmd){const he=await E(e,r,t);if(he!=null)if(typeof he=="string")M+=he,R(he,t,{fCmd:!1,fInsertedText:!0});else{if(x)throw he;D.push(he)}}t.fCmd=!t.fCmd}}return D.length>0?D:M},U=async(e,r,t)=>{const E=getCommand(t.cmd,t.shorthands,t.options.fixSmartQuotes);t.cmd="";try{const{cmdName:y,cmdRest:x}=splitCommand(E);if(y!=="CMD_NODE"&&logger.debug(`Processing cmd: ${E}`),t.fSeekQuery){y==="QUERY"&&(t.query=x);return}if(!(y==="QUERY"||y==="CMD_NODE"))if(y==="ALIAS"){const I=/^(\S+)\s+(.+)/.exec(x);if(!I)throw new InvalidCommandError("Invalid ALIAS command",E);const w=I[1],M=I[2];t.shorthands[w]=M,logger.debug(`Defined alias '${w}' for: ${M}`)}else if(y==="FOR"||y==="IF")await re(e,r,t,E,y,x);else if(y==="END-FOR"||y==="END-IF")oe(r,t,E,y,x);else if(y==="INS"){if(!f(t)){let I=await runUserJsAndGetRaw(e,x,t);if(I==null)return"";if(typeof I=="object"&&!Array.isArray(I)){const M=new ObjectCommandResultError(x,I);if(console.log("===THROW THIS SHIT 2==="),console.log(M.name,M.message,x),t.options.errorHandler!=null)console.log("===THROW THIS SHIT 4==="),console.log(M.name,M.message,x),I=await t.options.errorHandler(M,x);else throw M}let w=String(I);if(t.options.processLineBreaks){const{literalXmlDelimiter:M}=t.options;if(t.options.processLineBreaksAsNewText){const D=w.split(`
`),O=`${M}<w:br/>${M}`,Te=`${M}</w:t>${M}`,he=`${M}<w:t xml:space="preserve">${M}`;w=D.join(`${Te}${O}${he}`)}else w=w.replace(/\n/g,`${M}<w:br/>${M}`)}return w}}else if(y==="EXEC")f(t)||await runUserJsAndGetRaw(e,x,t);else if(y==="IMAGE"){if(!f(t)){const I=await runUserJsAndGetRaw(e,x,t);if(I!=null)try{se(t,I)}catch(w){throw isError(w)?new ImageError(w,E):w}}}else if(y==="LINK"){if(!f(t)){const I=await runUserJsAndGetRaw(e,x,t);I!=null&&await le(t,I)}}else if(y==="HTML"){if(!f(t)){const I=await runUserJsAndGetRaw(e,x,t);I!=null&&await fe(t,I)}}else throw new CommandSyntaxError(E);return}catch(y){if(!isError(y))throw y;return t.options.errorHandler!=null?(console.log("===THROW THIS SHIT 3==="),console.log(y.name,y.message,E),t.options.errorHandler(y)):y}},te$1=BUILT_IN_COMMANDS.map(e=>new RegExp(`^${e}\\b`)),ne=e=>!te$1.some(r=>r.test(e.toUpperCase()));function getCommand(e,r,t){let E=e.trim();if(E[0]==="*"){const y=E.slice(1).trim();if(!r[y])throw new InvalidCommandError("Unknown alias",E);E=r[y]}else E[0]==="="?E=`INS ${E.slice(1).trim()}`:E[0]==="!"?E=`EXEC ${E.slice(1).trim()}`:ne(E)&&(E=`INS ${E.trim()}`);return t&&(E=E.replace(/[\u201C\u201D\u201E]/g,'"').replace(/[\u2018\u2019\u201A]/g,"'")),E.trim()}function splitCommand(e){const r=/^(\S+)\s*/.exec(e);let t,E="";return r!=null&&(t=r[1].toUpperCase(),E=e.slice(t.length).trim()),{cmdName:t,cmdRest:E}}const re=async(e,r,t,E,y,x)=>{const I=y==="IF";let w=null,M;if(I)r._ifName||(r._ifName=`__if_${t.gCntIf}`,t.gCntIf+=1),M=r._ifName;else{if(w=/^(\S+)\s+IN\s+(.+)/i.exec(x),!w)throw new InvalidCommandError("Invalid FOR command",E);M=w[1]}const D=s(t);if(!(D&&D.varName===M)){if(I){const ce=H(r),ge=ce!=null?ce._fTextNode?null:ce._tag:null;if(ce!=null){if(ge==="w:p"){if(t.pIfCheckMap.has(ce)&&t.pIfCheckMap.get(ce)!==E)throw new InvalidCommandError("Invalid IF command nested into another IF command on the same line",E);t.pIfCheckMap.set(ce,E)}else if(ge==="w:tr"){if(t.trIfCheckMap.has(ce)&&t.trIfCheckMap.get(ce)!==E)throw new InvalidCommandError("Invalid IF command nested into another IF command on the same table row",E);t.trIfCheckMap.set(ce,E)}}}const O=t.loops.length-1,Te=O>=0&&t.loops[O].idx===-1;let he;if(Te)he=[];else if(I)he=await runUserJsAndGetRaw(e,x,t)?[1]:[];else{if(!w)throw new InvalidCommandError("Invalid FOR command",E);if(he=await runUserJsAndGetRaw(e,w[2],t),!Array.isArray(he))throw new InvalidCommandError("Invalid FOR command (can only iterate over Array)",E)}t.loops.push({refNode:r,refNodeLevel:t.level,varName:M,loopOver:he,isIf:I,idx:-1})}h(t.loops)},oe=(e,r,t,E,y)=>{const x=E==="END-IF",I=s(r);if(!I)throw new InvalidCommandError(`Unexpected ${E} outside of ${x?"IF statement":"FOR loop"} context`,t);const w=H(e),M=w!=null?w._fTextNode?null:w._tag:null;M==="w:p"?r.pIfCheckMap.delete(w):M==="w:tr"&&r.trIfCheckMap.delete(w),x&&!e._ifName&&(e._ifName=I.varName,r.gCntEndIf+=1);const D=x?e._ifName:y;if(I.varName!==D){if(r.loops.find(he=>he.varName===D)==null){logger.debug(`Ignoring ${t} (${D}, but we're expecting ${I.varName})`);return}throw new InvalidCommandError("Invalid command",t)}const O=I.idx+1,Te=I.loopOver[O];Te!=null?(r.vars[D]=Te,r.fJump=!0,I.idx=O):r.loops.pop()},J$1=(e,r)=>{P(r),e.imageAndShapeIdIncrement+=1;const t=`img${String(e.imageAndShapeIdIncrement)}`;return e.images[t]=r,t};function P(e){if(!(e.data instanceof Uint8Array||e.data instanceof ArrayBuffer||typeof e.data=="string"))throw new Error("image .data property needs to be provided as Uint8Array (e.g. Buffer), ArrayBuffer, or as a base64-encoded string");if(!ImageExtensions.includes(e.extension))throw new Error(`An extension (one of ${ImageExtensions}) needs to be provided when providing an image or a thumbnail.`)}function ie(e){if(!Number.isFinite(e.width))throw new Error(`invalid image width: ${e.width} (in cm)`);if(!Number.isFinite(e.height))throw new Error(`invalid image height: ${e.height} (in cm)`);P(e),e.thumbnail&&P(e.thumbnail)}const se=(e,r)=>{var t;ie(r);const E=(r.width*36e4).toFixed(0),y=(r.height*36e4).toFixed(0);let x=J$1(e,ae(r));const I=String(e.imageAndShapeIdIncrement),w=r.alt||"desc",M=c$1,D=[];D.push(M("a:ext",{uri:"{28A0092B-C50C-407E-A947-70E740481C1C}"},[M("a14:useLocalDpi",{"xmlns:a14":"http://schemas.microsoft.com/office/drawing/2010/main",val:"0"})]));const O=r.rotation?(r.rotation*6e4).toString():void 0;if(e.images[x].extension===".svg"){const ce=(t=r.thumbnail)!=null?t:{data:"bm90aGluZwo=",extension:".png"},ge=J$1(e,ce);D.push(M("a:ext",{uri:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"},[M("asvg:svgBlip",{"xmlns:asvg":"http://schemas.microsoft.com/office/drawing/2016/SVG/main","r:embed":x})])),x=ge}const Te=M("pic:pic",{"xmlns:pic":"http://schemas.openxmlformats.org/drawingml/2006/picture"},[M("pic:nvPicPr",{},[M("pic:cNvPr",{id:"0",name:`Picture ${I}`,descr:w}),M("pic:cNvPicPr",{},[M("a:picLocks",{noChangeAspect:"1",noChangeArrowheads:"1"})])]),M("pic:blipFill",{},[M("a:blip",{"r:embed":x,cstate:"print"},[M("a:extLst",{},D)]),M("a:srcRect"),M("a:stretch",{},[M("a:fillRect")])]),M("pic:spPr",{bwMode:"auto"},[M("a:xfrm",O?{rot:O}:{},[M("a:off",{x:"0",y:"0"}),M("a:ext",{cx:E,cy:y})]),M("a:prstGeom",{prst:"rect"},[M("a:avLst")]),M("a:noFill"),M("a:ln",{},[M("a:noFill")])])]),he=M("w:drawing",{},[M("wp:inline",{distT:"0",distB:"0",distL:"0",distR:"0"},[M("wp:extent",{cx:E,cy:y}),M("wp:docPr",{id:I,name:`Picture ${I}`,descr:w}),M("wp:cNvGraphicFramePr",{},[M("a:graphicFrameLocks",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:"1"})]),M("a:graphic",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},[M("a:graphicData",{uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"},[Te])])])]);e.pendingImageNode={image:he},r.caption&&(e.pendingImageNode.caption=[M("w:br"),M("w:t",{},[u(r.caption)])])};function ae(e){const{data:r,extension:t}=e;if(!t)throw new Error("If you return image `data`, make sure you return an extension as well!");return{extension:t,data:r}}const le=async(e,r)=>{const{url:t,label:E=t}=r;e.linkId+=1;const y=`link${String(e.linkId)}`;e.links[y]={url:t};const x=c$1,{textRunPropsNode:I}=e,w=x("w:hyperlink",{"r:id":y,"w:history":"1"},[x("w:r",{},[I||x("w:rPr",{},[x("w:u",{"w:val":"single"})]),x("w:t",{},[u(E)])])]);e.pendingLinkNode=w},fe=async(e,r)=>{e.htmlId+=1;const t=`html${String(e.htmlId)}`;e.htmls[t]=r;const E=c$1("w:altChunk",{"r:id":t});e.pendingHtmlNode=E},de$1=["w:p","w:tr","w:tc"],R=(e,r,t)=>{if(r.fSeekQuery)return;const{fCmd:E,fInsertedText:y}=t,x=E?"cmds":"text";de$1.forEach(I=>{const w=r.buffers[I];w[x]+=e,y&&(w.fInsertedText=!0)})};function pe(e,r){r.imageAndShapeIdIncrement+=1;const t=String(r.imageAndShapeIdIncrement);e._attrs=A($({},e._attrs),{id:`${t}`})}const G="+++",C="||",B="[Content_Types].xml",g="word",de=new RegExp(`${g}\\/[^\\/]+\\.xml`);async function parseTemplate(e){const r=await n(e),t=await readContentTypes(r),E=getMainDoc(t),y=`${g}/${E}`,x=await s$1(r,y);if(x==null)throw new TemplateParseError(`${E} could not be found`);logger.debug(`${y} file length: ${x.length}`),new Date().getTime();const I=await g$3(x);return new Date().getTime(),{jsTemplate:I,mainDocument:E,zip:r,contentTypes:t}}async function V(e,r,t){const E=[];e.forEach(async x=>{de.test(x)&&x!==`${g}/${r}`&&x.indexOf(`${g}/template`)!==0&&E.push(x)}),E.sort();const y=[];for(const x of E){const I=await s$1(e,x);if(I==null)throw new TemplateParseError(`${x} could not be read`);logger.debug(`${x} file length: ${I.length}`);const w=await g$3(I),M=g$2(w,t.cmdDelimiter);y.push([M,x])}return y}async function ue(e,r){const{template:t,data:E,queryVars:y}=e,x=e.literalXmlDelimiter||C,I={cmdDelimiter:te(e.cmdDelimiter),literalXmlDelimiter:x,processLineBreaks:e.processLineBreaks!=null?e.processLineBreaks:!0,noSandbox:e.noSandbox||!1,runJs:e.runJs,additionalJsContext:e.additionalJsContext||{},failFast:e.failFast==null?!0:e.failFast,rejectNullish:e.rejectNullish==null?!1:e.rejectNullish,errorHandler:typeof e.errorHandler=="function"?e.errorHandler:null,fixSmartQuotes:e.fixSmartQuotes==null?!1:e.fixSmartQuotes,processLineBreaksAsNewText:e.processLineBreaksAsNewText==null?!1:e.processLineBreaksAsNewText,maximumWalkingDepth:e.maximumWalkingDepth},w={literalXmlDelimiter:x},{jsTemplate:M,mainDocument:D,zip:O,contentTypes:Te}=await parseTemplate(t),he=g$2(M,I.cmdDelimiter);let ce=null;if(typeof E=="function"){const _e=await extractQuery(he,I);ce=await E(_e,y)}else ce=E;const ge=await V(O,D,I),we=Math.max(...ge.map(([_e,Le])=>findHighestImgId(_e)),findHighestImgId(he));let ye=newContext(I,we);const xe=await produceJsReport(ce,he,ye);if(xe.status==="errors")throw xe.errors;const{report:be,images:Ne,links:Ie,htmls:Ae}=xe;if(r==="JS")return be;const Re=c$2(be,w).toString("utf-8");if(r==="XML")return Re;p$1(O,`${g}/${D}`,Re);let ke=Object.keys(Ne).length,De=Object.keys(Ae).length;await Y(Ne,D,O),await K(Ie,D,O),await ee(Ae,D,O);for(const[_e,Le]of ge){ye=newContext(I,ye.imageAndShapeIdIncrement);const Ce=await produceJsReport(ce,_e,ye);if(Ce.status==="errors")throw Ce.errors;const{report:Oe,images:Ye,links:Qe,htmls:Je}=Ce,rt=c$2(Oe,w).toString("utf-8");p$1(O,Le,rt),ke+=Object.keys(Ye).length,De+=Object.keys(Je).length;const Be=Le.split("/"),tt=Be[Be.length-1];await Y(Ye,tt,O),await K(Qe,D,O),await ee(Je,D,O)}if(ke||De){const _e=(Ce,Oe)=>{Te._children.filter(Ye=>!Ye._fTextNode&&Ye._attrs.Extension===Ce).length||p(Te,c$1("Default",{Extension:Ce,ContentType:Oe}))};ke&&(_e("png","image/png"),_e("jpg","image/jpeg"),_e("jpeg","image/jpeg"),_e("gif","image/gif"),_e("bmp","image/bmp"),_e("svg","image/svg+xml")),De&&_e("html","text/html");const Le=c$2(Te,w).toString("utf-8");p$1(O,B,Le)}return await c$3(O)}async function listCommands(e,r){const t={cmdDelimiter:te(r),literalXmlDelimiter:C,processLineBreaks:!0,noSandbox:!1,additionalJsContext:{},failFast:!1,rejectNullish:!1,errorHandler:null,fixSmartQuotes:!1,processLineBreaksAsNewText:!1},{jsTemplate:E,mainDocument:y,zip:x}=await parseTemplate(e),I=await V(x,y,t),w=[E,...I.map(([D,O])=>D)],M=[];for(const D of w){const O=g$2(D,t.cmdDelimiter),Te=newContext(t);await walkTemplate(void 0,O,Te,async(he,ce,ge)=>{const we=getCommand(ge.cmd,ge.shorthands,ge.options.fixSmartQuotes);ge.cmd="";const{cmdName:ye,cmdRest:xe}=splitCommand(we),be=ye;be!=null&&be!=="CMD_NODE"&&M.push({raw:we,type:be,code:xe})})}return M}async function getMetadata(e){const r="docProps/app.xml",t="docProps/core.xml",E=await n(e),y=await J(E,r),x=await J(E,t);function I(D){if(D._children.length===0)return;const O=D._children[0];if(O._fTextNode)return O._text;throw new Error("Not a text node")}function w(D,O){for(const Te of D._children)if(!Te._fTextNode&&Te._tag===O)return I(Te)}const M=D=>{const O=Number(D);if(Number.isFinite(O))return O};return{pages:M(w(y,"Pages")),words:M(w(y,"Words")),characters:M(w(y,"Characters")),lines:M(w(y,"Lines")),paragraphs:M(w(y,"Paragraphs")),company:w(y,"Company"),template:w(y,"Template"),title:w(x,"dc:title"),subject:w(x,"dc:subject"),creator:w(x,"dc:creator"),description:w(x,"dc:description"),lastModifiedBy:w(x,"cp:lastModifiedBy"),revision:w(x,"cp:revision"),lastPrinted:w(x,"cp:lastPrinted"),created:w(x,"dcterms:created"),modified:w(x,"dcterms:modified"),category:w(x,"cp:category")}}async function J(e,r){const t=await s$1(e,r);if(t==null)throw new TemplateParseError(`${r} could not be read`);const E=await g$3(t);if(E._fTextNode)throw new TemplateParseError(`${r} is a text node when parsed`);return E}async function readContentTypes(e){return await J(e,B)}function getMainDoc(e){const r=["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml"];for(const t of e._children)if(!t._fTextNode&&t._attrs.ContentType!=null&&r.includes(t._attrs.ContentType)){const E=t._attrs.PartName;if(E)return E.replace("/word/","")}throw new TemplateParseError(`Could not find main document (e.g. document.xml) in ${B}`)}const Y=async(e,r,t)=>{const E=Object.keys(e);if(!E.length)return;const y=`${g}/_rels/${r}.rels`,x=await F(t,y);for(const w of E){const{extension:M,data:D}=e[w],O=`template_${r}_${w}${M}`,Te=`${g}/media/${O}`;typeof D=="string"?a$1(t,Te,D):o(t,Te,D),p(x,c$1("Relationship",{Id:w,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`media/${O}`}))}const I=c$2(x,{literalXmlDelimiter:C});p$1(t,y,I.toString("utf-8"))},K=async(e,r,t)=>{const E=Object.keys(e);if(E.length){const y=`${g}/_rels/${r}.rels`,x=await F(t,y);for(const w of E){const{url:M}=e[w];p(x,c$1("Relationship",{Id:w,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Target:M,TargetMode:"External"}))}const I=c$2(x,{literalXmlDelimiter:C});p$1(t,y,I.toString("utf-8"))}},ee=async(e,r,t)=>{const E=Object.keys(e);if(E.length){const y=`${g}/_rels/${r}.rels`,x=await F(t,y);for(const w of E){const M=e[w],D=`template_${r.replace(/\./g,"_")}_${w}.html`,O=`${g}/${D}`;p$1(t,O,M),p(x,c$1("Relationship",{Id:w,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk",Target:`${D}`}))}const I=c$2(x,{literalXmlDelimiter:C});p$1(t,y,I.toString("utf-8"))}},F=async(e,r)=>{let t=await s$1(e,r);return t||(t=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
        <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
        </Relationships>`),g$3(t)},te=e=>e?typeof e=="string"?[e,e]:e:[G,G];export{CommandExecutionError,CommandSyntaxError,ImageError,IncompleteConditionalStatementError,InternalError,InvalidCommandError,NullishCommandResultError,ObjectCommandResultError,TemplateParseError,UnterminatedForLoopError,ue as createReport,getMetadata,isError,listCommands};
//# sourceMappingURL=browser.js.map
